<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Séance Natation — Timeline</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet">
  <style>
    /* ─── RESET ─── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { -webkit-text-size-adjust: 100%; font-size: 16px; }
    body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    button { border: none; background: none; cursor: pointer; font: inherit; color: inherit; }

    /* ─── TOKENS ─── */
    :root {
      --font-display: 'Outfit', sans-serif;
      --font-body: 'DM Sans', sans-serif;

      --bg-page: #f0f4f8;
      --bg-card: #ffffff;
      --bg-muted: #e2e8f0;

      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-tertiary: #94a3b8;

      --intensity-v0: #60a5fa;
      --intensity-v0-soft: rgba(96,165,250,0.12);
      --intensity-v1: #22c55e;
      --intensity-v1-soft: rgba(34,197,94,0.12);
      --intensity-v2: #eab308;
      --intensity-v2-soft: rgba(234,179,8,0.12);
      --intensity-v3: #f97316;
      --intensity-v3-soft: rgba(249,115,22,0.12);
      --intensity-max: #ef4444;
      --intensity-max-soft: rgba(239,68,68,0.12);

      --stroke-crawl-bg: #dbeafe; --stroke-crawl: #1e40af;
      --stroke-dos-bg: #ede9fe; --stroke-dos: #6d28d9;
      --stroke-brasse-bg: #d1fae5; --stroke-brasse: #065f46;
      --stroke-pap-bg: #fef3c7; --stroke-pap: #92400e;
      --stroke-4n-bg: #f1f5f9; --stroke-4n: #334155;
      --stroke-spe-bg: #fce7f3; --stroke-spe: #9d174d;

      --type-educ-bg: #ede9fe; --type-educ: #7c3aed;
      --type-jambes-bg: #ccfbf1; --type-jambes: #0f766e;

      --equip-bg: #f1f5f9;
      --equip-icon: #475569;
      --equip-label: #64748b;

      --rail-w: 5px;
      --dot-size: 16px;
      --rail-left: 34px;
      --content-left: 12px;

      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --radius-xl: 20px;
      --radius-full: 9999px;

      --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
      --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    }

    /* ─── PAGE ─── */
    body {
      font-family: var(--font-body);
      background: var(--bg-page);
      background-image: radial-gradient(ellipse at 50% -20%, rgba(96,165,250,0.06) 0%, transparent 70%);
      color: var(--text-primary);
      min-height: 100dvh;
      padding-bottom: env(safe-area-inset-bottom, 20px);
    }

    .session-page {
      max-width: 430px;
      margin: 0 auto;
      padding: 0 0 40px;
    }

    /* ─── HEADER ─── */
    .session-header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: rgba(240,244,248,0.85);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      padding: 12px 20px 14px;
      transition: box-shadow 0.3s ease, padding 0.3s ease;
    }

    .session-header.scrolled {
      box-shadow: 0 1px 12px rgba(15,23,42,0.06);
    }

    .session-header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .session-date {
      font-family: var(--font-display);
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      letter-spacing: 0.02em;
    }

    .poolside-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: var(--radius-full);
      background: var(--bg-card);
      border: 1px solid var(--bg-muted);
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      transition: all 0.25s ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    .poolside-toggle svg {
      width: 14px;
      height: 14px;
    }

    /* active states handled by .level-1 / .level-2 below */

    .session-metrics {
      display: flex;
      align-items: baseline;
      gap: 16px;
    }

    .metric-distance {
      font-family: var(--font-display);
      font-size: 32px;
      font-weight: 800;
      letter-spacing: -0.03em;
      line-height: 1;
      font-variant-numeric: tabular-nums;
    }

    .metric-secondary {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-tertiary);
    }

    .metric-secondary svg {
      width: 14px;
      height: 14px;
      vertical-align: -2px;
      margin-right: 2px;
      stroke: var(--text-tertiary);
    }

    /* ─── TIMELINE ─── */
    .timeline {
      padding: 8px 16px 0 16px;
    }

    /* ─── BLOCK ─── */
    .block {
      display: flex;
      gap: 0;
      position: relative;
      opacity: 0;
      transform: translateY(16px);
      animation: blockReveal 0.55s var(--ease-out) forwards;
    }

    .block:nth-child(1) { animation-delay: 0.08s; }
    .block:nth-child(2) { animation-delay: 0.15s; }
    .block:nth-child(3) { animation-delay: 0.22s; }
    .block:nth-child(4) { animation-delay: 0.29s; }
    .block:nth-child(5) { animation-delay: 0.36s; }
    .block:nth-child(6) { animation-delay: 0.43s; }
    .block:nth-child(7) { animation-delay: 0.50s; }

    @keyframes blockReveal {
      to { opacity: 1; transform: translateY(0); }
    }

    /* Rail */
    .block-rail {
      width: var(--rail-left);
      display: flex;
      flex-direction: column;
      align-items: center;
      flex-shrink: 0;
      padding-top: 2px;
    }

    .block-dot {
      width: var(--dot-size);
      height: var(--dot-size);
      border-radius: 50%;
      background: var(--block-color);
      border: 3px solid var(--bg-page);
      box-shadow: 0 0 0 2px var(--block-color), 0 0 12px -2px var(--block-color);
      flex-shrink: 0;
      z-index: 2;
      transition: transform 0.3s var(--ease-spring);
    }

    .block:hover .block-dot,
    .block.touching .block-dot {
      transform: scale(1.15);
    }

    .block-line {
      width: var(--rail-w);
      flex-grow: 1;
      background: var(--block-color);
      opacity: 0.35;
      border-radius: var(--rail-w);
      margin-top: -2px;
      transition: opacity 0.3s ease;
    }

    .block:hover .block-line {
      opacity: 0.55;
    }

    /* Block content */
    .block-main {
      flex: 1;
      min-width: 0;
      padding-left: var(--content-left);
      padding-bottom: 8px;
    }

    .block-header {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      padding: 6px 0 4px;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }

    .block-title {
      font-family: var(--font-display);
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--block-color);
      white-space: nowrap;
    }

    .block-rep {
      font-family: var(--font-display);
      font-size: 11px;
      font-weight: 700;
      background: var(--block-color);
      color: white;
      padding: 1px 7px 2px;
      border-radius: var(--radius-full);
      line-height: 1.3;
    }

    .block-spacer {
      flex: 1;
    }

    .block-distance {
      font-family: var(--font-display);
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      font-variant-numeric: tabular-nums;
      letter-spacing: -0.01em;
    }

    .block-chevron {
      width: 18px;
      height: 18px;
      stroke: var(--text-tertiary);
      transition: transform 0.35s var(--ease-spring);
      flex-shrink: 0;
    }

    .block.collapsed .block-chevron {
      transform: rotate(-90deg);
    }

    .block-desc {
      font-size: 12px;
      color: var(--text-tertiary);
      font-style: italic;
      padding: 0 0 6px;
      line-height: 1.4;
    }

    /* Block exercises container */
    .block-exercises {
      display: flex;
      flex-direction: column;
      gap: 2px;
      overflow: hidden;
      transition: max-height 0.4s var(--ease-out), opacity 0.3s ease;
      max-height: 600px;
      opacity: 1;
    }

    .block.collapsed .block-exercises {
      max-height: 0;
      opacity: 0;
    }

    .block.collapsed .block-desc {
      display: none;
    }

    /* ─── EXERCISE ─── */
    .exercise {
      padding: 7px 0 4px;
      border-radius: var(--radius-sm);
      -webkit-tap-highlight-color: transparent;
    }

    .exercise-main {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: nowrap;
    }

    .ex-label {
      font-family: var(--font-display);
      font-size: 16px;
      font-weight: 700;
      letter-spacing: -0.01em;
      font-variant-numeric: tabular-nums;
      min-width: 72px;
      color: var(--text-primary);
    }

    /* poolside text size handled by .mode-bassin .ex-label below */

    /* Stroke badge */
    .stroke-badge {
      font-family: var(--font-display);
      font-size: 11px;
      font-weight: 700;
      padding: 2px 8px 3px;
      border-radius: var(--radius-full);
      letter-spacing: 0.03em;
      white-space: nowrap;
      line-height: 1.2;
    }

    .stroke-crawl { background: var(--stroke-crawl-bg); color: var(--stroke-crawl); }
    .stroke-dos { background: var(--stroke-dos-bg); color: var(--stroke-dos); }
    .stroke-brasse { background: var(--stroke-brasse-bg); color: var(--stroke-brasse); }
    .stroke-pap { background: var(--stroke-pap-bg); color: var(--stroke-pap); }
    .stroke-4n { background: var(--stroke-4n-bg); color: var(--stroke-4n); }
    .stroke-spe { background: var(--stroke-spe-bg); color: var(--stroke-spe); }

    /* Type badge */
    .type-badge {
      font-size: 10px;
      font-weight: 600;
      padding: 2px 7px 3px;
      border-radius: var(--radius-full);
      letter-spacing: 0.02em;
      white-space: nowrap;
    }

    .type-educ { background: var(--type-educ-bg); color: var(--type-educ); font-style: italic; }
    .type-jambes { background: var(--type-jambes-bg); color: var(--type-jambes); }

    /* Intensity text */
    .ex-intensity {
      font-family: var(--font-display);
      font-size: 12px;
      font-weight: 700;
      white-space: nowrap;
    }

    .ex-intensity[data-i="v0"] { color: var(--intensity-v0); }
    .ex-intensity[data-i="v1"] { color: var(--intensity-v1); }
    .ex-intensity[data-i="v2"] { color: var(--intensity-v2); }
    .ex-intensity[data-i="v3"] { color: var(--intensity-v3); }
    .ex-intensity[data-i="max"] { color: var(--intensity-max); }
    .ex-intensity[data-i="prog"] {
      background: linear-gradient(90deg, var(--intensity-v1), var(--intensity-v3));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .ex-spacer { flex: 1; }

    /* Rest */
    .ex-rest {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-tertiary);
      white-space: nowrap;
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 3px;
    }

    .ex-rest svg {
      width: 12px;
      height: 12px;
      stroke: var(--text-tertiary);
    }

    /* Equipment row */
    .exercise-equipment {
      display: flex;
      gap: 8px;
      padding: 5px 0 2px 0;
      flex-wrap: wrap;
    }

    .equip-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
    }

    .equip-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--equip-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s var(--ease-spring);
    }

    .equip-icon:hover {
      transform: scale(1.08);
    }

    .equip-icon svg {
      width: 18px;
      height: 18px;
      stroke: var(--equip-icon);
      fill: none;
      stroke-width: 1.8;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .equip-label {
      font-family: var(--font-display);
      font-size: 9px;
      font-weight: 600;
      color: var(--equip-label);
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    /* Exercise modalities (visible by default) */
    .exercise-detail {
      max-height: 100px;
      overflow: hidden;
      transition: max-height 0.35s var(--ease-out), opacity 0.25s ease, padding 0.35s ease;
      opacity: 1;
      padding: 4px 0 6px;
    }

    /* Level 1 (compact) & Level 2 (bassin): hide details */
    .mode-compact .exercise-detail,
    .mode-bassin .exercise-detail {
      max-height: 0;
      opacity: 0;
      padding: 0;
    }

    .exercise-detail-text {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.5;
      padding: 6px 10px;
      background: var(--equip-bg);
      border-radius: var(--radius-sm);
      border-left: 3px solid var(--block-color);
    }

    /* ─── MILESTONE ─── */
    .timeline-milestone {
      display: flex;
      align-items: center;
      gap: 0;
      padding: 4px 0 2px;
      margin-left: calc(var(--rail-left) / 2 - 0.5px);
      opacity: 0;
      animation: blockReveal 0.4s var(--ease-out) forwards;
    }

    .milestone-line {
      height: 1px;
      background: var(--bg-muted);
    }

    .milestone-line:first-child {
      width: calc(var(--rail-left) / 2 - 6px);
    }

    .milestone-line:last-child {
      flex: 1;
    }

    .milestone-value {
      font-family: var(--font-display);
      font-size: 10px;
      font-weight: 600;
      color: var(--text-tertiary);
      padding: 1px 8px;
      font-variant-numeric: tabular-nums;
      white-space: nowrap;
    }

    .timeline-milestone:nth-child(2) { animation-delay: 0.12s; }
    .timeline-milestone:nth-child(4) { animation-delay: 0.20s; }
    .timeline-milestone:nth-child(6) { animation-delay: 0.28s; }
    .timeline-milestone:nth-child(8) { animation-delay: 0.36s; }

    /* ─── SESSION END ─── */
    .session-end {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 0 0;
      margin-left: calc(var(--rail-left) / 2);
      opacity: 0;
      animation: blockReveal 0.4s var(--ease-out) 0.5s forwards;
    }

    .session-end-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--bg-muted);
      flex-shrink: 0;
      margin-left: -4.5px;
    }

    .session-end-text {
      font-family: var(--font-display);
      font-size: 12px;
      font-weight: 600;
      color: var(--text-tertiary);
      letter-spacing: 0.04em;
    }

    /* ─── MODE COMPACT (level 1) — hide details only ─── */
    .mode-compact .block-desc {
      display: none;
    }

    /* ─── MODE BASSIN (level 2) — big text, minimal info ─── */
    .mode-bassin .block-desc,
    .mode-bassin .type-badge,
    .mode-bassin .ex-intensity,
    .mode-bassin .ex-rest {
      display: none !important;
    }

    .mode-bassin .exercise-main {
      gap: 10px;
    }

    .mode-bassin .ex-label {
      font-size: 22px;
      min-width: 95px;
    }

    .mode-bassin .stroke-badge {
      font-size: 13px;
      padding: 3px 10px 4px;
    }

    .mode-bassin .equip-icon {
      width: 38px;
      height: 38px;
    }

    .mode-bassin .equip-icon svg {
      width: 22px;
      height: 22px;
    }

    .mode-bassin .equip-label {
      font-size: 10px;
    }

    .mode-bassin .block-title {
      font-size: 14px;
    }

    .mode-bassin .block-distance {
      font-size: 17px;
    }

    /* Toggle button intermediate state */
    .poolside-toggle.level-1 {
      background: var(--bg-muted);
      border-color: var(--text-tertiary);
      color: var(--text-primary);
    }

    .poolside-toggle.level-2 {
      background: var(--intensity-v0);
      border-color: var(--intensity-v0);
      color: white;
    }

    /* ─── SCROLLBAR ─── */
    ::-webkit-scrollbar { display: none; }
    body { scrollbar-width: none; }

    /* ─── A11Y ─── */
    @media (prefers-reduced-motion: reduce) {
      .block, .timeline-milestone, .session-end {
        animation: none;
        opacity: 1;
        transform: none;
      }
      .block-exercises, .exercise-detail, .block-chevron, .block-dot {
        transition: none;
      }
    }

    /* ─── SEPARATOR ─── */
    .exercise + .exercise {
      border-top: 1px solid rgba(226,232,240,0.5);
    }
  </style>
</head>
<body>
  <div class="session-page" id="sessionPage">

    <!-- ─── HEADER ─── -->
    <header class="session-header" id="sessionHeader">
      <div class="session-header-top">
        <span class="session-date">Mardi 18 f&eacute;vrier</span>
        <button class="poolside-toggle" id="poolsideToggle" aria-label="Mode bord du bassin">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
            <path d="M12 2v6m0 8v6M4.93 4.93l4.24 4.24m5.66 5.66l4.24 4.24M2 12h6m8 0h6M4.93 19.07l4.24-4.24m5.66-5.66l4.24-4.24"/>
          </svg>
          Bassin
        </button>
      </div>
      <div class="session-metrics">
        <span class="metric-distance">4 200m</span>
        <span class="metric-secondary">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
          ~1h15
        </span>
        <span class="metric-secondary">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M3 15h18M9 3v18M15 3v18"/></svg>
          5 blocs
        </span>
      </div>
    </header>

    <!-- ─── TIMELINE ─── -->
    <main class="timeline" id="timeline">

      <!-- ═══ BLOC 1 — ÉCHAUFFEMENT ═══ -->
      <section class="block" style="--block-color: var(--intensity-v1)">
        <div class="block-rail">
          <div class="block-dot"></div>
          <div class="block-line"></div>
        </div>
        <div class="block-main">
          <button class="block-header" aria-expanded="true">
            <span class="block-title">&Eacute;chauffement</span>
            <span class="block-spacer"></span>
            <span class="block-distance">800m</span>
            <svg class="block-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <p class="block-desc">Mise en route progressive</p>
          <div class="block-exercises">

            <div class="exercise" data-detail="Nage souple, focus respiration bilat&eacute;rale">
              <div class="exercise-main">
                <span class="ex-label">400m</span>
                <span class="stroke-badge stroke-crawl">Crawl</span>
              </div>
            </div>

            <div class="exercise" data-detail="Ordre : Pap &rarr; Dos &rarr; Brasse &rarr; Crawl">
              <div class="exercise-main">
                <span class="ex-label">200m</span>
                <span class="stroke-badge stroke-4n">4 Nages</span>
              </div>
            </div>

            <div class="exercise" data-detail="Rattrap&eacute;, bras tendus. Respiration tous les 3 temps.">
              <div class="exercise-main">
                <span class="ex-label">4&times;50m</span>
                <span class="stroke-badge stroke-crawl">Crawl</span>
                <span class="type-badge type-educ">&Eacute;duc</span>
                <span class="ex-spacer"></span>
                <span class="ex-rest">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                  d:1'15
                </span>
              </div>
              <div class="exercise-equipment">
                <div class="equip-item">
                  <div class="equip-icon">
                    <svg viewBox="0 0 24 24"><path d="M6 3c-1 0-2.5 2-2.5 5s1 5 2.5 6v7h2v-7c1.5-1 2.5-3 2.5-6S7 3 6 3z"/><path d="M18 3c-1 0-2.5 2-2.5 5s1 5 2.5 6v7h2v-7c1.5-1 2.5-3 2.5-6S19 3 18 3z"/></svg>
                  </div>
                  <span class="equip-label">Pal</span>
                </div>
                <div class="equip-item">
                  <div class="equip-icon">
                    <svg viewBox="0 0 24 24"><path d="M12 2v14"/><path d="M8 16a4 4 0 0 0 8 0"/><circle cx="12" cy="20" r="2"/></svg>
                  </div>
                  <span class="equip-label">Tub</span>
                </div>
              </div>
              <div class="exercise-detail">
                <div class="exercise-detail-text"></div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Milestone -->
      <div class="timeline-milestone">
        <div class="milestone-line"></div>
        <span class="milestone-value">800m</span>
        <div class="milestone-line"></div>
      </div>

      <!-- ═══ BLOC 2 — TECHNIQUE ═══ -->
      <section class="block" style="--block-color: var(--intensity-v2)">
        <div class="block-rail">
          <div class="block-dot"></div>
          <div class="block-line"></div>
        </div>
        <div class="block-main">
          <button class="block-header" aria-expanded="true">
            <span class="block-title">Technique</span>
            <span class="block-rep">&times;2</span>
            <span class="block-spacer"></span>
            <span class="block-distance">600m</span>
            <svg class="block-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <p class="block-desc">Travail technique crawl et dos</p>
          <div class="block-exercises">

            <div class="exercise" data-detail="Doigts &eacute;cart&eacute;s puis ferm&eacute;s. Focus placement de la main &agrave; l'entr&eacute;e.">
              <div class="exercise-main">
                <span class="ex-label">4&times;50m</span>
                <span class="stroke-badge stroke-crawl">Crawl</span>
                <span class="type-badge type-educ">&Eacute;duc</span>
                <span class="ex-spacer"></span>
                <span class="ex-rest">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                  d:1'15
                </span>
              </div>
              <div class="exercise-equipment">
                <div class="equip-item">
                  <div class="equip-icon">
                    <svg viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="14" rx="2"/><circle cx="9" cy="9" r="1.5"/><circle cx="15" cy="9" r="1.5"/></svg>
                  </div>
                  <span class="equip-label">Plq</span>
                </div>
              </div>
              <div class="exercise-detail">
                <div class="exercise-detail-text"></div>
              </div>
            </div>

            <div class="exercise" data-detail="Battements r&eacute;guliers, bras le long du corps. Regard vers le plafond.">
              <div class="exercise-main">
                <span class="ex-label">100m</span>
                <span class="stroke-badge stroke-dos">Dos</span>
                <span class="type-badge type-jambes">Jambes</span>
                <span class="ex-spacer"></span>
              </div>
              <div class="exercise-equipment">
                <div class="equip-item">
                  <div class="equip-icon">
                    <svg viewBox="0 0 24 24"><path d="M6 3c-1 0-2.5 2-2.5 5s1 5 2.5 6v7h2v-7c1.5-1 2.5-3 2.5-6S7 3 6 3z"/><path d="M18 3c-1 0-2.5 2-2.5 5s1 5 2.5 6v7h2v-7c1.5-1 2.5-3 2.5-6S19 3 18 3z"/></svg>
                  </div>
                  <span class="equip-label">Pal</span>
                </div>
              </div>
              <div class="exercise-detail">
                <div class="exercise-detail-text"></div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Milestone -->
      <div class="timeline-milestone">
        <div class="milestone-line"></div>
        <span class="milestone-value">1 400m</span>
        <div class="milestone-line"></div>
      </div>

      <!-- ═══ BLOC 3 — SÉRIE PRINCIPALE ═══ -->
      <section class="block" style="--block-color: var(--intensity-v3)">
        <div class="block-rail">
          <div class="block-dot"></div>
          <div class="block-line"></div>
        </div>
        <div class="block-main">
          <button class="block-header" aria-expanded="true">
            <span class="block-title">S&eacute;rie principale</span>
            <span class="block-spacer"></span>
            <span class="block-distance">2 000m</span>
            <svg class="block-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <p class="block-desc">A&eacute;robie capacit&eacute; &rarr; puissance</p>
          <div class="block-exercises">

            <div class="exercise" data-detail="Descente 1&rarr;4 puis remonter. Viser r&eacute;gularit&eacute; du rythme.">
              <div class="exercise-main">
                <span class="ex-label">8&times;200m</span>
                <span class="stroke-badge stroke-crawl">Crawl</span>
                <span class="ex-intensity" data-i="prog">V2&#x2197;V3</span>
                <span class="ex-spacer"></span>
                <span class="ex-rest">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                  d:3'00
                </span>
              </div>
              <div class="exercise-equipment">
                <div class="equip-item">
                  <div class="equip-icon">
                    <svg viewBox="0 0 24 24"><ellipse cx="12" cy="7" rx="5" ry="4"/><ellipse cx="12" cy="17" rx="5" ry="4"/></svg>
                  </div>
                  <span class="equip-label">Pul</span>
                </div>
              </div>
              <div class="exercise-detail">
                <div class="exercise-detail-text"></div>
              </div>
            </div>

            <div class="exercise" data-detail="Sprint &agrave; fond, r&eacute;cup&eacute;ration compl&egrave;te entre chaque.">
              <div class="exercise-main">
                <span class="ex-label">4&times;100m</span>
                <span class="stroke-badge stroke-crawl">Crawl</span>
                <span class="ex-intensity" data-i="v3">V3</span>
                <span class="ex-spacer"></span>
                <span class="ex-rest">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                  d:1'45
                </span>
              </div>
              <div class="exercise-detail">
                <div class="exercise-detail-text"></div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Milestone -->
      <div class="timeline-milestone">
        <div class="milestone-line"></div>
        <span class="milestone-value">3 400m</span>
        <div class="milestone-line"></div>
      </div>

      <!-- ═══ BLOC 4 — SPRINT ═══ -->
      <section class="block" style="--block-color: var(--intensity-max)">
        <div class="block-rail">
          <div class="block-dot"></div>
          <div class="block-line"></div>
        </div>
        <div class="block-main">
          <button class="block-header" aria-expanded="true">
            <span class="block-title">Sprint</span>
            <span class="block-spacer"></span>
            <span class="block-distance">400m</span>
            <svg class="block-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <p class="block-desc">Vitesse sp&eacute;cifique</p>
          <div class="block-exercises">

            <div class="exercise" data-detail="D&eacute;part plong&eacute;, virage appliqu&eacute;. Intensit&eacute; maximale.">
              <div class="exercise-main">
                <span class="ex-label">8&times;50m</span>
                <span class="stroke-badge stroke-spe">Sp&eacute;</span>
                <span class="ex-intensity" data-i="max">Max</span>
                <span class="ex-spacer"></span>
                <span class="ex-rest">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                  d:1'30
                </span>
              </div>
              <div class="exercise-detail">
                <div class="exercise-detail-text"></div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Milestone -->
      <div class="timeline-milestone">
        <div class="milestone-line"></div>
        <span class="milestone-value">3 800m</span>
        <div class="milestone-line"></div>
      </div>

      <!-- ═══ BLOC 5 — RÉCUPÉRATION ═══ -->
      <section class="block" style="--block-color: var(--intensity-v0)">
        <div class="block-rail">
          <div class="block-dot"></div>
          <div class="block-line"></div>
        </div>
        <div class="block-main">
          <button class="block-header" aria-expanded="true">
            <span class="block-title">R&eacute;cup&eacute;ration</span>
            <span class="block-spacer"></span>
            <span class="block-distance">400m</span>
            <svg class="block-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <p class="block-desc">Retour au calme</p>
          <div class="block-exercises">

            <div class="exercise">
              <div class="exercise-main">
                <span class="ex-label">200m</span>
                <span class="stroke-badge stroke-4n">4 Nages</span>
                <span class="ex-intensity" data-i="v0">Souple</span>
              </div>
            </div>

            <div class="exercise">
              <div class="exercise-main">
                <span class="ex-label">200m</span>
                <span class="stroke-badge stroke-dos">Dos</span>
                <span class="ex-intensity" data-i="v0">Souple</span>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- End marker -->
      <div class="session-end">
        <div class="session-end-dot"></div>
        <span class="session-end-text">Fin de s&eacute;ance &mdash; 4 200m</span>
      </div>

    </main>
  </div>

  <script>
    // ─── Sticky header shadow ───
    const header = document.getElementById('sessionHeader');
    const observer = new IntersectionObserver(
      ([e]) => header.classList.toggle('scrolled', e.intersectionRatio < 1),
      { threshold: [1], rootMargin: '-1px 0px 0px 0px' }
    );
    const sentinel = document.createElement('div');
    sentinel.style.cssText = 'position:absolute;top:0;height:1px;width:1px;pointer-events:none';
    document.body.prepend(sentinel);
    observer.observe(sentinel);

    // ─── Populate exercise detail texts ───
    document.querySelectorAll('.exercise[data-detail]').forEach(ex => {
      const detailEl = ex.querySelector('.exercise-detail-text');
      if (detailEl) detailEl.textContent = ex.dataset.detail;
    });

    // ─── Block expand/collapse (manual, independent of mode) ───
    document.querySelectorAll('.block-header').forEach(btn => {
      btn.addEventListener('click', () => {
        const block = btn.closest('.block');
        const isCollapsed = block.classList.toggle('collapsed');
        btn.setAttribute('aria-expanded', !isCollapsed);
      });
    });

    // ─── 3-level toggle: Détail → Compact → Bassin ───
    const poolsideBtn = document.getElementById('poolsideToggle');
    const page = document.getElementById('sessionPage');
    let viewLevel = 0; // 0 = détail, 1 = compact, 2 = bassin

    const LEVELS = [
      { label: 'D\u00e9tail',  btnClass: '',        pageClass: '',            collapseBlocks: false },
      { label: 'Compact', btnClass: 'level-1', pageClass: 'mode-compact', collapseBlocks: false },
      { label: 'Bassin',  btnClass: 'level-2', pageClass: 'mode-bassin',  collapseBlocks: true  },
    ];

    // Icons for each level
    const ICONS = [
      // Level 0 — eye open (full detail)
      `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>`,
      // Level 1 — list compact
      `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"/></svg>`,
      // Level 2 — water/poolside
      `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/><path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/></svg>`,
    ];

    function applyLevel(level) {
      viewLevel = level;
      const cfg = LEVELS[level];

      // Update button
      poolsideBtn.className = 'poolside-toggle' + (cfg.btnClass ? ' ' + cfg.btnClass : '');
      poolsideBtn.innerHTML = ICONS[level] + ' ' + cfg.label;

      // Update page class
      page.classList.remove('mode-compact', 'mode-bassin');
      if (cfg.pageClass) page.classList.add(cfg.pageClass);

      // Collapse/expand blocks
      document.querySelectorAll('.block').forEach(block => {
        if (cfg.collapseBlocks) {
          block.classList.add('collapsed');
          block.querySelector('.block-header').setAttribute('aria-expanded', 'false');
        } else {
          block.classList.remove('collapsed');
          block.querySelector('.block-header').setAttribute('aria-expanded', 'true');
        }
      });
    }

    poolsideBtn.addEventListener('click', () => {
      applyLevel((viewLevel + 1) % 3);
    });

    // Initialize level 0
    applyLevel(0);

    // ─── Touch feedback ───
    document.querySelectorAll('.block').forEach(block => {
      block.addEventListener('touchstart', () => block.classList.add('touching'), { passive: true });
      block.addEventListener('touchend', () => block.classList.remove('touching'), { passive: true });
    });
  </script>
</body>
</html>
