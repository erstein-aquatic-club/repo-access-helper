import{r as i,j as r}from"./vendor-query-BiSH4r2z.js";import{a as P}from"./index-C8Ys7NvK.js";import{c as F}from"./animations-CrcLFysI.js";import{d as _}from"./design-tokens-CKgCpdH6.js";import{M as T,i as W,u as N,P as D,a as H,b as K,L as U,m as M}from"./proxy-Dh0N-Z8G.js";import{L as G}from"./loader-circle-D0udGttj.js";import{C as V}from"./circle-check-Dj0gXRbK.js";import{C as X}from"./circle-alert-Cg7m_XSV.js";function z(e,o){if(typeof e=="function")return e(o);e!=null&&(e.current=o)}function q(...e){return o=>{let n=!1;const s=e.map(a=>{const t=z(a,o);return!n&&typeof t=="function"&&(n=!0),t});if(n)return()=>{for(let a=0;a<s.length;a++){const t=s[a];typeof t=="function"?t():z(e[a],null)}}}}function J(...e){return i.useCallback(q(...e),e)}class O extends i.Component{getSnapshotBeforeUpdate(o){const n=this.props.childRef.current;if(n&&o.isPresent&&!this.props.isPresent){const s=n.offsetParent,a=W(s)&&s.offsetWidth||0,t=this.props.sizeRef.current;t.height=n.offsetHeight||0,t.width=n.offsetWidth||0,t.top=n.offsetTop,t.left=n.offsetLeft,t.right=a-t.width-t.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Q({children:e,isPresent:o,anchorX:n,root:s}){const a=i.useId(),t=i.useRef(null),h=i.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:C}=i.useContext(T),y=J(t,e?.ref);return i.useInsertionEffect(()=>{const{width:c,height:b,top:l,left:u,right:m}=h.current;if(o||!t.current||!c||!b)return;const x=n==="left"?`left: ${u}`:`right: ${m}`;t.current.dataset.motionPopId=a;const d=document.createElement("style");C&&(d.nonce=C);const w=s??document.head;return w.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${b}px !important;
            ${x}px !important;
            top: ${l}px !important;
          }
        `),()=>{w.contains(d)&&w.removeChild(d)}},[o]),r.jsx(O,{isPresent:o,childRef:t,sizeRef:h,children:i.cloneElement(e,{ref:y})})}const Y=({children:e,initial:o,isPresent:n,onExitComplete:s,custom:a,presenceAffectsLayout:t,mode:h,anchorX:C,root:y})=>{const c=N(Z),b=i.useId();let l=!0,u=i.useMemo(()=>(l=!1,{id:b,initial:o,isPresent:n,custom:a,onExitComplete:m=>{c.set(m,!0);for(const x of c.values())if(!x)return;s&&s()},register:m=>(c.set(m,!1),()=>c.delete(m))}),[n,c,s]);return t&&l&&(u={...u}),i.useMemo(()=>{c.forEach((m,x)=>c.set(x,!1))},[n]),i.useEffect(()=>{!n&&!c.size&&s&&s()},[n]),h==="popLayout"&&(e=r.jsx(Q,{isPresent:n,anchorX:C,root:y,children:e})),r.jsx(D.Provider,{value:u,children:e})};function Z(){return new Map}const R=e=>e.key||"";function $(e){const o=[];return i.Children.forEach(e,n=>{i.isValidElement(n)&&o.push(n)}),o}const S=({children:e,custom:o,initial:n=!0,onExitComplete:s,presenceAffectsLayout:a=!0,mode:t="sync",propagate:h=!1,anchorX:C="left",root:y})=>{const[c,b]=H(h),l=i.useMemo(()=>$(e),[e]),u=h&&!c?[]:l.map(R),m=i.useRef(!0),x=i.useRef(l),d=N(()=>new Map),[w,A]=i.useState(l),[g,k]=i.useState(l);K(()=>{m.current=!1,x.current=l;for(let p=0;p<g.length;p++){const f=R(g[p]);u.includes(f)?d.delete(f):d.get(f)!==!0&&d.set(f,!1)}},[g,u.length,u.join("-")]);const v=[];if(l!==w){let p=[...l];for(let f=0;f<g.length;f++){const j=g[f],E=R(j);u.includes(E)||(p.splice(f,0,j),v.push(j))}return t==="wait"&&v.length&&(p=v),k($(p)),A(l),null}const{forceRender:B}=i.useContext(U);return r.jsx(r.Fragment,{children:g.map(p=>{const f=R(p),j=h&&!c?!1:l===g||u.includes(f),E=()=>{if(d.has(f))d.set(f,!0);else return;let L=!0;d.forEach(I=>{I||(L=!1)}),L&&(B?.(),k(x.current),h&&b?.(),s&&s())};return r.jsx(Y,{isPresent:j,initial:!m.current||n?void 0:!1,custom:o,presenceAffectsLayout:a,mode:t,root:y,onExitComplete:j?void 0:E,anchorX:C,children:p},f)})})};function ce({children:e,className:o,containerClassName:n,saveState:s="idle",saveMessage:a,position:t="fixed"}){return r.jsxs("div",{role:"region","aria-label":"Actions",className:P(t==="fixed"?"fixed bottom-16 left-0 right-0 z-bar md:bottom-0 md:z-bar":"shrink-0",o),children:[r.jsx(S,{mode:"wait",children:s!=="idle"&&r.jsxs(M.div,{variants:s==="saved"?F:void 0,initial:"hidden",animate:"visible",exit:{opacity:0,scale:.8},className:P("mx-auto mb-2 flex max-w-md items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-medium shadow-lg motion-reduce:animate-none",s==="saving"&&"bg-muted text-muted-foreground",s==="saved"&&"bg-status-success text-white",s==="error"&&"bg-destructive text-destructive-foreground"),role:"status","aria-live":"polite",children:[s==="saving"&&r.jsxs(r.Fragment,{children:[r.jsx(G,{className:"h-4 w-4 animate-spin"}),r.jsx("span",{children:a||"Enregistrement..."})]}),s==="saved"&&r.jsxs(r.Fragment,{children:[r.jsx(M.div,{initial:{scale:0},animate:{scale:1},transition:{delay:_.fast,type:"spring",stiffness:300},children:r.jsx(V,{className:"h-4 w-4"})}),r.jsx("span",{children:a||"Enregistr√©"})]}),s==="error"&&r.jsxs(r.Fragment,{children:[r.jsx(X,{className:"h-4 w-4"}),r.jsx("span",{children:a||"Erreur lors de l'enregistrement"})]})]},s)}),r.jsx("div",{className:P("flex w-full items-center justify-between gap-2 border-t bg-background px-4 py-3",t==="fixed"&&"mx-auto max-w-md shadow-[0_-2px_10px_rgba(0,0,0,0.1)]",t==="fixed"&&"md:supports-[padding:env(safe-area-inset-bottom)]:pb-[calc(env(safe-area-inset-bottom)+0.75rem)]",t==="static"&&"supports-[padding:env(safe-area-inset-bottom)]:pb-[calc(env(safe-area-inset-bottom)+0.75rem)]",n),children:e})]})}export{S as A,ce as B};
