import{r,R as $,j as b}from"./vendor-query-BiSH4r2z.js";import{c as H,u as V}from"./index-NljO5dWE.js";import{n as q,p as z,P as G,q as J,Y as Q}from"./index-D9MvW9ak.js";import{u as W}from"./index-CtfNcwow.js";function g(e,o,{checkForDefaultPrevented:t=!0}={}){return function(u){if(e?.(u),t===!1||!u.defaultPrevented)return o?.(u)}}var X=$[" useInsertionEffect ".trim().toString()]||q;function Z({prop:e,defaultProp:o,onChange:t=()=>{},caller:n}){const[u,f,m]=ee({defaultProp:o,onChange:t}),i=e!==void 0,F=i?e:u;{const s=r.useRef(e!==void 0);r.useEffect(()=>{const d=s.current;d!==i&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),s.current=i},[i,n])}const v=r.useCallback(s=>{if(i){const d=te(s)?s(e):s;d!==e&&m.current?.(d)}else f(s)},[i,e,f,m]);return[F,v]}function ee({defaultProp:e,onChange:o}){const[t,n]=r.useState(e),u=r.useRef(t),f=r.useRef(o);return X(()=>{f.current=o},[o]),r.useEffect(()=>{u.current!==t&&(f.current?.(t),u.current=t)},[t,u]),[t,n,f]}function te(e){return typeof e=="function"}var A="rovingFocusGroup.onEntryFocus",oe={bubbles:!1,cancelable:!0},w="RovingFocusGroup",[_,N,ne]=H(w),[re,Re]=z(w,[ne]),[se,ce]=re(w),O=r.forwardRef((e,o)=>b.jsx(_.Provider,{scope:e.__scopeRovingFocusGroup,children:b.jsx(_.Slot,{scope:e.__scopeRovingFocusGroup,children:b.jsx(ue,{...e,ref:o})})}));O.displayName=w;var ue=r.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:u=!1,dir:f,currentTabStopId:m,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:F,onEntryFocus:v,preventScrollOnEntryFocus:s=!1,...d}=e,E=r.useRef(null),C=J(o,E),S=V(f),[T,c]=Z({prop:m,defaultProp:i??null,onChange:F,caller:w}),[p,h]=r.useState(!1),l=Q(v),I=N(t),y=r.useRef(!1),[k,P]=r.useState(0);return r.useEffect(()=>{const a=E.current;if(a)return a.addEventListener(A,l),()=>a.removeEventListener(A,l)},[l]),b.jsx(se,{scope:t,orientation:n,dir:S,loop:u,currentTabStopId:T,onItemFocus:r.useCallback(a=>c(a),[c]),onItemShiftTab:r.useCallback(()=>h(!0),[]),onFocusableItemAdd:r.useCallback(()=>P(a=>a+1),[]),onFocusableItemRemove:r.useCallback(()=>P(a=>a-1),[]),children:b.jsx(G.div,{tabIndex:p||k===0?-1:0,"data-orientation":n,...d,ref:C,style:{outline:"none",...e.style},onMouseDown:g(e.onMouseDown,()=>{y.current=!0}),onFocus:g(e.onFocus,a=>{const L=!y.current;if(a.target===a.currentTarget&&L&&!p){const D=new CustomEvent(A,oe);if(a.currentTarget.dispatchEvent(D),!D.defaultPrevented){const x=I().filter(R=>R.focusable),M=x.find(R=>R.active),B=x.find(R=>R.id===T),Y=[M,B,...x].filter(Boolean).map(R=>R.ref.current);j(Y,s)}}y.current=!1}),onBlur:g(e.onBlur,()=>h(!1))})})}),K="RovingFocusGroupItem",U=r.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:u=!1,tabStopId:f,children:m,...i}=e,F=W(),v=f||F,s=ce(K,t),d=s.currentTabStopId===v,E=N(t),{onFocusableItemAdd:C,onFocusableItemRemove:S,currentTabStopId:T}=s;return r.useEffect(()=>{if(n)return C(),()=>S()},[n,C,S]),b.jsx(_.ItemSlot,{scope:t,id:v,focusable:n,active:u,children:b.jsx(G.span,{tabIndex:d?0:-1,"data-orientation":s.orientation,...i,ref:o,onMouseDown:g(e.onMouseDown,c=>{n?s.onItemFocus(v):c.preventDefault()}),onFocus:g(e.onFocus,()=>s.onItemFocus(v)),onKeyDown:g(e.onKeyDown,c=>{if(c.key==="Tab"&&c.shiftKey){s.onItemShiftTab();return}if(c.target!==c.currentTarget)return;const p=le(c,s.orientation,s.dir);if(p!==void 0){if(c.metaKey||c.ctrlKey||c.altKey||c.shiftKey)return;c.preventDefault();let l=E().filter(I=>I.focusable).map(I=>I.ref.current);if(p==="last")l.reverse();else if(p==="prev"||p==="next"){p==="prev"&&l.reverse();const I=l.indexOf(c.currentTarget);l=s.loop?fe(l,I+1):l.slice(I+1)}setTimeout(()=>j(l))}}),children:typeof m=="function"?m({isCurrentTabStop:d,hasTabStop:T!=null}):m})})});U.displayName=K;var ae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ie(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function le(e,o,t){const n=ie(e.key,t);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return ae[n]}function j(e,o=!1){const t=document.activeElement;for(const n of e)if(n===t||(n.focus({preventScroll:o}),document.activeElement!==t))return}function fe(e,o){return e.map((t,n)=>e[(o+n)%e.length])}var be=O,ge=U;export{ge as I,be as R,Re as c};
