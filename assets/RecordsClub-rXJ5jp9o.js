import{r as i,a as C,j as e,C as S,g as T,h as M,i as F,S as h,b as g,d as p,e as j,f as k,B as w,k as K}from"./index-DqxBy9a5.js";import{B as y}from"./badge-CiNZkEw9.js";import{T as $,a as I,b as Y}from"./tabs-DWvja1RP.js";const D=[{key:"M",label:"Garçons"},{key:"F",label:"Filles"}],V=[{key:"25",label:"25 m"},{key:"50",label:"50 m"}],P=[{key:"8",label:"8 ans et -"},{key:"9",label:"9 ans"},{key:"10",label:"10 ans"},{key:"11",label:"11 ans"},{key:"12",label:"12 ans"},{key:"13",label:"13 ans"},{key:"14",label:"14 ans"},{key:"15",label:"15 ans"},{key:"16",label:"16 ans"},{key:"17",label:"17 ans et +"}],G=[{key:"ALL",label:"Toutes catégories"},...P],O=[{key:"ALL",label:"Toutes"},{key:"FREE",label:"Nage libre"},{key:"BACK",label:"Dos"},{key:"BREAST",label:"Brasse"},{key:"FLY",label:"Papillon"},{key:"IM",label:"4 nages"}],L=[{id:"50_FREE",label:"50 m NL",stroke:"FREE"},{id:"100_FREE",label:"100 m NL",stroke:"FREE"},{id:"200_FREE",label:"200 m NL",stroke:"FREE"},{id:"400_FREE",label:"400 m NL",stroke:"FREE"},{id:"800_FREE",label:"800 m NL",stroke:"FREE"},{id:"1500_FREE",label:"1500 m NL",stroke:"FREE"},{id:"50_BACK",label:"50 m Dos",stroke:"BACK"},{id:"100_BACK",label:"100 m Dos",stroke:"BACK"},{id:"200_BACK",label:"200 m Dos",stroke:"BACK"},{id:"50_BREAST",label:"50 m Brasse",stroke:"BREAST"},{id:"100_BREAST",label:"100 m Brasse",stroke:"BREAST"},{id:"200_BREAST",label:"200 m Brasse",stroke:"BREAST"},{id:"50_FLY",label:"50 m Pap",stroke:"FLY"},{id:"100_FLY",label:"100 m Pap",stroke:"FLY"},{id:"200_FLY",label:"200 m Pap",stroke:"FLY"},{id:"200_IM",label:"200 m 4N",stroke:"IM"},{id:"400_IM",label:"400 m 4N",stroke:"IM"}],q=a=>{if(!a&&a!==0)return"-";const l=Math.round(a/10),o=l%100,c=Math.floor(l/100),n=c%60,d=Math.floor(c/60),t=x=>String(x).padStart(2,"0");return d>0?`${d}:${t(n)}.${t(o)}`:`${n}.${t(o)}`},z=a=>{if(!a)return"-";const l=new Date(a);return Number.isNaN(l.getTime())?a:l.toLocaleDateString("fr-FR")},H=a=>a.replace(/^\d+_/,""),Q=(a,l)=>a.event_label||l.get(a.event_code)||a.event_code;function W(){const[a,l]=i.useState("25"),[o,c]=i.useState("M"),[n,d]=i.useState("ALL"),[t,x]=i.useState("ALL"),R=n==="ALL"?null:Number(n),{data:u=[],isLoading:E,error:f,refetch:A}=C({queryKey:["club-records",a,o,n],queryFn:()=>K.getClubRecords({pool_m:Number(a),sex:o,age:R})}),B=i.useMemo(()=>new Map(L.map(s=>[s.id,s.label])),[]),b=i.useMemo(()=>new Map(L.map((s,r)=>[s.id,r])),[]),v=i.useMemo(()=>[...t==="ALL"?u:u.filter(r=>H(r.event_code)===t)].sort((r,m)=>{const N=b.get(r.event_code)??999,_=b.get(m.event_code)??999;return N!==_?N-_:r.age!==m.age?r.age-m.age:r.time_ms-m.time_ms}),[u,t,b]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-display font-bold uppercase italic text-primary",children:"Records du club"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Retrouvez les meilleures performances par épreuve, sexe, bassin et catégorie d’âge."})]}),e.jsxs(S,{children:[e.jsx(T,{children:e.jsx(M,{className:"text-base",children:"Filtres rapides"})}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[e.jsxs(h,{value:a,onValueChange:l,children:[e.jsx(g,{children:e.jsx(p,{placeholder:"Bassin"})}),e.jsx(j,{children:V.map(s=>e.jsx(k,{value:s.key,children:s.label},s.key))})]}),e.jsxs(h,{value:o,onValueChange:c,children:[e.jsx(g,{children:e.jsx(p,{placeholder:"Sexe"})}),e.jsx(j,{children:D.map(s=>e.jsx(k,{value:s.key,children:s.label},s.key))})]}),e.jsxs(h,{value:n,onValueChange:d,children:[e.jsx(g,{children:e.jsx(p,{placeholder:"Catégorie d'âge"})}),e.jsx(j,{children:G.map(s=>e.jsx(k,{value:s.key,children:s.label},s.key))})]})]}),e.jsx($,{value:t,onValueChange:x,children:e.jsx(I,{className:"flex w-full justify-start gap-2 overflow-x-auto",children:O.map(s=>e.jsx(Y,{value:s.key,className:"shrink-0",children:s.label},s.key))})})]})]}),e.jsxs("div",{className:"space-y-3",children:[E&&e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx("div",{className:"h-24 w-full rounded-xl bg-muted animate-pulse motion-reduce:animate-none"},s))}),f&&e.jsxs("div",{className:"rounded-lg border border-destructive/20 bg-destructive/10 p-4 text-sm text-destructive",children:[e.jsx("p",{children:"Impossible de charger les records."}),e.jsx(w,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>A(),children:"Réessayer"})]}),!E&&!f&&v.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Aucun record disponible pour ces filtres."}),v.map(s=>e.jsx(S,{className:"shadow-sm",children:e.jsxs(F,{className:"flex flex-col gap-3 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:Q(s,B)}),e.jsx("div",{className:"text-2xl font-semibold text-primary",children:q(s.time_ms)})]}),e.jsxs("div",{className:"text-sm text-muted-foreground sm:text-right",children:[e.jsx("div",{className:"font-semibold text-foreground",children:s.athlete_name}),e.jsx("div",{children:z(s.record_date)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(y,{variant:"secondary",children:s.sex==="M"?"Garçons":"Filles"}),e.jsxs(y,{variant:"outline",children:[s.pool_m," m"]}),e.jsxs(y,{variant:"outline",children:[s.age," ans"]})]})]})},`${s.event_code}-${s.age}-${s.sex}-${s.pool_m}`))]})]})}export{W as default};
