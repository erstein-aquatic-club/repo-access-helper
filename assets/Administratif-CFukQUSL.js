import{j as e,R as p,b as He,r as B}from"./vendor-ui-Cp7LoSvI.js";import{a as Ke,B as z,L as G,I as J,f as ze,u as Y,R as Ge,n as A,d as L,o as Qe}from"./index-bF_flMZb.js";import{b as We,u as ne,c as H}from"./vendor-query-DWM3xq1x.js";import{C as Ye}from"./checkbox-EoTQTbw5.js";import{S as Xe,a as Je,b as Ue,c as Ze,d as et}from"./select-W_K7_xI9.js";import{f as R,g as K}from"./timesheetHelpers-kt0Mqny_.js";import{f as C}from"./vendor-date-cQbdWov0.js";import{R as tt,B as rt,C as st,X as nt,Y as at,T as ot,a as it}from"./vendor-charts-BtSE1gaf.js";import"./vendor-react-BzrpNAyj.js";import"./vendor-supabase-Cs1gO9iU.js";import"./check-DVkUw4X6.js";import"./chevron-up-qECYr6gR.js";function lt({children:s,className:r,top:a=!1,bottom:o=!1,left:n=!1,right:l=!1}){return e.jsx("div",{className:Ke(r),style:{paddingTop:a?"env(safe-area-inset-top)":void 0,paddingBottom:o?"env(safe-area-inset-bottom)":void 0,paddingLeft:n?"env(safe-area-inset-left)":void 0,paddingRight:l?"env(safe-area-inset-right)":void 0},children:s})}const O=s=>String(s).padStart(2,"0"),oe=(s,r,a)=>Math.max(r,Math.min(a,s)),dt=(s,r)=>{const a=Math.round(s/r)*r;return oe(a,0,60-r)},_e=(s,r=5)=>{const[a,o]=s.split(":"),n=Number(a),l=Number(o),h=oe(Number.isFinite(n)?n:0,0,23),N=oe(Number.isFinite(l)?l:0,0,59),x=dt(N,r);return`${O(h)}:${O(x)}`},ct=(s,r)=>{const a=_e(s,r),[o,n]=a.split(":").map(l=>Number(l));return{hours:o,minutes:n}};function we({value:s,values:r,onChange:a,width:o=68,itemHeight:n=28,visibleCount:l=3,format:h,snapKey:N}){const x=p.useRef(null),g=Math.floor(l/2)*n,[y,T]=p.useState(s),j=p.useRef(s),w=p.useRef(s),f=p.useRef(null),c=p.useRef(null),b=p.useRef(!1);return p.useEffect(()=>{w.current=s,j.current=s,T(s);const m=x.current;if(!m||b.current)return;const S=Math.max(0,r.indexOf(s));m.scrollTo({top:S*n,behavior:"instant"})},[n,s,r]),p.useEffect(()=>{const m=x.current;if(!m)return;const S=Math.max(0,r.indexOf(s));m.scrollTo({top:S*n,behavior:"instant"})},[n,N,s,r]),p.useEffect(()=>{const m=x.current;if(!m)return;const S=()=>{const M=Math.round(m.scrollTop/n),k=r[Math.max(0,Math.min(r.length-1,M))];j.current=k,T(k)},_=()=>{const M=j.current;M!==w.current&&a(M),b.current=!1},F=()=>{b.current=!0,f.current&&cancelAnimationFrame(f.current),f.current=requestAnimationFrame(S),c.current&&window.clearTimeout(c.current),c.current=window.setTimeout(_,140)};return m.addEventListener("scroll",F,{passive:!0}),()=>{m.removeEventListener("scroll",F),f.current&&cancelAnimationFrame(f.current),c.current&&window.clearTimeout(c.current)}},[n,a,r]),e.jsx("div",{style:{width:o,minWidth:0,flex:`0 0 ${o}px`},children:e.jsxs("div",{className:"relative overflow-hidden rounded-xl border border-border bg-card",children:[e.jsx("div",{className:"pointer-events-none absolute left-0 right-0 top-0 z-[2]",style:{height:g,background:"linear-gradient(hsl(var(--background)), transparent)"}}),e.jsx("div",{className:"pointer-events-none absolute left-0 right-0 bottom-0 z-[2]",style:{height:g,background:"linear-gradient(transparent, hsl(var(--background)))"}}),e.jsx("div",{className:"pointer-events-none absolute left-1.5 right-1.5 z-[1] rounded-lg",style:{top:g,height:n,background:"rgba(17,17,17,0.14)",boxShadow:"inset 0 0 0 1px rgba(17,17,17,0.25)"}}),e.jsx("div",{ref:x,style:{height:n*l,overflowY:"auto",overflowX:"hidden",scrollSnapType:"y mandatory",scrollSnapStop:"always",WebkitOverflowScrolling:"touch",paddingTop:g,paddingBottom:g,touchAction:"pan-y",overscrollBehavior:"contain"},children:r.map(m=>{const S=m===y;return e.jsx("div",{className:`flex items-center justify-center text-[15px] font-bold ${S?"text-foreground":"text-muted-foreground"}`,style:{height:n,scrollSnapAlign:"center",fontWeight:S?900:700,userSelect:"none"},children:h?h(m):String(m)},m)})})]})})}function Se({label:s,value:r,onChange:a,allowEmpty:o=!1,showEmptyButton:n=!0,snapKey:l}){const h=p.useMemo(()=>Array.from({length:24},(c,b)=>b),[]),N=p.useMemo(()=>Array.from({length:12},(c,b)=>b*5),[]),x=r||"00:00",g=p.useMemo(()=>ct(x,5),[x]),[y,T]=p.useState(g.hours),[j,w]=p.useState(g.minutes);p.useEffect(()=>{T(g.hours),w(g.minutes)},[g.hours,g.minutes]),p.useEffect(()=>{if(!r)return;const c=_e(r,5),[b,m]=c.split(":");T(Number(b)),w(Number(m))},[r]);const f=p.useCallback((c,b)=>{a(`${O(c)}:${O(b)}`)},[a]);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-black text-foreground",children:s}),e.jsxs("div",{className:"flex flex-wrap items-end justify-center gap-2",children:[e.jsx(we,{value:y,values:h,onChange:c=>{T(c),f(c,j)},format:c=>O(c),snapKey:l}),e.jsx(we,{value:j,values:N,onChange:c=>{w(c),f(y,c)},format:c=>O(c),snapKey:l})]}),o&&n?e.jsx("button",{type:"button",onClick:()=>a(""),className:"mx-auto block h-8 min-w-[110px] rounded-full border border-border bg-card px-3 text-xs font-bold text-foreground",children:"En cours"}):null]})}const U=s=>String(s).padStart(2,"0"),ae=()=>{const s=new Date,r=Math.round(s.getMinutes()/5)*5,a=r===60?1:0,o=(s.getHours()+a)%24,n=r===60?0:r;return`${U(o)}:${U(n)}`},ut=(s,r)=>{const[a,o]=s.split(":").map(g=>Number(g)),n=Number.isFinite(a)?a:0,l=Number.isFinite(o)?o:0,h=(n*60+l+r+1440)%1440,N=Math.floor(h/60),x=h%60;return`${U(N)}:${U(x)}`};function mt({isOpen:s,isEditing:r,isSaving:a,date:o,startTime:n,endTime:l,location:h,isTravel:N,durationLabel:x,locations:g,onClose:y,onSubmit:T,onDateChange:j,onStartTimeChange:w,onEndTimeChange:f,onLocationChange:c,onTravelChange:b,onCreateLocation:m,onDeleteLocation:S}){const _=p.useMemo(()=>s?Date.now():0,[s]),[F,M]=p.useState(!1),[k,$]=p.useState("");return p.useEffect(()=>{if(!s||r||n)return;const v=ae();w(v),l||f(ut(v,60))},[l,r,s,f,w,n]),s?e.jsx("div",{role:"dialog","aria-modal":"true","aria-label":r?"Modifier shift":"Nouveau shift",className:"fixed inset-0 z-modal flex items-end justify-center bg-black/35 px-3 pb-3",onClick:y,children:e.jsxs("div",{className:"w-full max-w-3xl overflow-hidden rounded-2xl bg-card shadow-[0_12px_40px_rgba(0,0,0,0.2)]",onClick:v=>v.stopPropagation(),children:[e.jsx("div",{className:"mx-auto mt-2 h-1.5 w-10 rounded-full bg-muted"}),e.jsxs("div",{className:"grid grid-cols-[1fr_auto] items-center gap-2 px-4 pb-2 pt-3 text-sm font-black",children:[e.jsx("div",{children:r?"Modifier shift":"Nouveau shift"}),e.jsx(z,{type:"button",variant:"outline",size:"sm",onClick:y,children:"Fermer"}),e.jsxs("div",{className:"col-span-2 text-center text-sm font-black text-card-foreground",children:[n||"—"," → ",l||"En cours",x?` • Durée ${x}`:null]})]}),e.jsxs("form",{onSubmit:T,className:"max-h-[72vh] space-y-4 overflow-y-auto px-4 pb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"shift-date",children:"Date"}),e.jsx(J,{id:"shift-date",type:"date",value:o,onChange:v=>j(v.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(Se,{label:"Heure d’arrivée",value:n,onChange:w,snapKey:_}),e.jsx("button",{type:"button","aria-label":"Heure d'arrivée maintenant",className:"mx-auto block h-8 min-w-[110px] rounded-full border border-border bg-card px-3 text-xs font-bold text-card-foreground",onClick:()=>{const v=ae();w(v)},children:"Maintenant"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Se,{label:"Heure de sortie",value:l,onChange:f,allowEmpty:!0,showEmptyButton:!1,snapKey:_}),e.jsx("button",{type:"button","aria-label":"Heure de sortie maintenant",className:"mx-auto block h-8 min-w-[110px] rounded-full border border-border bg-card px-3 text-xs font-bold text-card-foreground",onClick:()=>{const v=ae();f(v)},children:"Maintenant"}),e.jsx("button",{type:"button","aria-label":"Marquer comme en cours",className:"mx-auto block h-8 min-w-[110px] rounded-full border border-border bg-card px-3 text-xs font-bold text-card-foreground",onClick:()=>f(""),children:"En cours"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"shift-location",children:"Lieu"}),e.jsxs(Xe,{value:h||void 0,onValueChange:c,children:[e.jsx(Je,{id:"shift-location",children:e.jsx(Ue,{placeholder:"Sélectionner un lieu"})}),e.jsx(Ze,{children:g.map(v=>e.jsx(et,{value:v.name,children:v.name},v.id))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{id:"shift-travel",checked:N,onCheckedChange:v=>b(v===!0)}),e.jsx(G,{htmlFor:"shift-travel",children:"Temps de trajet"})]}),e.jsxs("div",{className:"flex gap-3 border-t border-border pt-3",children:[e.jsx(z,{type:"button",variant:"outline",className:"flex-1",onClick:y,children:"Annuler"}),e.jsx(z,{type:"submit",className:"flex-1",disabled:a,children:r?"Enregistrer":"Ajouter"})]})]})]})}):null}const X=s=>{if(!s)return"—";const r=new Date(s);return Number.isNaN(r.getTime())?"—":C(r,"HH:mm")},xt=s=>{const r=new Date(s);return Number.isNaN(r.getTime())?s:new Intl.DateTimeFormat("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).format(r)};function ft({groups:s,onEdit:r,onDelete:a}){return e.jsx("div",{className:"rounded-2xl border border-border bg-card shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:s.length===0?e.jsx("div",{className:"px-4 py-4 text-sm text-muted-foreground",children:"Aucun shift pour l’instant."}):s.map(o=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-border bg-muted px-3 py-2 text-xs font-black capitalize text-foreground",children:[e.jsx("span",{children:xt(o.date)}),e.jsx("span",{children:R(o.totalMinutes)})]}),e.jsx("div",{children:o.shifts.map(n=>{const l=K(n),h=l===null;return e.jsxs("div",{className:"flex flex-wrap items-start gap-3 border-b border-border/50 px-3 py-3",children:[e.jsx("span",{className:n.is_travel?"rounded-full border border-border bg-status-warning-bg px-2 py-1 text-[11px] font-semibold text-foreground":"rounded-full border border-border bg-tag-swim-bg/10 px-2 py-1 text-[11px] font-semibold text-foreground",children:n.is_travel?"Trajet":"Travail"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[e.jsxs("div",{className:"text-sm font-black text-foreground",children:[X(n.start_time)," → ",n.end_time?X(n.end_time):"En cours",l!==null?e.jsxs("span",{className:"ml-1 text-xs font-semibold text-muted-foreground",children:["(",R(l),")"]}):null]}),e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-border bg-card px-3 py-2.5 text-xs font-bold text-foreground cursor-pointer min-h-[44px] min-w-[44px] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",onClick:()=>r(n),"aria-label":`Modifier le shift ${X(n.start_time)}`,children:"Modifier"}),e.jsx("button",{type:"button",className:"rounded-lg border border-border bg-card px-3 py-2.5 text-xs font-bold text-foreground cursor-pointer min-h-[44px] min-w-[44px] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",onClick:()=>a(n.id),"aria-label":`Supprimer le shift ${X(n.start_time)}`,children:"Suppr."})]})]}),e.jsx("div",{className:"mt-1 text-sm text-foreground",children:n.location||"Lieu non précisé"}),h?e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"En cours"}):null]})]},n.id)})})]},o.date))})}const Te=s=>{if(!s)return"";if(/^\d{2}:\d{2}(:\d{2})?$/.test(s))return s.slice(0,5);const r=new Date(s);return Number.isNaN(r.getTime())?"":C(r,"HH:mm")},q=s=>s.shift_date,Me=(s,r,a)=>{const o=new Date(s).getTime(),n=new Date(r).getTime(),l=new Date(a).getTime(),h=Math.min(n,l),N=Math.max(n,l);return o>=h&&o<=N},ke=s=>s.find(r=>r.name==="Piscine")?.name??s[0]?.name??"Piscine";function kt({initialTab:s="POINTAGE"}){const{useMemo:r,useState:a}=He,{toast:o}=ze(),n=We(),l=typeof window>"u"?Y.getState().role:Y(t=>t.role),h=typeof window>"u"?Y.getState().userId:Y(t=>t.userId),N=l==="coach"||l==="admin",[x,g]=a(s),[y,T]=a(()=>C(new Date,"yyyy-MM-dd")),[j,w]=a(""),[f,c]=a(""),[b,m]=a("Piscine"),[S,_]=a(!1),[F,M]=a(!0),[k,$]=a(null),[v,De]=a(!1),[Z,ie]=a(""),{data:D=[],error:le}=ne({queryKey:["timesheet-shifts",h],queryFn:()=>L.listTimesheetShifts({coachId:h??void 0}),enabled:N}),{data:E=[],error:de}=ne({queryKey:["timesheet-locations"],queryFn:()=>L.listTimesheetLocations(),enabled:N}),{data:ce,error:ue}=ne({queryKey:["capabilities","timesheet"],queryFn:()=>L.getCapabilities(),enabled:Qe.hasSupabase}),Q=r(()=>ke(E),[E]),ee=B.useCallback(()=>{T(C(new Date,"yyyy-MM-dd")),w(""),c(""),m(Q),_(!1)},[Q]),me=H({mutationFn:t=>L.createTimesheetShift(t),onSuccess:()=>{n.invalidateQueries({queryKey:["timesheet-shifts"]}),ee(),o({title:"Shift enregistré"})},onError:t=>{const i=A(t,"Impossible d'enregistrer le shift.");o({title:"Erreur",description:i.message})}}),xe=H({mutationFn:t=>L.updateTimesheetShift(t),onSuccess:()=>{n.invalidateQueries({queryKey:["timesheet-shifts"]}),M(!1),$(null),ee(),o({title:"Shift mis à jour"})},onError:t=>{const i=A(t,"Impossible de modifier le shift.");o({title:"Erreur",description:i.message})}}),Ee=H({mutationFn:t=>L.deleteTimesheetShift(t),onSuccess:()=>{n.invalidateQueries({queryKey:["timesheet-shifts"]})},onError:t=>{const i=A(t,"Impossible de supprimer le shift.");o({title:"Erreur",description:i.message})}}),te=H({mutationFn:t=>L.createTimesheetLocation(t),onSuccess:()=>{n.invalidateQueries({queryKey:["timesheet-locations"]})},onError:t=>{const i=A(t,"Impossible d'ajouter le lieu.");o({title:"Erreur",description:i.message})}}),re=H({mutationFn:t=>L.deleteTimesheetLocation(t),onSuccess:(t,i)=>{n.invalidateQueries({queryKey:["timesheet-locations"]});const d=E.filter(u=>u.id!==i.id);b&&d.every(u=>u.name!==b)&&m(ke(d))},onError:t=>{const i=A(t,"Impossible de supprimer le lieu.");o({title:"Erreur",description:i.message})}}),fe=C(new Date,"yyyy-MM-dd"),Ae=r(()=>D.reduce((t,i)=>{if(q(i)!==fe)return t;const u=K(i);return u?t+u:t},0),[D,fe]),Le=r(()=>{const t=[...D].sort((d,u)=>d.start_time<u.start_time?1:-1),i=new Map;return t.forEach(d=>{const u=q(d);i.has(u)||i.set(u,[]),i.get(u)?.push(d)}),Array.from(i.entries()).map(([d,u])=>{const I=u.reduce((ye,Be)=>{const Ne=K(Be);return Ne?ye+Ne:ye},0);return{date:d,shifts:u,totalMinutes:I}}).sort((d,u)=>d.date<u.date?1:-1)},[D]),se=r(()=>new Date,[]),[P,Ce]=a(()=>C(new Date(se.getFullYear(),se.getMonth(),1),"yyyy-MM-dd")),[V,Fe]=a(()=>C(se,"yyyy-MM-dd")),W=r(()=>{const t=D.filter(i=>Me(q(i),P,V));return t.reduce((i,d)=>{const I=K(d)??0;return d.is_travel?i.travel+=I:i.work+=I,i.total+=I,i},{count:t.length,work:0,travel:0,total:0})},[P,V,D]),be=r(()=>{const t=D.filter(d=>Me(q(d),P,V)),i=new Map;return t.forEach(d=>{const u=q(d),I=K(d)??0;i.set(u,(i.get(u)??0)+I)}),Array.from(i.entries()).map(([d,u])=>({date:d,label:C(new Date(d),"dd/MM"),hours:Number((u/60).toFixed(2))})).sort((d,u)=>d.date<u.date?-1:1)},[P,V,D]),pe=r(()=>new Intl.DateTimeFormat("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),[]);if(!N)return typeof window>"u"?null:e.jsx(Ge,{to:"/"});const he=ue?A(ue,"Impossible de vérifier le module de pointage.").message:ce?.mode==="supabase"&&!ce.timesheet.available?"Pointage heures indisponible (tables manquantes côté D1).":null,ge=le?A(le,"Impossible de charger les shifts.").message:null,ve=de?A(de,"Impossible de charger les lieux.").message:null,Ie=me.isPending||xe.isPending,je=te.isPending||re.isPending,Re=r(()=>{if(!j||!f)return null;const t=new Date(`${y}T${j}`),i=new Date(`${y}T${f}`);if(Number.isNaN(t.getTime())||Number.isNaN(i.getTime()))return null;const d=(i.getTime()-t.getTime())/6e4;return d<=0?null:R(d)},[y,j,f]),$e=t=>{if(t.preventDefault(),!y||!j){o({title:"Champs requis",description:"Date et heure de début obligatoires."});return}if(f&&f<=j){o({title:"Heures invalides",description:"La fin doit être après le début."});return}if(!h){o({title:"Utilisateur manquant"});return}if(k){xe.mutate({id:k,coach_id:h,shift_date:y,start_time:j,end_time:f||null,location:b.trim()||null,is_travel:S});return}me.mutate({coach_id:h,shift_date:y,start_time:j,end_time:f||null,location:b.trim()||null,is_travel:S})},Pe=()=>{ee(),$(null),M(!0)},Ve=t=>{$(t.id),T(q(t)),w(Te(t.start_time)),c(t.end_time?Te(t.end_time):""),m(t.location??""),_(t.is_travel),M(!0)},qe=()=>{M(!1),$(null)};B.useEffect(()=>{x==="DASHBOARD"&&(M(!1),$(null))},[x]),B.useEffect(()=>{!F||k||(!b||E.every(t=>t.name!==b))&&m(Q)},[Q,k,F,b,E]);const Oe=()=>{const t=Z.trim();t&&(te.mutate({name:t}),ie(""))};return e.jsxs(lt,{top:!0,bottom:!0,className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"mx-auto flex w-full max-w-3xl flex-col gap-4 px-4 pb-24 pt-4 text-foreground",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-black tracking-[0.2px]",children:"ADMINISTRATIF"}),e.jsxs("div",{className:"flex items-center gap-1 rounded-full border border-border bg-card p-1 text-xs font-extrabold",children:[e.jsx("button",{type:"button",className:`rounded-full px-3 py-2 ${x==="POINTAGE"?"bg-primary text-primary-foreground":"text-foreground"}`,"aria-current":x==="POINTAGE"?"page":void 0,onClick:()=>g("POINTAGE"),children:"Pointage"}),e.jsx("button",{type:"button",className:`rounded-full px-3 py-2 ${x==="DASHBOARD"?"bg-primary text-primary-foreground":"text-foreground"}`,"aria-current":x==="DASHBOARD"?"page":void 0,onClick:()=>g("DASHBOARD"),children:"Dashboard"})]})]}),he?e.jsx("div",{className:"rounded-2xl border border-dashed border-border bg-card px-4 py-3 text-sm text-muted-foreground",children:he}):null,ge?e.jsx("div",{className:"rounded-2xl border border-destructive/20 bg-destructive/10 px-4 py-3 text-sm text-destructive",children:ge}):null,ve?e.jsx("div",{className:"rounded-2xl border border-destructive/20 bg-destructive/10 px-4 py-3 text-sm text-destructive",children:ve}):null,x==="POINTAGE"?e.jsxs(B.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl border border-border bg-card px-4 py-3 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Heures aujourd'hui"}),e.jsx("div",{className:"mt-1 text-2xl font-black text-foreground",children:R(Ae)})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card px-4 py-3 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-sm font-black text-foreground",children:"Lieux"}),e.jsx(z,{type:"button",variant:"outline",size:"sm",onClick:()=>De(t=>!t),children:"Gérer les lieux"})]}),v?e.jsxs("div",{className:"mt-3 space-y-3 text-sm text-muted-foreground",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:E.length?E.map(t=>e.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-border bg-card px-3 py-1 text-xs font-semibold text-muted-foreground",children:[e.jsx("span",{children:t.name}),e.jsx("button",{type:"button",className:"text-muted-foreground transition hover:text-foreground",onClick:()=>re.mutate({id:t.id}),"aria-label":`Supprimer ${t.name}`,disabled:je,children:"✕"})]},t.id)):e.jsx("span",{className:"text-xs text-muted-foreground",children:"Aucun lieu enregistré."})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(J,{value:Z,onChange:t=>ie(t.target.value),placeholder:"Nouveau lieu",className:"min-w-[160px] flex-1"}),e.jsx(z,{type:"button",size:"sm",onClick:Oe,disabled:!Z.trim()||je,children:"Ajouter"})]})]}):null]}),e.jsx(ft,{groups:Le,onEdit:Ve,onDelete:t=>Ee.mutate({id:t})}),e.jsx("button",{type:"button",className:"fixed bottom-4 right-4 z-fab flex h-14 w-14 items-center justify-center rounded-full bg-destructive text-2xl font-black text-white shadow-[0_8px_20px_rgba(220,38,38,0.25)]",onClick:Pe,"aria-label":"Ajouter un shift",children:"+"})]}):e.jsxs(B.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl border border-dashed border-border bg-card px-4 py-4 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"text-base font-black text-foreground",children:"Dashboard KPI"}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsxs("div",{className:"min-w-[180px] flex-1 space-y-2",children:[e.jsx(G,{htmlFor:"dashboard-from",children:"Du"}),e.jsx(J,{id:"dashboard-from",type:"date",value:P,onChange:t=>Ce(t.target.value)})]}),e.jsxs("div",{className:"min-w-[180px] flex-1 space-y-2",children:[e.jsx(G,{htmlFor:"dashboard-to",children:"Au"}),e.jsx(J,{id:"dashboard-to",type:"date",value:V,onChange:t=>Fe(t.target.value)})]})]}),e.jsxs("div",{className:"mt-3 text-xs text-muted-foreground",children:["Période sélectionnée : ",pe.format(new Date(P))," →"," ",pe.format(new Date(V))]})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card px-4 py-4 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"mb-3 text-sm font-black text-foreground",children:"Heures par jour"}),be.length?e.jsx("div",{className:"h-56 w-full",children:e.jsx(tt,{width:"100%",height:"100%",children:e.jsxs(rt,{data:be,margin:{top:8,right:12,left:-10,bottom:8},children:[e.jsx(st,{strokeDasharray:"3 3",vertical:!1}),e.jsx(nt,{dataKey:"label",tickLine:!1,axisLine:!1}),e.jsx(at,{tickLine:!1,axisLine:!1,tickFormatter:t=>`${t}h`}),e.jsx(ot,{formatter:t=>`${t} h`,labelFormatter:t=>`Jour ${t}`}),e.jsx(it,{dataKey:"hours",fill:"hsl(var(--primary))",radius:[6,6,0,0]})]})})}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"Aucune donnée sur la période."})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card px-4 py-4 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"mb-3 text-sm font-black text-foreground",children:"Résumé période"}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:[{label:"Total",value:R(W.total),hint:"Travail + trajet"},{label:"Shifts",value:W.count.toString(),hint:"Nombre sur la période"},{label:"Travail",value:R(W.work),hint:"Heures de travail"},{label:"Trajet",value:R(W.travel),hint:"Heures de trajet"}].map(t=>e.jsxs("div",{className:"rounded-2xl border border-dashed border-border bg-card p-3 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:t.label}),e.jsx("div",{className:"text-lg font-black text-foreground",children:t.value}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.hint})]},t.label))})]}),e.jsxs("div",{className:"rounded-2xl border border-border bg-card px-4 py-4 shadow-[0_1px_6px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"mb-2 text-sm font-black text-foreground",children:"Graphiques (à venir)"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["• Bar chart : heures par jour (période)",e.jsx("br",{}),"• Donut : % trajet vs travail",e.jsx("br",{}),"• Top lieux : heures cumulées",e.jsx("br",{}),"• Variations : période vs période-1"]})]})]})]}),x==="POINTAGE"?e.jsx(mt,{isOpen:F,isEditing:!!k,isSaving:Ie,date:y,startTime:j,endTime:f,location:b,isTravel:S,durationLabel:Re,locations:E,onClose:qe,onSubmit:$e,onDateChange:T,onStartTimeChange:w,onEndTimeChange:c,onLocationChange:m,onTravelChange:_,onCreateLocation:t=>te.mutate({name:t}),onDeleteLocation:t=>re.mutate({id:t})}):null]})}export{kt as default};
