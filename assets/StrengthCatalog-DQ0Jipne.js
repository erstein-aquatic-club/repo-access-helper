import{r as u,b as $s,h as Ls,m as es,n as Ks,j as e,d as ss,o as Gs,l as ie,u as ye,I as Us,t as Qs,E as zs}from"./vendor-ui-DJQMR4VV.js";import{b as Bs,u as W,c as I}from"./vendor-query-BT4y-huw.js";import{c as Ne,a as L,C as Vs,L as w,I as R,f as Ws,d as D,B as q,S as xe,D as Pe,s as Ae}from"./index-By6vndWk.js";import{u as Hs,S as Y,a as J,b as Z,c as ee,d as M}from"./select-DDJPJEZ6.js";import{C as Xs}from"./circle-D-fAW11H.js";import{T as se}from"./textarea-B1LBbCoe.js";import{D as te,a as re,b as fe,c as ge}from"./dialog-jo0xjnoW.js";import{C as qe}from"./checkbox-BEqqb_ht.js";import{A as Oe,a as Te,b as $e,c as Le,d as Ke,e as Ge,f as Ue,g as Qe}from"./alert-dialog-DjrSbOUy.js";import{T as Ys,a as Js,b as Zs,c as et}from"./tabs-BLqWaDO-.js";import{A as st,a as tt,F as rt,S as nt,P as at,b as it,c as ze,d as Be}from"./SessionListView-D53ZG_Gx.js";import{C as lt}from"./chevron-up-C0MP4r_J.js";import{T as ne,P as ae}from"./trash-2-CpZU162b.js";import{P as ts,a as rs,b as ns}from"./Coach-C4DGphrk.js";import{C as ct}from"./chevron-right-D1I-GcQ2.js";import{L as Ve}from"./loader-circle-sXnc5l0V.js";import{C as ot}from"./circle-alert-BNLpPs_S.js";import{S as dt}from"./search-DSvzQ8lT.js";import{P as We}from"./pen-CHjaD3Z9.js";import"./vendor-react-BzrpNAyj.js";import"./vendor-charts-Db4xOvcx.js";import"./vendor-supabase-D7B1G6YZ.js";import"./check-CkycU_cH.js";import"./chevron-left-DoZ7YllO.js";import"./save-CHWfMyRL.js";import"./table-65fbXHkl.js";import"./badge-BqPpzKHA.js";import"./arrow-left-Bzn_b4yk.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],mt=Ne("ellipsis",ut);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],xt=Ne("funnel",pt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],He=Ne("upload",ht);function je(t,n,{checkForDefaultPrevented:a=!0}={}){return function(i){if(t?.(i),a===!1||!i.defaultPrevented)return n?.(i)}}var ft=$s[" useInsertionEffect ".trim().toString()]||Ls;function gt({prop:t,defaultProp:n,onChange:a=()=>{},caller:d}){const[i,c,g]=jt({defaultProp:n,onChange:a}),x=t!==void 0,v=x?t:i;{const m=u.useRef(t!==void 0);u.useEffect(()=>{const h=m.current;h!==x&&console.warn(`${d} is changing from ${h?"controlled":"uncontrolled"} to ${x?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=x},[x,d])}const p=u.useCallback(m=>{if(x){const h=vt(m)?m(t):m;h!==t&&g.current?.(h)}else c(m)},[x,t,c,g]);return[v,p]}function jt({defaultProp:t,onChange:n}){const[a,d]=u.useState(t),i=u.useRef(a),c=u.useRef(n);return ft(()=>{c.current=n},[n]),u.useEffect(()=>{i.current!==a&&(c.current?.(a),i.current=a)},[a,i]),[a,d,c]}function vt(t){return typeof t=="function"}var be="Radio",[yt,as]=ss(be),[Nt,bt]=yt(be),is=u.forwardRef((t,n)=>{const{__scopeRadio:a,name:d,checked:i=!1,required:c,disabled:g,value:x="on",onCheck:v,form:p,...m}=t,[h,S]=u.useState(null),y=ye(n,F=>S(F)),N=u.useRef(!1),C=h?p||!!h.closest("form"):!0;return e.jsxs(Nt,{scope:a,checked:i,disabled:g,children:[e.jsx(ie.button,{type:"button",role:"radio","aria-checked":i,"data-state":ds(i),"data-disabled":g?"":void 0,disabled:g,value:x,...m,ref:y,onClick:je(t.onClick,F=>{i||v?.(),C&&(N.current=F.isPropagationStopped(),N.current||F.stopPropagation())})}),C&&e.jsx(os,{control:h,bubbles:!N.current,name:d,value:x,checked:i,required:c,disabled:g,form:p,style:{transform:"translateX(-100%)"}})]})});is.displayName=be;var ls="RadioIndicator",cs=u.forwardRef((t,n)=>{const{__scopeRadio:a,forceMount:d,...i}=t,c=bt(ls,a);return e.jsx(Qs,{present:d||c.checked,children:e.jsx(ie.span,{"data-state":ds(c.checked),"data-disabled":c.disabled?"":void 0,...i,ref:n})})});cs.displayName=ls;var _t="RadioBubbleInput",os=u.forwardRef(({__scopeRadio:t,control:n,checked:a,bubbles:d=!0,...i},c)=>{const g=u.useRef(null),x=ye(g,c),v=Hs(a),p=zs(n);return u.useEffect(()=>{const m=g.current;if(!m)return;const h=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(h,"checked").set;if(v!==a&&y){const N=new Event("click",{bubbles:d});y.call(m,a),m.dispatchEvent(N)}},[v,a,d]),e.jsx(ie.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...i,tabIndex:-1,ref:x,style:{...i.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});os.displayName=_t;function ds(t){return t?"checked":"unchecked"}var wt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],le="RadioGroup",[St]=ss(le,[es,as]),us=es(),ms=as(),[Ct,Et]=St(le),ps=u.forwardRef((t,n)=>{const{__scopeRadioGroup:a,name:d,defaultValue:i,value:c,required:g=!1,disabled:x=!1,orientation:v,dir:p,loop:m=!0,onValueChange:h,...S}=t,y=us(a),N=Ks(p),[C,F]=gt({prop:c,defaultProp:i??null,onChange:h,caller:le});return e.jsx(Ct,{scope:a,name:d,required:g,disabled:x,value:C,onValueChange:F,children:e.jsx(Gs,{asChild:!0,...y,orientation:v,dir:N,loop:m,children:e.jsx(ie.div,{role:"radiogroup","aria-required":g,"aria-orientation":v,"data-disabled":x?"":void 0,dir:N,...S,ref:n})})})});ps.displayName=le;var xs="RadioGroupItem",hs=u.forwardRef((t,n)=>{const{__scopeRadioGroup:a,disabled:d,...i}=t,c=Et(xs,a),g=c.disabled||d,x=us(a),v=ms(a),p=u.useRef(null),m=ye(n,p),h=c.value===i.value,S=u.useRef(!1);return u.useEffect(()=>{const y=C=>{wt.includes(C.key)&&(S.current=!0)},N=()=>S.current=!1;return document.addEventListener("keydown",y),document.addEventListener("keyup",N),()=>{document.removeEventListener("keydown",y),document.removeEventListener("keyup",N)}},[]),e.jsx(Us,{asChild:!0,...x,focusable:!g,active:h,children:e.jsx(is,{disabled:g,required:c.required,checked:h,...v,...i,name:c.name,ref:m,onCheck:()=>c.onValueChange(i.value),onKeyDown:je(y=>{y.key==="Enter"&&y.preventDefault()}),onFocus:je(i.onFocus,()=>{S.current&&p.current?.click()})})})});hs.displayName=xs;var kt="RadioGroupIndicator",fs=u.forwardRef((t,n)=>{const{__scopeRadioGroup:a,...d}=t,i=ms(a);return e.jsx(cs,{...i,...d,ref:n})});fs.displayName=kt;var gs=ps,js=hs,Rt=fs;const vs=u.forwardRef(({className:t,...n},a)=>e.jsx(gs,{className:L("grid gap-2",t),...n,ref:a}));vs.displayName=gs.displayName;const ve=u.forwardRef(({className:t,...n},a)=>e.jsx(js,{ref:a,className:L("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(Rt,{className:"flex items-center justify-center",children:e.jsx(Xs,{className:"h-3.5 w-3.5 fill-primary"})})}));ve.displayName=js.displayName;function Dt({exercise:t,exercises:n,exerciseFilter:a,index:d,totalItems:i,onChange:c,onDelete:g,onMoveUp:x,onMoveDown:v}){const[p,m]=u.useState(!1),[h,S]=u.useState(!1),y=n.filter(f=>a==="all"?!0:f.exercise_type===a),N=n.find(f=>f.id===t.exercise_id),C=N?.nom_exercice??"Exercice",F=N?.exercise_type==="warmup",b=N?.illustration_gif;return e.jsxs(e.Fragment,{children:[e.jsxs(Vs,{className:L("rounded-2xl border-border transition-all",p&&"ring-1 ring-primary/20"),children:[e.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 p-3 text-left",onClick:()=>m(!p),children:[e.jsx("span",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-muted text-xs font-bold text-muted-foreground",children:d+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-semibold",children:C}),F&&e.jsx("span",{className:"shrink-0 rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-semibold text-amber-800",children:"Échauf."})]}),e.jsxs("div",{className:"mt-0.5 text-xs text-muted-foreground",children:[t.sets,"×",t.reps,t.percent_1rm?` @ ${t.percent_1rm}% 1RM`:"",t.rest_seconds?` · ${t.rest_seconds}s repos`:""]})]}),b&&e.jsx("button",{type:"button",className:"shrink-0 rounded-lg overflow-hidden border border-border bg-muted",onClick:f=>{f.stopPropagation(),S(!0)},children:e.jsx("img",{src:b,alt:C,className:"h-9 w-9 object-cover"})}),e.jsx(lt,{className:L("h-4 w-4 shrink-0 text-muted-foreground transition-transform",p&&"rotate-180")})]}),p&&e.jsxs("div",{className:"border-t border-border px-3 pb-3 pt-3 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-xs",children:"Séries"}),e.jsx(R,{type:"number",inputMode:"numeric",value:t.sets===0?"":t.sets,onChange:f=>c("sets",f.target.value===""?0:Number(f.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-xs",children:"Reps"}),e.jsx(R,{type:"number",inputMode:"numeric",value:t.reps===0?"":t.reps,onChange:f=>c("reps",f.target.value===""?0:Number(f.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-xs",children:"% 1RM"}),e.jsx(R,{type:"number",inputMode:"numeric",value:t.percent_1rm===0?"":t.percent_1rm,onChange:f=>c("percent_1rm",f.target.value===""?0:Number(f.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-xs",children:"Repos (s)"}),e.jsx(R,{type:"number",inputMode:"numeric",value:t.rest_seconds===0?"":t.rest_seconds,onChange:f=>c("rest_seconds",f.target.value===""?0:Number(f.target.value)),className:"rounded-xl h-10"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-xs",children:"Exercice"}),e.jsxs(Y,{value:t.exercise_id.toString(),onValueChange:f=>c("exercise_id",parseInt(f)),children:[e.jsx(J,{className:"rounded-xl",children:e.jsx(Z,{})}),e.jsx(ee,{children:y.length?y.map(f=>e.jsxs(M,{value:f.id.toString(),children:[f.nom_exercice,f.exercise_type==="warmup"?" · Échauffement":""]},f.id)):e.jsx(M,{value:"no-exercise",disabled:!0,children:"Aucun exercice disponible"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"text-xs",children:"Notes"}),e.jsx(se,{value:t.notes??"",onChange:f=>c("notes",f.target.value||null),placeholder:"Notes optionnelles...",className:"rounded-xl min-h-[60px]"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:f=>{f.stopPropagation(),x()},disabled:d===0,className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted disabled:opacity-30","aria-label":"Monter",children:e.jsx(st,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:f=>{f.stopPropagation(),v()},disabled:d===i-1,className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted disabled:opacity-30","aria-label":"Descendre",children:e.jsx(tt,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"button",onClick:f=>{f.stopPropagation(),g()},className:"inline-flex h-9 items-center gap-2 rounded-full px-3 text-xs font-medium text-destructive hover:bg-destructive/10",children:[e.jsx(ne,{className:"h-3.5 w-3.5"}),"Supprimer"]})]})]})]}),b&&e.jsx(te,{open:h,onOpenChange:S,children:e.jsx(re,{className:"sm:max-w-md p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{src:b,alt:C,className:"w-full max-h-[70vh] object-contain rounded-lg"}),e.jsx("p",{className:"text-sm font-medium text-center",children:C})]})})})]})}const Ft=t=>t==="endurance"||t==="hypertrophie"||t==="force"?t:"endurance";function It({session:t,exercises:n,editingSessionId:a,folders:d,onSessionChange:i,onCycleChange:c,onSave:g,onCancel:x,onAddItem:v,onUpdateItem:p,onRemoveItem:m,onReorderItems:h,onExerciseDialogOpen:S,isSaving:y}){const[N,C]=u.useState("all"),[F,b]=u.useState(!1),[f,G]=u.useState(!1),O=new Map(n.map(o=>[o.id,o])),K=t.items.reduce((o,_)=>o+(_.sets||0),0),T=o=>{o>0&&h(o,o-1)},ce=o=>{o<t.items.length-1&&h(o,o+1)},U=()=>{b(!0)};return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-bottom-4",children:[e.jsx(rt,{isEditing:!!a,isSaving:y,onSave:g,onCancel:x,onPreview:U}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(nt,{name:t.title,onNameChange:o=>i({...t,title:o}),showDuration:!1,showTotalDistance:!1,collapsible:!0,collapsed:f,onToggleCollapse:()=>G(!f),collapsedSummary:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:t.title||"Sans titre"}),e.jsx("span",{children:"·"}),e.jsx("span",{className:"capitalize",children:t.cycle}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[K," séries"]})]}),additionalFields:e.jsxs(e.Fragment,{children:[d&&d.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Dossier"}),e.jsx("div",{className:"mt-1",children:e.jsxs(Y,{value:t.folder_id?.toString()??"none",onValueChange:o=>i({...t,folder_id:o==="none"?null:parseInt(o)}),children:[e.jsx(J,{className:"rounded-2xl",children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(M,{value:"none",children:"Aucun"}),d.map(o=>e.jsx(M,{value:o.id.toString(),children:o.name},o.id))]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Cycle"}),e.jsx("div",{className:"mt-1",children:e.jsxs(Y,{value:t.cycle,onValueChange:o=>c(Ft(o)),children:[e.jsx(J,{className:"rounded-2xl",children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(M,{value:"endurance",children:"Endurance"}),e.jsx(M,{value:"hypertrophie",children:"Hypertrophie"}),e.jsx(M,{value:"force",children:"Force"})]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Séries totales"}),e.jsx("div",{className:"mt-1 rounded-2xl border border-border bg-muted px-3 py-2 text-sm font-semibold",children:K})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Description"}),e.jsx("div",{className:"mt-1",children:e.jsx(se,{value:t.description,onChange:o=>i({...t,description:o.target.value}),placeholder:"Description optionnelle...",className:"rounded-2xl min-h-[60px]"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Exercices (",t.items.length,")"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Y,{value:N,onValueChange:o=>C(o),children:[e.jsxs(J,{className:"h-8 w-auto gap-1 rounded-full border-dashed text-xs",children:[e.jsx(xt,{className:"h-3 w-3"}),e.jsx(Z,{})]}),e.jsxs(ee,{children:[e.jsx(M,{value:"all",children:"Tous"}),e.jsx(M,{value:"strength",children:"Travail"}),e.jsx(M,{value:"warmup",children:"Échauf."})]})]})})]}),e.jsx("div",{className:"space-y-2",children:t.items.map((o,_)=>e.jsx(Dt,{exercise:o,exercises:n,exerciseFilter:N,index:_,totalItems:t.items.length,onChange:(E,P)=>p(_,E,P),onDelete:()=>m(_),onMoveUp:()=>T(_),onMoveDown:()=>ce(_)},`${o.exercise_id}-${_}`))}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",onClick:v,className:"inline-flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(ae,{className:"h-4 w-4"})," Ajouter un exercice"]}),e.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-2 rounded-full border border-border px-4 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(ae,{className:"h-4 w-4"})," Nouvel exercice"]})]})]}),e.jsx(te,{open:F,onOpenChange:b,children:e.jsxs(re,{className:"sm:max-w-3xl",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Aperçu de la séance"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-lg font-semibold",children:t.title||"Sans titre"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description||"—"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Cycle : ",t.cycle]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Exercices"}),e.jsx("div",{className:"space-y-2",children:t.items.slice().sort((o,_)=>(o.order_index??0)-(_.order_index??0)).map((o,_)=>{const E=O.get(o.exercise_id);return e.jsxs("div",{className:"rounded-xl border px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"font-medium",children:[_+1,". ",E?.nom_exercice??"Exercice"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:E?.exercise_type==="warmup"?"Échauffement":"Travail"})]}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[o.sets," séries • ",o.reps," reps • ",o.percent_1rm,"% 1RM •"," ",o.rest_seconds,"s"]})]},`${o.exercise_id}-${_}`)})})]})]})]})})]})}function Xe({name:t,count:n,children:a,onRename:d,onDelete:i,defaultOpen:c=!1}){const[g,x]=u.useState(c),[v,p]=u.useState(!1),[m,h]=u.useState(t),[S,y]=u.useState(!1),N=u.useRef(null);u.useEffect(()=>{v&&(N.current?.focus(),N.current?.select())},[v]);const C=()=>{const b=m.trim();b&&b!==t?d(b):h(t),p(!1)},F=()=>{h(t),p(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:L("flex items-center gap-1 rounded-xl px-2 py-1.5 cursor-pointer select-none hover:bg-muted/50"),onClick:()=>{v||x(b=>!b)},children:[e.jsx(ct,{className:L("h-4 w-4 shrink-0 text-muted-foreground transition-transform",g&&"rotate-90")}),v?e.jsx(R,{ref:N,className:"h-7 text-sm rounded-lg flex-1",value:m,onChange:b=>h(b.target.value),onClick:b=>b.stopPropagation(),onKeyDown:b=>{b.stopPropagation(),b.key==="Enter"&&C(),b.key==="Escape"&&F()},onBlur:C}):e.jsx("span",{className:"text-sm font-semibold truncate",children:t}),!v&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n,")"]}),e.jsx("div",{className:"flex-1"}),e.jsxs(ts,{open:S,onOpenChange:y,children:[e.jsx(rs,{asChild:!0,children:e.jsx("button",{className:"h-7 w-7 shrink-0 inline-flex items-center justify-center rounded-full hover:bg-muted",onClick:b=>{b.stopPropagation()},children:e.jsx(mt,{className:"h-4 w-4 text-muted-foreground"})})}),e.jsxs(ns,{align:"end",className:"w-40 p-1",onClick:b=>b.stopPropagation(),children:[e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",onClick:()=>{y(!1),h(t),p(!0)},children:[e.jsx(at,{className:"h-4 w-4"}),"Rename"]}),e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm text-destructive hover:bg-muted",onClick:()=>{y(!1),i()},children:[e.jsx(ne,{className:"h-4 w-4"}),"Delete"]})]})]})]}),g&&e.jsx("div",{className:"ml-4",children:a})]})}function H({folders:t,currentFolderId:n,onMove:a,children:d}){const[i,c]=u.useState(!1);function g(x){a(x),c(!1)}return e.jsxs(ts,{open:i,onOpenChange:c,children:[e.jsx(rs,{asChild:!0,children:d??e.jsx("button",{className:"flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Déplacer",title:"Déplacer vers un dossier",children:e.jsx(it,{className:"h-4 w-4"})})}),e.jsxs(ns,{className:"w-44 p-1",align:"end",children:[e.jsx("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",style:{fontWeight:n?void 0:"bold"},onClick:()=>g(null),children:"Aucun dossier"}),t.map(x=>e.jsx("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",style:{fontWeight:n===x.id?"bold":void 0},onClick:()=>g(x.id),children:x.name},x.id))]})]})}const Ye=[{key:"endurance",label:"Endurance",fieldSuffix:"endurance"},{key:"hypertrophie",label:"Hypertrophie",fieldSuffix:"hypertrophie"},{key:"force",label:"Force",fieldSuffix:"force"}],Mt=t=>t==="endurance"||t==="hypertrophie"||t==="force"?t:"endurance",Je=({exercise:t,onChange:n,disabled:a=!1})=>e.jsxs(Ys,{defaultValue:"endurance",className:"w-full",children:[e.jsx(Js,{className:"grid w-full grid-cols-3",children:Ye.map(d=>e.jsx(Zs,{value:d.key,children:d.label},d.key))}),Ye.map(d=>{const i=`pct_1rm_${d.fieldSuffix}`,c=`Nb_series_${d.fieldSuffix}`,g=`Nb_reps_${d.fieldSuffix}`,x=`recup_${d.fieldSuffix}`,v=`recup_exercices_${d.fieldSuffix}`;return e.jsxs(et,{value:d.key,className:`space-y-3 rounded-lg border p-3 ${a?"opacity-60":""}`,children:[e.jsx("p",{className:"text-sm font-semibold",children:d.label}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"% 1RM"}),e.jsx(R,{type:"number",value:t[i]??"",disabled:a,onChange:p=>n({[i]:p.target.value===""?null:Number(p.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Nb séries"}),e.jsx(R,{type:"number",value:t[c]??"",disabled:a,onChange:p=>n({[c]:p.target.value===""?null:Number(p.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Nb reps"}),e.jsx(R,{type:"number",value:t[g]??"",disabled:a,onChange:p=>n({[g]:p.target.value===""?null:Number(p.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Récup. séries (s)"}),e.jsx(R,{type:"number",value:t[x]??"",disabled:a,onChange:p=>n({[x]:p.target.value===""?null:Number(p.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Récup. exercices (s)"}),e.jsx(R,{type:"number",value:t[v]??"",disabled:a,onChange:p=>n({[v]:p.target.value===""?null:Number(p.target.value)})})]})]})]},d.key)})]}),Pt={pct_1rm_endurance:60,pct_1rm_hypertrophie:75,pct_1rm_force:85,Nb_series_endurance:4,Nb_series_hypertrophie:3,Nb_series_force:3,Nb_reps_endurance:16,Nb_reps_hypertrophie:8,Nb_reps_force:3,recup_endurance:120,recup_hypertrophie:200,recup_force:300,recup_exercices_endurance:300,recup_exercices_hypertrophie:400,recup_exercices_force:500},X=t=>{const n=Number(t);return Number.isFinite(n)?n:0},he=(t,n,a,d)=>{const i=n==="force"?"force":n==="hypertrophie"?"hypertrophie":"endurance",c=`Nb_series_${i}`,g=`Nb_reps_${i}`,x=`pct_1rm_${i}`,v=`recup_${i}`;return{exercise_id:t.id,order_index:a,sets:X(t[c]),reps:X(t[g]),rest_seconds:X(t[v]),percent_1rm:X(t[x]),cycle_type:n,notes:d?.notes??""}},At=()=>({nom_exercice:"",description:null,illustration_gif:null,exercise_type:"strength",warmup_reps:null,warmup_duration:null,...Pt}),Ze=({exercise:t,warmupMode:n,onChange:a,onWarmupModeChange:d,idPrefix:i})=>e.jsxs("div",{className:"space-y-3 rounded-lg border p-3",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Paramètres d'échauffement"}),e.jsxs(vs,{value:n,onValueChange:c=>{d(c==="duration"?"duration":"reps"),a(c==="duration"?{warmup_reps:null,warmup_duration:t.warmup_duration??0}:{warmup_duration:null,warmup_reps:t.warmup_reps??0})},className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{value:"reps",id:`${i}-warmup-reps`}),e.jsx(w,{htmlFor:`${i}-warmup-reps`,children:"Nombre de répétitions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{value:"duration",id:`${i}-warmup-duration`}),e.jsx(w,{htmlFor:`${i}-warmup-duration`,children:"Durée (secondes)"})]})]}),n==="duration"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Durée (s)"}),e.jsx(R,{type:"number",value:t.warmup_duration??"",onChange:c=>a({warmup_duration:c.target.value===""?null:Number(c.target.value)})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Nombre de répétitions"}),e.jsx(R,{type:"number",value:t.warmup_reps??"",onChange:c=>a({warmup_reps:c.target.value===""?null:Number(c.target.value)})})]})]});function ur(){const{toast:t}=Ws(),n=Bs(),[a,d]=u.useState(!1),[i,c]=u.useState(null),[g,x]=u.useState(!1),[v,p]=u.useState(!1),[m,h]=u.useState(null),[S,y]=u.useState(null),[N,C]=u.useState(null),[F,b]=u.useState("reps"),[f,G]=u.useState("reps"),[O,K]=u.useState(!1),[T,ce]=u.useState(""),U=async(s,r)=>{if(s.size>10485760){t({title:"Fichier trop volumineux",description:"La taille maximale est de 10 Mo.",variant:"destructive"});return}K(!0);try{const j=s.name.split(".").pop()??"gif",k=`exercises/${Date.now()}-${Math.random().toString(36).slice(2)}.${j}`,{error:$}=await Ae.storage.from("exercise-gifs").upload(k,s,{upsert:!1});if($)throw $;const{data:Ts}=Ae.storage.from("exercise-gifs").getPublicUrl(k);r(Ts.publicUrl),t({title:"Image uploadée"})}catch(j){const k=j instanceof Error?j.message:"Réessayez.";t({title:"Erreur d'upload",description:k,variant:"destructive"})}finally{K(!1)}},[o,_]=u.useState({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),[E,P]=u.useState({...At()});u.useEffect(()=>{m&&G(m.warmup_duration!=null?"duration":"reps")},[m]);const{data:A,isLoading:ys,error:oe,refetch:Ns}=W({queryKey:["exercises"],queryFn:()=>D.getExercises()}),{data:Q,isLoading:bs,error:_s,refetch:qt}=W({queryKey:["strength_catalog"],queryFn:()=>D.getStrengthSessions()}),{data:z}=W({queryKey:["strength_folders","session"],queryFn:()=>D.getStrengthFolders("session")}),{data:de}=W({queryKey:["strength_folders","exercise"],queryFn:()=>D.getStrengthFolders("exercise")}),_e=s=>{const r=s.items?.reduce((l,j)=>l+(j.sets||0),0)??0;return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"capitalize",children:s.cycle}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[s.items?.length??0," exos"]}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[r," séries"]})]})},ue=u.useMemo(()=>{if(!Q)return[];if(!T.trim())return Q;const s=T.toLowerCase();return Q.filter(r=>r.title?.toLowerCase().includes(s))},[Q,T]),ws=ue.filter(s=>!s.folder_id),Ss=u.useMemo(()=>{const s=new Map;for(const r of ue)if(r.folder_id){const l=s.get(r.folder_id)??[];l.push(r),s.set(r.folder_id,l)}return s},[ue]),Cs=u.useMemo(()=>(A??[]).filter(s=>!s.folder_id),[A]),Es=u.useMemo(()=>{const s=new Map;for(const r of A??[])if(r.folder_id){const l=s.get(r.folder_id)??[];l.push(r),s.set(r.folder_id,l)}return s},[A]),ks=I({mutationFn:s=>D.createExercise(s),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),x(!1),t({title:"Exercice ajouté"})}}),we=I({mutationFn:s=>D.createStrengthSession(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),d(!1),_({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),t({title:"Séance créée avec succès"})}}),Rs=I({mutationFn:s=>D.updateExercise(s),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),p(!1),h(null),t({title:"Exercice mis à jour"})}}),Ds=I({mutationFn:s=>D.deleteExercise(s),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),C(null),t({title:"Exercice supprimé"})}}),me=I({mutationFn:s=>D.deleteStrengthSession(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),y(null),t({title:"Séance supprimée"})}}),Se=I({mutationFn:s=>D.updateStrengthSession(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),d(!1),c(null),_({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),t({title:"Séance mise à jour"})}}),Fs=I({mutationFn:s=>D.persistStrengthSessionOrder(s)}),Ce=I({mutationFn:({name:s,type:r})=>D.createStrengthFolder(s,r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),t({title:"Dossier créé"})}}),Ee=I({mutationFn:({id:s,name:r})=>D.renameStrengthFolder(s,r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),t({title:"Dossier renommé"})}}),ke=I({mutationFn:s=>D.deleteStrengthFolder(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),n.invalidateQueries({queryKey:["exercises"]}),t({title:"Dossier supprimé"})}}),B=I({mutationFn:({itemId:s,folderId:r,table:l})=>D.moveToFolder(s,r,l),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),n.invalidateQueries({queryKey:["exercises"]}),t({title:"Déplacé"})}}),Is=()=>{d(!1),c(null),_({title:"",description:"",cycle:"endurance",items:[],folder_id:null})},V=s=>{c(s.id),_({title:s.title??"",description:s.description??"",cycle:Mt(s.cycle),items:s.items?.map(r=>({exercise_id:r.exercise_id,order_index:r.order_index??0,sets:r.sets,reps:r.reps,rest_seconds:r.rest_seconds,percent_1rm:r.percent_1rm,cycle_type:r.cycle_type,notes:r.notes??""}))??[],folder_id:s.folder_id??null}),d(!0)},Re=s=>{h(s),p(!0)},Ms=()=>{const s={...o,items:pe(o.items)};i?Se.mutate({...s,id:i}):we.mutate(s)},pe=s=>s.map((r,l)=>({...r,order_index:l})),Ps=()=>{const s=A?.[0];_(r=>({...r,items:[...r.items,s?he(s,r.cycle,r.items.length):{exercise_id:1,order_index:r.items.length,sets:0,reps:0,rest_seconds:0,percent_1rm:0}]}))},As=(s,r,l)=>{const j=[...o.items];if(r==="exercise_id"){const k=A?.find($=>$.id===l);k?j[s]=he(k,o.cycle,j[s].order_index??s,j[s]):j[s]={...j[s],exercise_id:Number(l)}}else j[s]={...j[s],[r]:l};_({...o,items:j})},qs=s=>{const r=pe(o.items.filter((l,j)=>j!==s));_({...o,items:r})},Os=(s,r)=>{if(s===r)return;const l=[...o.items],[j]=l.splice(s,1);l.splice(r,0,j);const k=pe(l);_({...o,items:k}),i&&Fs.mutate({id:i,title:o.title,description:o.description,cycle:o.cycle,items:k})},De=e.jsx(te,{open:v,onOpenChange:p,children:e.jsxs(re,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto pb-safe",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Modifier l'exercice"})}),m&&e.jsxs("div",{className:"space-y-4",children:[m.exercise_type==="warmup"?e.jsx(Ze,{exercise:m,warmupMode:f,onChange:s=>h(r=>r&&{...r,...s}),onWarmupModeChange:G,idPrefix:"edit"}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Nom"}),e.jsx(R,{value:m.nom_exercice,onChange:s=>h({...m,nom_exercice:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Description"}),e.jsx(se,{value:m.description??"",onChange:s=>h({...m,description:s.target.value===""?null:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Illustration (GIF)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:m.illustration_gif??"",onChange:s=>h({...m,illustration_gif:s.target.value===""?null:s.target.value}),placeholder:"https://...",className:"flex-1"}),e.jsx(q,{type:"button",variant:"outline",size:"icon",disabled:O,onClick:()=>{const s=document.createElement("input");s.type="file",s.accept="image/*,.gif",s.onchange=r=>{const l=r.target.files?.[0];l&&U(l,j=>h(k=>k&&{...k,illustration_gif:j}))},s.click()},"aria-label":"Uploader une image",children:O?e.jsx(Ve,{className:"h-4 w-4 animate-spin"}):e.jsx(He,{className:"h-4 w-4"})})]}),m.illustration_gif&&e.jsx("img",{src:m.illustration_gif,alt:"Aperçu",className:"mt-2 h-20 w-20 rounded-lg object-cover border"})]}),m.exercise_type!=="warmup"?e.jsx(Je,{exercise:m,onChange:s=>h(r=>r&&{...r,...s})}):null,e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{id:"warmup-flag-edit",checked:m.exercise_type==="warmup",onCheckedChange:s=>h({...m,exercise_type:s===!0?"warmup":"strength"})}),e.jsx(w,{htmlFor:"warmup-flag-edit",children:"Exercice d'échauffement (warmup)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(q,{variant:"outline",onClick:()=>{p(!1),h(null)},className:"h-10",children:"Annuler"}),e.jsx(q,{variant:"default",onClick:()=>{m?.id&&Rs.mutate(m)},disabled:!m.nom_exercice.trim(),className:"h-10",children:"Enregistrer"})]})]})]})}),Fe=e.jsx(te,{open:g,onOpenChange:x,children:e.jsxs(re,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto pb-safe",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Créer un exercice"})}),e.jsxs("div",{className:"space-y-4",children:[E.exercise_type==="warmup"?e.jsx(Ze,{exercise:E,warmupMode:F,onChange:s=>P(r=>({...r,...s})),onWarmupModeChange:b,idPrefix:"create"}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Nom"}),e.jsx(R,{value:E.nom_exercice,onChange:s=>P({...E,nom_exercice:s.target.value}),placeholder:"ex: Rotations Élastique"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Description"}),e.jsx(se,{value:E.description??"",onChange:s=>P({...E,description:s.target.value===""?null:s.target.value}),placeholder:"Détails, consignes..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Illustration (GIF)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:E.illustration_gif??"",onChange:s=>P({...E,illustration_gif:s.target.value===""?null:s.target.value}),placeholder:"https://...",className:"flex-1"}),e.jsx(q,{type:"button",variant:"outline",size:"icon",disabled:O,onClick:()=>{const s=document.createElement("input");s.type="file",s.accept="image/*,.gif",s.onchange=r=>{const l=r.target.files?.[0];l&&U(l,j=>P(k=>({...k,illustration_gif:j})))},s.click()},"aria-label":"Uploader une image",children:O?e.jsx(Ve,{className:"h-4 w-4 animate-spin"}):e.jsx(He,{className:"h-4 w-4"})})]}),E.illustration_gif&&e.jsx("img",{src:E.illustration_gif,alt:"Aperçu",className:"mt-2 h-20 w-20 rounded-lg object-cover border"})]}),E.exercise_type!=="warmup"?e.jsx(Je,{exercise:E,onChange:s=>P(r=>({...r,...s}))}):null,e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{id:"warmup-flag",checked:E.exercise_type==="warmup",onCheckedChange:s=>P({...E,exercise_type:s===!0?"warmup":"strength"})}),e.jsx(w,{htmlFor:"warmup-flag",children:"Exercice d'échauffement (warmup)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(q,{variant:"outline",onClick:()=>x(!1),className:"h-10",children:"Annuler"}),e.jsx(q,{variant:"default",onClick:()=>ks.mutate(E),disabled:!E.nom_exercice.trim(),className:"h-10",children:"Enregistrer"})]})]})]})}),Ie=e.jsx(Oe,{open:!!S,onOpenChange:s=>{s||y(null)},children:e.jsxs(Te,{children:[e.jsxs($e,{children:[e.jsx(Le,{children:"Supprimer la séance ?"}),e.jsxs(Ke,{children:['Cette action est définitive. La séance "',S?.title,'" sera supprimée.']})]}),e.jsxs(Ge,{children:[e.jsx(Ue,{children:"Annuler"}),e.jsx(Qe,{onClick:()=>{S?.id&&me.mutate(S.id)},children:"Supprimer"})]})]})}),Me=e.jsx(Oe,{open:!!N,onOpenChange:s=>{s||C(null)},children:e.jsxs(Te,{children:[e.jsxs($e,{children:[e.jsx(Le,{children:"Supprimer l'exercice ?"}),e.jsxs(Ke,{children:[`Cette action est définitive. L'exercice "`,N?.nom_exercice,'" sera supprimé.']})]}),e.jsxs(Ge,{children:[e.jsx(Ue,{children:"Annuler"}),e.jsx(Qe,{onClick:()=>{N?.id&&Ds.mutate(N.id)},children:"Supprimer"})]})]})});return a?e.jsxs(e.Fragment,{children:[Fe,De,Ie,Me,e.jsx(It,{session:o,exercises:A??[],editingSessionId:i,folders:z,onSessionChange:_,onCycleChange:s=>{const r=o.items.map((l,j)=>{const k=A?.find($=>$.id===l.exercise_id);return k?he(k,s,j,l):{...l,cycle_type:s}});_({...o,cycle:s,items:r})},onSave:Ms,onCancel:Is,onAddItem:Ps,onUpdateItem:As,onRemoveItem:qs,onReorderItems:Os,onExerciseDialogOpen:()=>x(!0),isSaving:we.isPending||Se.isPending})]}):ys?e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(xe,{className:"h-7 w-64"}),e.jsx(xe,{className:"h-10 w-full rounded-2xl"}),e.jsx("div",{className:"space-y-3",children:Array.from({length:4}).map((s,r)=>e.jsx(xe,{className:"h-20 w-full rounded-2xl"},r))})]}):oe?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(ot,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-semibold",children:"Impossible de charger les données"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:oe instanceof Error?oe.message:"Une erreur s'est produite"}),e.jsx(q,{variant:"default",onClick:()=>Ns(),className:"mt-4 h-12 md:h-10",children:"Réessayer"})]}):e.jsxs("div",{children:[Fe,De,Ie,Me,e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold",children:"Musculation"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Catalogue"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{const s=prompt("Nom du dossier");s?.trim()&&Ce.mutate({name:s.trim(),type:"session"})},className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(ze,{className:"h-4 w-4"})," Dossier"]}),e.jsxs("button",{type:"button",onClick:()=>{c(null),_({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),d(!0)},className:"inline-flex items-center gap-2 rounded-full bg-primary px-3 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(ae,{className:"h-4 w-4"})," Nouvelle"]})]})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-border bg-card px-3 py-2",children:[e.jsx(dt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{className:"w-full bg-transparent text-sm outline-none placeholder:text-muted-foreground",placeholder:"Rechercher une séance",value:T,onChange:s=>ce(s.target.value)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Be,{sessions:ws,isLoading:bs,error:_s,renderTitle:s=>s.title??"Sans titre",renderMetrics:_e,renderExtraActions:s=>e.jsx(H,{folders:z??[],currentFolderId:s.folder_id,onMove:r=>B.mutate({itemId:s.id,folderId:r,table:"strength_sessions"})}),onPreview:s=>V(s),onEdit:s=>V(s),onDelete:s=>y(s),canDelete:()=>!0,isDeleting:me.isPending}),z?.map(s=>{const r=Ss.get(s.id)??[];return e.jsx(Xe,{name:s.name,count:r.length,onRename:l=>Ee.mutate({id:s.id,name:l}),onDelete:()=>ke.mutate(s.id),children:r.length>0?e.jsx(Be,{sessions:r,renderTitle:l=>l.title??"Sans titre",renderMetrics:_e,renderExtraActions:l=>e.jsx(H,{folders:z??[],currentFolderId:l.folder_id,onMove:j=>B.mutate({itemId:l.id,folderId:j,table:"strength_sessions"})}),onPreview:l=>V(l),onEdit:l=>V(l),onDelete:l=>y(l),canDelete:()=>!0,isDeleting:me.isPending}):e.jsx("div",{className:"rounded-xl border border-dashed border-border px-3 py-4 text-center text-xs text-muted-foreground",children:"Dossier vide"})},s.id)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Exercices (",A?.length??0,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{const s=prompt("Nom du dossier");s?.trim()&&Ce.mutate({name:s.trim(),type:"exercise"})},className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(ze,{className:"h-4 w-4"})," Dossier"]}),e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(ae,{className:"h-4 w-4"})," Ajouter"]})]})]}),e.jsx("div",{className:"space-y-1",children:Cs.map(s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl px-3 py-2 hover:bg-muted/50",children:[s.illustration_gif?e.jsx("img",{src:s.illustration_gif,alt:s.nom_exercice,className:"h-10 w-10 shrink-0 rounded-lg object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:s.nom_exercice}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.exercise_type==="warmup"?"Échauffement":"Séries de travail"})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx(H,{folders:de??[],currentFolderId:s.folder_id,onMove:r=>B.mutate({itemId:s.id,folderId:r,table:"dim_exercices"})}),e.jsx("button",{type:"button",onClick:()=>Re(s),className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Modifier",children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>C(s),className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-destructive hover:bg-destructive/10","aria-label":"Supprimer",children:e.jsx(ne,{className:"h-4 w-4"})})]})]},s.id))}),de?.map(s=>{const r=Es.get(s.id)??[];return e.jsx(Xe,{name:s.name,count:r.length,onRename:l=>Ee.mutate({id:s.id,name:l}),onDelete:()=>ke.mutate(s.id),children:r.length>0?e.jsx("div",{className:"space-y-1",children:r.map(l=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl px-3 py-2 hover:bg-muted/50",children:[l.illustration_gif?e.jsx("img",{src:l.illustration_gif,alt:l.nom_exercice,className:"h-10 w-10 shrink-0 rounded-lg object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:l.nom_exercice}),e.jsx("div",{className:"text-xs text-muted-foreground",children:l.exercise_type==="warmup"?"Échauffement":"Séries de travail"})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx(H,{folders:de??[],currentFolderId:l.folder_id,onMove:j=>B.mutate({itemId:l.id,folderId:j,table:"dim_exercices"})}),e.jsx("button",{type:"button",onClick:()=>Re(l),className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Modifier",children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>C(l),className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-destructive hover:bg-destructive/10","aria-label":"Supprimer",children:e.jsx(ne,{className:"h-4 w-4"})})]})]},l.id))}):e.jsx("div",{className:"rounded-xl border border-dashed border-border px-3 py-4 text-center text-xs text-muted-foreground",children:"Dossier vide"})},s.id)})]})]})]})}export{he as createStrengthItemFromExercise,ur as default};
