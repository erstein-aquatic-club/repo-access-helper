import{R as g,c as ke,r as G,u as on,a as Qe,j as a,S as mt,b as ht,d as yt,e as vt,f as de,C as R,g as I,h as M,i as K,B as sn,k as Le}from"./index-DqxBy9a5.js";import{u as ln}from"./useInfiniteQuery-B1WUv0KS.js";import{T as cn,a as un,b as Ue,c as fe,d as dn,e as se}from"./table-CD3Q3imF.js";import{T as fn,a as pn,b as gt,c as xt}from"./tabs-DWvja1RP.js";import{s as Ie}from"./score-CwBbkHfb.js";import{B as _t}from"./badge-CiNZkEw9.js";import{t as Dt,c as mn,s as hn,f as Ae}from"./format-B9mPVj_w.js";import{i as Ce,D as Et,f as ot,E as kt,L as q,a as H,C as Ne,A as st,b as B,c as Me,d as Q,h as Ct,e as lt,g as ae,u as ct,G as ut,j as ye,m as Re,k as me,l as yn,S as bt,n as vn,o as gn,p as xn,q as $t,r as Tt,X as le,Y as Ke,s as Lt,B as he,R as Pe,t as Je,v as Se,T as we}from"./BarChart-oxDZ1w59.js";var bn=["type","layout","connectNulls","ref"],jn=["key"];function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(e)}function jt(e,t){if(e==null)return{};var r=An(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function An(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _e(){return _e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_e.apply(this,arguments)}function At(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?At(Object(r),!0).forEach(function(n){Z(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):At(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pe(e){return On(e)||wn(e)||Sn(e)||Pn()}function Pn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sn(e,t){if(e){if(typeof e=="string")return tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tt(e,t)}}function wn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function On(e){if(Array.isArray(e))return tt(e)}function tt(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,It(n.key),n)}}function _n(e,t,r){return t&&Pt(e.prototype,t),r&&Pt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dn(e,t,r){return t=Be(t),En(e,Rt()?Reflect.construct(t,r||[],Be(e).constructor):t.apply(e,r))}function En(e,t){if(t&&(ve(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kn(e)}function kn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Rt=function(){return!!e})()}function Be(e){return Be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Be(e)}function Cn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nt(e,t)}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nt(e,t)}function Z(e,t,r){return t=It(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function It(e){var t=$n(e,"string");return ve(t)=="symbol"?t:t+""}function $n(e,t){if(ve(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ve(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ie=(function(e){function t(){var r;Nn(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=Dn(this,t,[].concat(i)),Z(r,"state",{isAnimationFinished:!0,totalLength:0}),Z(r,"generateSimpleStrokeDasharray",function(s,c){return"".concat(c,"px ").concat(s-c,"px")}),Z(r,"getStrokeDasharray",function(s,c,u){var d=u.reduce(function(b,P){return b+P});if(!d)return r.generateSimpleStrokeDasharray(c,s);for(var p=Math.floor(s/d),f=s%d,m=c-s,h=[],y=0,v=0;y<u.length;v+=u[y],++y)if(v+u[y]>f){h=[].concat(pe(u.slice(0,y)),[f-v]);break}var x=h.length%2===0?[0,m]:[m];return[].concat(pe(t.repeat(u,p)),pe(h),x).map(function(b){return"".concat(b,"px")}).join(", ")}),Z(r,"id",ct("recharts-line-")),Z(r,"pathRef",function(s){r.mainCurve=s}),Z(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Z(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Cn(t,e),_n(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.points,c=o.xAxis,u=o.yAxis,d=o.layout,p=o.children,f=ot(p,kt);if(!f)return null;var m=function(v,x){return{x:v.x,y:v.y,value:v.value,errorVal:ae(v.payload,x)}},h={clipPath:n?"url(#clipPath-".concat(i,")"):null};return g.createElement(q,h,f.map(function(y){return g.cloneElement(y,{key:"bar-".concat(y.props.dataKey),data:s,xAxis:c,yAxis:u,layout:d,dataPointFormatter:m})}))}},{key:"renderDots",value:function(n,i,o){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var c=this.props,u=c.dot,d=c.points,p=c.dataKey,f=H(this.props,!1),m=H(u,!0),h=d.map(function(v,x){var b=W(W(W({key:"dot-".concat(x),r:3},f),m),{},{index:x,cx:v.x,cy:v.y,value:v.value,dataKey:p,payload:v.payload,points:d});return t.renderDotItem(u,b)}),y={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return g.createElement(q,_e({className:"recharts-line-dots",key:"dots"},y),h)}},{key:"renderCurveStatically",value:function(n,i,o,s){var c=this.props,u=c.type,d=c.layout,p=c.connectNulls;c.ref;var f=jt(c,bn),m=W(W(W({},H(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:n},s),{},{type:u,layout:d,connectNulls:p});return g.createElement(Ne,_e({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var o=this,s=this.props,c=s.points,u=s.strokeDasharray,d=s.isAnimationActive,p=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,y=s.animateNewValues,v=s.width,x=s.height,b=this.state,P=b.prevPoints,A=b.totalLength;return g.createElement(st,{begin:p,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var j=S.t;if(P){var _=P.length/c.length,N=c.map(function(D,F){var X=Math.floor(F*_);if(P[X]){var U=P[X],T=B(U.x,D.x),qe=B(U.y,D.y);return W(W({},D),{},{x:T(j),y:qe(j)})}if(y){var $e=B(v*2,D.x),oe=B(x/2,D.y);return W(W({},D),{},{x:$e(j),y:oe(j)})}return W(W({},D),{},{x:D.x,y:D.y})});return o.renderCurveStatically(N,n,i)}var E=B(0,A),k=E(j),C;if(u){var $="".concat(u).split(/[,\s]+/gim).map(function(D){return parseFloat(D)});C=o.getStrokeDasharray(k,A,$)}else C=o.generateSimpleStrokeDasharray(A,k);return o.renderCurveStatically(c,n,i,{strokeDasharray:C})})}},{key:"renderCurve",value:function(n,i){var o=this.props,s=o.points,c=o.isAnimationActive,u=this.state,d=u.prevPoints,p=u.totalLength;return c&&s&&s.length&&(!d&&p>0||!Me(d,s))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(s,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,s=i.dot,c=i.points,u=i.className,d=i.xAxis,p=i.yAxis,f=i.top,m=i.left,h=i.width,y=i.height,v=i.isAnimationActive,x=i.id;if(o||!c||!c.length)return null;var b=this.state.isAnimationFinished,P=c.length===1,A=ke("recharts-line",u),S=d&&d.allowDataOverflow,j=p&&p.allowDataOverflow,_=S||j,N=Q(x)?this.id:x,E=(n=H(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=E.r,C=k===void 0?3:k,$=E.strokeWidth,D=$===void 0?2:$,F=Ct(s)?s:{},X=F.clipDot,U=X===void 0?!0:X,T=C*2+D;return g.createElement(q,{className:A},S||j?g.createElement("defs",null,g.createElement("clipPath",{id:"clipPath-".concat(N)},g.createElement("rect",{x:S?m:m-h/2,y:j?f:f-y/2,width:S?h:h*2,height:j?y:y*2})),!U&&g.createElement("clipPath",{id:"clipPath-dots-".concat(N)},g.createElement("rect",{x:m-T/2,y:f-T/2,width:h+T,height:y+T}))):null,!P&&this.renderCurve(_,N),this.renderErrorBar(_,N),(P||s)&&this.renderDots(_,U,N),(!v||b)&&lt.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var o=n.length%2!==0?[].concat(pe(n),[0]):n,s=[],c=0;c<i;++c)s=[].concat(pe(s),pe(o));return s}},{key:"renderDotItem",value:function(n,i){var o;if(g.isValidElement(n))o=g.cloneElement(n,i);else if(Ce(n))o=n(i);else{var s=i.key,c=jt(i,jn),u=ke("recharts-line-dot",typeof n!="boolean"?n.className:"");o=g.createElement(Et,_e({key:s},c,{className:u}))}return o}}])})(G.PureComponent);Z(ie,"displayName","Line");Z(ie,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ut.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Z(ie,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,s=e.dataKey,c=e.bandSize,u=e.displayedData,d=e.offset,p=t.layout,f=u.map(function(m,h){var y=ae(m,s);return p==="horizontal"?{x:ye({axis:r,ticks:i,bandSize:c,entry:m,index:h}),y:Q(y)?null:n.scale(y),value:y,payload:m}:{x:Q(y)?null:r.scale(y),y:ye({axis:n,ticks:o,bandSize:c,entry:m,index:h}),value:y,payload:m}});return W({points:f,layout:p},d)});var Tn=["layout","type","stroke","connectNulls","isRange","ref"],Ln=["key"],Mt;function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function Kt(e,t){if(e==null)return{};var r=Rn(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rn(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ce.apply(this,arguments)}function St(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?St(Object(r),!0).forEach(function(n){ee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function In(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ft(n.key),n)}}function Mn(e,t,r){return t&&wt(e.prototype,t),r&&wt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kn(e,t,r){return t=Fe(t),Bn(e,Bt()?Reflect.construct(t,r||[],Fe(e).constructor):t.apply(e,r))}function Bn(e,t){if(t&&(ge(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fn(e)}function Fn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bt=function(){return!!e})()}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fe(e)}function zn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rt(e,t)}function ee(e,t,r){return t=Ft(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ft(e){var t=Vn(e,"string");return ge(t)=="symbol"?t:t+""}function Vn(e,t){if(ge(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ge(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ue=(function(e){function t(){var r;In(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=Kn(this,t,[].concat(i)),ee(r,"state",{isAnimationFinished:!0}),ee(r,"id",ct("recharts-area-")),ee(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Ce(s)&&s()}),ee(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Ce(s)&&s()}),r}return zn(t,e),Mn(t,[{key:"renderDots",value:function(n,i,o){var s=this.props.isAnimationActive,c=this.state.isAnimationFinished;if(s&&!c)return null;var u=this.props,d=u.dot,p=u.points,f=u.dataKey,m=H(this.props,!1),h=H(d,!0),y=p.map(function(x,b){var P=ne(ne(ne({key:"dot-".concat(b),r:3},m),h),{},{index:b,cx:x.x,cy:x.y,dataKey:f,value:x.value,payload:x.payload,points:p});return t.renderDotItem(d,P)}),v={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return g.createElement(q,ce({className:"recharts-area-dots"},v),y)}},{key:"renderHorizontalRect",value:function(n){var i=this.props,o=i.baseLine,s=i.points,c=i.strokeWidth,u=s[0].x,d=s[s.length-1].x,p=n*Math.abs(u-d),f=Re(s.map(function(m){return m.y||0}));return me(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Re(o.map(function(m){return m.y||0})),f)),me(f)?g.createElement("rect",{x:u<d?u:u-p,y:0,width:p,height:Math.floor(f+(c?parseInt("".concat(c),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var i=this.props,o=i.baseLine,s=i.points,c=i.strokeWidth,u=s[0].y,d=s[s.length-1].y,p=n*Math.abs(u-d),f=Re(s.map(function(m){return m.x||0}));return me(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Re(o.map(function(m){return m.x||0})),f)),me(f)?g.createElement("rect",{x:0,y:u<d?u:u-p,width:f+(c?parseInt("".concat(c),10):1),height:Math.floor(p)}):null}},{key:"renderClipRect",value:function(n){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,i,o,s){var c=this.props,u=c.layout,d=c.type,p=c.stroke,f=c.connectNulls,m=c.isRange;c.ref;var h=Kt(c,Tn);return g.createElement(q,{clipPath:o?"url(#clipPath-".concat(s,")"):null},g.createElement(Ne,ce({},H(h,!0),{points:n,connectNulls:f,type:d,baseLine:i,layout:u,stroke:"none",className:"recharts-area-area"})),p!=="none"&&g.createElement(Ne,ce({},H(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:f,fill:"none",points:n})),p!=="none"&&m&&g.createElement(Ne,ce({},H(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:f,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(n,i){var o=this,s=this.props,c=s.points,u=s.baseLine,d=s.isAnimationActive,p=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,y=this.state,v=y.prevPoints,x=y.prevBaseLine;return g.createElement(st,{begin:p,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"area-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var P=b.t;if(v){var A=v.length/c.length,S=c.map(function(E,k){var C=Math.floor(k*A);if(v[C]){var $=v[C],D=B($.x,E.x),F=B($.y,E.y);return ne(ne({},E),{},{x:D(P),y:F(P)})}return E}),j;if(me(u)&&typeof u=="number"){var _=B(x,u);j=_(P)}else if(Q(u)||yn(u)){var N=B(x,0);j=N(P)}else j=u.map(function(E,k){var C=Math.floor(k*A);if(x[C]){var $=x[C],D=B($.x,E.x),F=B($.y,E.y);return ne(ne({},E),{},{x:D(P),y:F(P)})}return E});return o.renderAreaStatically(S,j,n,i)}return g.createElement(q,null,g.createElement("defs",null,g.createElement("clipPath",{id:"animationClipPath-".concat(i)},o.renderClipRect(P))),g.createElement(q,{clipPath:"url(#animationClipPath-".concat(i,")")},o.renderAreaStatically(c,u,n,i)))})}},{key:"renderArea",value:function(n,i){var o=this.props,s=o.points,c=o.baseLine,u=o.isAnimationActive,d=this.state,p=d.prevPoints,f=d.prevBaseLine,m=d.totalLength;return u&&s&&s.length&&(!p&&m>0||!Me(p,s)||!Me(f,c))?this.renderAreaWithAnimation(n,i):this.renderAreaStatically(s,c,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,s=i.dot,c=i.points,u=i.className,d=i.top,p=i.left,f=i.xAxis,m=i.yAxis,h=i.width,y=i.height,v=i.isAnimationActive,x=i.id;if(o||!c||!c.length)return null;var b=this.state.isAnimationFinished,P=c.length===1,A=ke("recharts-area",u),S=f&&f.allowDataOverflow,j=m&&m.allowDataOverflow,_=S||j,N=Q(x)?this.id:x,E=(n=H(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=E.r,C=k===void 0?3:k,$=E.strokeWidth,D=$===void 0?2:$,F=Ct(s)?s:{},X=F.clipDot,U=X===void 0?!0:X,T=C*2+D;return g.createElement(q,{className:A},S||j?g.createElement("defs",null,g.createElement("clipPath",{id:"clipPath-".concat(N)},g.createElement("rect",{x:S?p:p-h/2,y:j?d:d-y/2,width:S?h:h*2,height:j?y:y*2})),!U&&g.createElement("clipPath",{id:"clipPath-dots-".concat(N)},g.createElement("rect",{x:p-T/2,y:d-T/2,width:h+T,height:y+T}))):null,P?null:this.renderArea(_,N),(s||P)&&this.renderDots(_,U,N),(!v||b)&&lt.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:n.points!==i.curPoints||n.baseLine!==i.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])})(G.PureComponent);Mt=ue;ee(ue,"displayName","Area");ee(ue,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!ut.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ee(ue,"getBaseValue",function(e,t,r,n){var i=e.layout,o=e.baseValue,s=t.props.baseValue,c=s??o;if(me(c)&&typeof c=="number")return c;var u=i==="horizontal"?n:r,d=u.scale.domain();if(u.type==="number"){var p=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return c==="dataMin"?f:c==="dataMax"||p<0?p:Math.max(Math.min(d[0],d[1]),0)}return c==="dataMin"?d[0]:c==="dataMax"?d[1]:d[0]});ee(ue,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,i=e.yAxis,o=e.xAxisTicks,s=e.yAxisTicks,c=e.bandSize,u=e.dataKey,d=e.stackedData,p=e.dataStartIndex,f=e.displayedData,m=e.offset,h=t.layout,y=d&&d.length,v=Mt.getBaseValue(t,r,n,i),x=h==="horizontal",b=!1,P=f.map(function(S,j){var _;y?_=d[p+j]:(_=ae(S,u),Array.isArray(_)?b=!0:_=[v,_]);var N=_[1]==null||y&&ae(S,u)==null;return x?{x:ye({axis:n,ticks:o,bandSize:c,entry:S,index:j}),y:N?null:i.scale(_[1]),value:_,payload:S}:{x:N?null:n.scale(_[1]),y:ye({axis:i,ticks:s,bandSize:c,entry:S,index:j}),value:_,payload:S}}),A;return y||b?A=P.map(function(S){var j=Array.isArray(S.value)?S.value[0]:null;return x?{x:S.x,y:j!=null&&S.y!=null?i.scale(j):null}:{x:j!=null?n.scale(j):null,y:S.y}}):A=x?i.scale(v):n.scale(v),ne({points:P,baseLine:A,layout:h,isRange:b},m)});ee(ue,"renderDotItem",function(e,t){var r;if(g.isValidElement(e))r=g.cloneElement(e,t);else if(Ce(e))r=e(t);else{var n=ke("recharts-area-dot",typeof e!="boolean"?e.className:""),i=t.key,o=Kt(t,Ln);r=g.createElement(Et,ce({},o,{key:i,className:n}))}return r});function xe(e){"@babel/helpers - typeof";return xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(e)}function Wn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wt(n.key),n)}}function qn(e,t,r){return t&&Hn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xn(e,t,r){return t=ze(t),Yn(e,zt()?Reflect.construct(t,r||[],ze(e).constructor):t.apply(e,r))}function Yn(e,t){if(t&&(xe(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gn(e)}function Gn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zt=function(){return!!e})()}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ze(e)}function Zn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&at(e,t)}function at(e,t){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},at(e,t)}function Vt(e,t,r){return t=Wt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wt(e){var t=Qn(e,"string");return xe(t)=="symbol"?t:t+""}function Qn(e,t){if(xe(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xe(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var We=(function(e){function t(){return Wn(this,t),Xn(this,t,arguments)}return Zn(t,e),qn(t,[{key:"render",value:function(){return null}}])})(G.Component);Vt(We,"displayName","ZAxis");Vt(We,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var Un=["option","isActive"];function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},De.apply(this,arguments)}function Jn(e,t){if(e==null)return{};var r=er(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function er(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function tr(e){var t=e.option,r=e.isActive,n=Jn(e,Un);return typeof t=="string"?G.createElement(bt,De({option:G.createElement(vn,De({type:t},n)),isActive:r,shapeType:"symbols"},n)):G.createElement(bt,De({option:t,isActive:r,shapeType:"symbols"},n))}function be(e){"@babel/helpers - typeof";return be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(e)}function Ee(){return Ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ee.apply(this,arguments)}function Ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ot(Object(r),!0).forEach(function(n){re(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qt(n.key),n)}}function rr(e,t,r){return t&&Nt(e.prototype,t),r&&Nt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ar(e,t,r){return t=Ve(t),ir(e,Ht()?Reflect.construct(t,r||[],Ve(e).constructor):t.apply(e,r))}function ir(e,t){if(t&&(be(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return or(e)}function or(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ht(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ht=function(){return!!e})()}function Ve(e){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ve(e)}function sr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&it(e,t)}function it(e,t){return it=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},it(e,t)}function re(e,t,r){return t=qt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qt(e){var t=lr(e,"string");return be(t)=="symbol"?t:t+""}function lr(e,t){if(be(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(be(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var He=(function(e){function t(){var r;nr(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=ar(this,t,[].concat(i)),re(r,"state",{isAnimationFinished:!1}),re(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),re(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),re(r,"id",ct("recharts-scatter-")),r}return sr(t,e),rr(t,[{key:"renderSymbolsStatically",value:function(n){var i=this,o=this.props,s=o.shape,c=o.activeShape,u=o.activeIndex,d=H(this.props,!1);return n.map(function(p,f){var m=u===f,h=m?c:s,y=Y(Y({},d),p);return g.createElement(q,Ee({className:"recharts-scatter-symbol",key:"symbol-".concat(p?.cx,"-").concat(p?.cy,"-").concat(p?.size,"-").concat(f)},gn(i.props,p,f),{role:"img"}),g.createElement(tr,Ee({option:h,isActive:m,key:"symbol-".concat(f)},y)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,i=this.props,o=i.points,s=i.isAnimationActive,c=i.animationBegin,u=i.animationDuration,d=i.animationEasing,p=i.animationId,f=this.state.prevPoints;return g.createElement(st,{begin:c,duration:u,isActive:s,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var h=m.t,y=o.map(function(v,x){var b=f&&f[x];if(b){var P=B(b.cx,v.cx),A=B(b.cy,v.cy),S=B(b.size,v.size);return Y(Y({},v),{},{cx:P(h),cy:A(h),size:S(h)})}var j=B(0,v.size);return Y(Y({},v),{},{size:j(h)})});return g.createElement(q,null,n.renderSymbolsStatically(y))})}},{key:"renderSymbols",value:function(){var n=this.props,i=n.points,o=n.isAnimationActive,s=this.state.prevPoints;return o&&i&&i.length&&(!s||!Me(s,i))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(i)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,s=i.xAxis,c=i.yAxis,u=i.children,d=ot(u,kt);return d?d.map(function(p,f){var m=p.props,h=m.direction,y=m.dataKey;return g.cloneElement(p,{key:"".concat(h,"-").concat(y,"-").concat(o[f]),data:o,xAxis:s,yAxis:c,layout:h==="x"?"vertical":"horizontal",dataPointFormatter:function(x,b){return{x:x.cx,y:x.cy,value:h==="x"?+x.node.x:+x.node.y,errorVal:ae(x,b)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,i=n.points,o=n.line,s=n.lineType,c=n.lineJointType,u=H(this.props,!1),d=H(o,!1),p,f;if(s==="joint")p=i.map(function(A){return{x:A.cx,y:A.cy}});else if(s==="fitting"){var m=xn(i),h=m.xmin,y=m.xmax,v=m.a,x=m.b,b=function(S){return v*S+x};p=[{x:h,y:b(h)},{x:y,y:b(y)}]}var P=Y(Y(Y({},u),{},{fill:"none",stroke:u&&u.fill},d),{},{points:p});return g.isValidElement(o)?f=g.cloneElement(o,P):Ce(o)?f=o(P):f=g.createElement(Ne,Ee({},P,{type:c})),g.createElement(q,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}},{key:"render",value:function(){var n=this.props,i=n.hide,o=n.points,s=n.line,c=n.className,u=n.xAxis,d=n.yAxis,p=n.left,f=n.top,m=n.width,h=n.height,y=n.id,v=n.isAnimationActive;if(i||!o||!o.length)return null;var x=this.state.isAnimationFinished,b=ke("recharts-scatter",c),P=u&&u.allowDataOverflow,A=d&&d.allowDataOverflow,S=P||A,j=Q(y)?this.id:y;return g.createElement(q,{className:b,clipPath:S?"url(#clipPath-".concat(j,")"):null},P||A?g.createElement("defs",null,g.createElement("clipPath",{id:"clipPath-".concat(j)},g.createElement("rect",{x:P?p:p-m/2,y:A?f:f-h/2,width:P?m:m*2,height:A?h:h*2}))):null,s&&this.renderLine(),this.renderErrorBar(),g.createElement(q,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!v||x)&&lt.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}}])})(G.PureComponent);re(He,"displayName","Scatter");re(He,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!ut.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});re(He,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,i=e.item,o=e.displayedData,s=e.xAxisTicks,c=e.yAxisTicks,u=e.offset,d=i.props.tooltipType,p=ot(i.props.children,$t),f=Q(t.dataKey)?i.props.dataKey:t.dataKey,m=Q(r.dataKey)?i.props.dataKey:r.dataKey,h=n&&n.dataKey,y=n?n.range:We.defaultProps.range,v=y&&y[0],x=t.scale.bandwidth?t.scale.bandwidth():0,b=r.scale.bandwidth?r.scale.bandwidth():0,P=o.map(function(A,S){var j=ae(A,f),_=ae(A,m),N=!Q(h)&&ae(A,h)||"-",E=[{name:Q(t.dataKey)?i.props.name:t.name||t.dataKey,unit:t.unit||"",value:j,payload:A,dataKey:f,type:d},{name:Q(r.dataKey)?i.props.name:r.name||r.dataKey,unit:r.unit||"",value:_,payload:A,dataKey:m,type:d}];N!=="-"&&E.push({name:n.name||n.dataKey,unit:n.unit||"",value:N,payload:A,dataKey:h,type:d});var k=ye({axis:t,ticks:s,bandSize:x,entry:A,index:S,dataKey:f}),C=ye({axis:r,ticks:c,bandSize:b,entry:A,index:S,dataKey:m}),$=N!=="-"?n.scale(N):v,D=Math.sqrt(Math.max($,0)/Math.PI);return Y(Y({},A),{},{cx:k,cy:C,x:k-D,y:C-D,xAxis:t,yAxis:r,zAxis:n,width:2*D,height:2*D,size:$,node:{x:j,y:_,z:N},tooltipPayload:E,tooltipPosition:{x:k,y:C},payload:A},p&&p[S]&&p[S].props)});return Y({points:P},u)});var cr=Tt({chartName:"LineChart",GraphicalChild:ie,axisComponents:[{axisType:"xAxis",AxisComp:le},{axisType:"yAxis",AxisComp:Ke}],formatAxisMap:Lt}),ur=Tt({chartName:"ComposedChart",GraphicalChild:[ie,ue,he,He],axisComponents:[{axisType:"xAxis",AxisComp:le},{axisType:"yAxis",AxisComp:Ke},{axisType:"zAxis",AxisComp:We}],formatAxisMap:Lt});function dr(e,t){const r=Dt(e);return isNaN(t)?mn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function fr(e){const t=Dt(e);return t.setHours(23,59,59,999),t}function et(e,t){return dr(e,-t)}const Xt="rounded-full px-3 py-1 text-sm font-mono font-bold",Yt=e=>{const t=e.match(/hsl\((\d+(?:\.\d+)?)\s+(\d+(?:\.\d+)?)%\s+(\d+(?:\.\d+)?)%\)/);if(!t)return"#000";const[,r,n,i]=t,o=Number(r),s=Number(n)/100,c=Number(i)/100,u=(1-Math.abs(2*c-1))*s,d=u*(1-Math.abs(o/60%2-1)),p=c-u/2;let f=0,m=0,h=0;o>=0&&o<60?(f=u,m=d):o>=60&&o<120?(f=d,m=u):o>=120&&o<180?(m=u,h=d):o>=180&&o<240?(m=d,h=u):o>=240&&o<300?(f=d,h=u):(f=u,h=d);const y=Math.round((f+p)*255),v=Math.round((m+p)*255),x=Math.round((h+p)*255);return .2126*y+.7152*v+.0722*x>155?"#000":"#fff"};function pr({avgRpe:e,avgPerformance:t,avgEngagement:r,avgFatigue:n}){const i=[{key:"rpe",title:"Difficulté Moy",value:e,invert:!0},{key:"performance",title:"Performance Moy",value:t,invert:!1},{key:"engagement",title:"Engagement Moy",value:r,invert:!1},{key:"fatigue",title:"Fatigue Moy",value:n,invert:!0}];return a.jsx("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:i.map(o=>{const s=Ie(o.value??null,{invert:o.invert})??"hsl(var(--muted-foreground))";return a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsx(M,{className:"text-xs uppercase text-muted-foreground",children:o.title})}),a.jsx(K,{className:"p-4 pt-0",children:a.jsx(_t,{className:Xt,style:{backgroundColor:s,color:Yt(s)},children:o.value?o.value.toFixed(1):"-"})})]},o.key)})})}function Oe(){return a.jsxs("div",{className:"space-y-4 animate-pulse motion-reduce:animate-none",children:[a.jsx("div",{className:"h-6 w-48 rounded-lg bg-muted"}),a.jsx("div",{className:"h-[200px] w-full rounded-xl bg-muted"}),a.jsx("div",{className:"flex gap-2",children:[1,2,3].map(e=>a.jsx("div",{className:"h-4 w-16 rounded bg-muted"},e))})]})}function Ar(){const{user:e,userId:t,role:r,selectedAthleteId:n,selectedAthleteName:i}=on(),o=(r==="coach"||r==="admin")&&(n!==null||!!i),s=o?i:e,c=o?n:t,u=c??s,[d,p]=G.useState("all"),[f,m]=G.useState(""),[h,y]=G.useState(""),[v,x]=G.useState(30),[b,P]=G.useState(30),{data:A,isLoading:S}=Qe({queryKey:["sessions",u],queryFn:()=>Le.getSessions(s,c),enabled:!!s}),j=ln({queryKey:["strength_history",u,"progress",d,f,h],queryFn:({pageParam:l=0})=>Le.getStrengthHistory(s,{athleteId:c,limit:10,offset:l,order:"desc",status:d==="all"?void 0:d,from:f||void 0,to:h||void 0}),enabled:!!s,getNextPageParam:l=>{const w=l.pagination.offset+l.pagination.limit;return w<l.pagination.total?w:void 0},initialPageParam:0}),_=j.data?.pages.flatMap(l=>l.runs)??[],N=hn(et(new Date,b)).toISOString(),E=fr(new Date).toISOString(),{data:k,isLoading:C}=Qe({queryKey:["strength_history_summary",u,"progress",b,N,E],queryFn:()=>Le.getStrengthHistory(s,{athleteId:c,limit:200,order:"desc",from:N,to:E}),enabled:!!s}),{data:$,isLoading:D}=Qe({queryKey:["strength_history_aggregate",u,"progress",b,N,E],queryFn:()=>Le.getStrengthHistoryAggregate(s,{athleteId:c,period:"day",limit:200,order:"asc",from:N,to:E}),enabled:!!s}),F=C||D,X=k?.runs??[],U=k?.exercise_summary??[],T=$?.periods??[],qe=l=>{if(!A)return[];const w=et(new Date,l),te=A.filter(O=>new Date(O.date)>=w).reverse(),J=new Map;return te.forEach(O=>{const z=Ae(new Date(O.date),"dd/MM");J.has(z)||J.set(z,{date:z,distance:0,effort:0,rpe:0,performance:0,engagement:0,fatigue:0,count:0,rpeCount:0,performanceCount:0,engagementCount:0,fatigueCount:0});const V=J.get(z);V.distance+=O.distance,V.effort+=O.effort,V.count+=1,O.rpe!==null&&O.rpe!==void 0&&(V.rpe+=O.rpe,V.rpeCount+=1),O.performance!==null&&O.performance!==void 0&&(V.performance+=O.performance,V.performanceCount+=1),O.engagement!==null&&O.engagement!==void 0&&(V.engagement+=O.engagement,V.engagementCount+=1),O.fatigue!==null&&O.fatigue!==void 0&&(V.fatigue+=O.fatigue,V.fatigueCount+=1)}),Array.from(J.values()).map(O=>({...O,effort:Math.round(O.effort/O.count*10)/10,rpe:O.rpeCount?Math.round(O.rpe/O.rpeCount*10)/10:null,performance:O.performanceCount?Math.round(O.performance/O.performanceCount*10)/10:null,engagement:O.engagementCount?Math.round(O.engagement/O.engagementCount*10)/10:null,fatigue:O.fatigueCount?Math.round(O.fatigue/O.fatigueCount*10)/10:null}))},$e=A?A.filter(l=>new Date(l.date)>=et(new Date,v)):[],oe=$e.length,L=$e.reduce((l,w)=>(l.distance+=w.distance,l.duration+=w.duration,w.rpe!==null&&w.rpe!==void 0&&(l.rpeSum+=w.rpe,l.rpeCount+=1),w.performance!==null&&w.performance!==void 0&&(l.performanceSum+=w.performance,l.performanceCount+=1),w.engagement!==null&&w.engagement!==void 0&&(l.engagementSum+=w.engagement,l.engagementCount+=1),w.fatigue!==null&&w.fatigue!==void 0&&(l.fatigueSum+=w.fatigue,l.fatigueCount+=1),l),{distance:0,duration:0,rpeSum:0,rpeCount:0,performanceSum:0,performanceCount:0,engagementSum:0,engagementCount:0,fatigueSum:0,fatigueCount:0}),Gt=L.rpeCount?L.rpeSum/L.rpeCount:null,Zt=L.performanceCount?L.performanceSum/L.performanceCount:null,Qt=L.engagementCount?L.engagementSum/L.engagementCount:null,Ut=L.fatigueCount?L.fatigueSum/L.fatigueCount:null;oe&&L.duration/oe;const Jt=oe?L.distance/oe:0,je=qe(v),Xe=l=>l==="rpe"||l==="effort"||l==="fatigue",Ye=l=>{const te=(Array.isArray(l?.logs)?l.logs:[]).map(z=>z?.rpe!==null&&z?.rpe!==void 0?Number(z.rpe):null).filter(z=>z!==null&&Number.isFinite(z));if(te.length>0)return te.reduce((z,V)=>z+V,0)/te.length;const J=l?.feeling??l?.rpe??null,O=J!=null?Number(J):null;return O!==null&&Number.isFinite(O)?O:null},en=l=>l==null||Number.isNaN(l)?"-":l.toFixed(1),dt=[...X].sort((l,w)=>{const te=new Date(l.started_at||l.date||l.created_at||0).getTime(),J=new Date(w.started_at||w.date||w.created_at||0).getTime();return te-J}).map(l=>({date:Ae(new Date(l.started_at||l.date||l.created_at||new Date),"dd/MM"),feeling:Ye(l)})),ft=T.map(l=>({date:l.period,label:Ae(new Date(l.period),"dd/MM"),tonnage:Math.round(l.tonnage??0),volume:Math.round(l.volume??0)})),tn=T.reduce((l,w)=>l+(w.tonnage??0),0),nn=T.reduce((l,w)=>l+(w.volume??0),0),rn=X.length,Ge=X.map(l=>Ye(l)).filter(l=>l!==null&&Number.isFinite(l)),Te=Ge.length?Ge.reduce((l,w)=>l+w,0)/Ge.length:null,Ze=[...U].map(l=>({exerciseId:Number(l.exercise_id),name:l.exercise_name||`Exercice ${l.exercise_id}`,totalSets:Number(l.total_sets??0),totalReps:Number(l.total_reps??0),totalVolume:Number(l.total_volume??0),maxWeight:l.max_weight!==null&&l.max_weight!==void 0?Number(l.max_weight):null,lastPerformedAt:l.last_performed_at??null})).sort((l,w)=>w.totalVolume-l.totalVolume),pt=Ze.slice(0,8),an=l=>{if(!l)return"-";const w=new Date(l);return Number.isNaN(w.getTime())?"-":Ae(w,"dd/MM/yyyy")};return a.jsxs("div",{className:"space-y-6 pb-8",children:[a.jsx("h1",{className:"text-3xl font-display font-bold uppercase italic text-primary",children:"Progression"}),a.jsxs(fn,{defaultValue:"swim",className:"w-full",children:[a.jsxs(pn,{className:"grid w-full grid-cols-2",children:[a.jsx(gt,{value:"swim",children:"Natation"}),a.jsx(gt,{value:"strength",children:"Musculation"})]}),a.jsxs(xt,{value:"swim",className:"space-y-6 animate-in fade-in motion-reduce:animate-none",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[a.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Période"}),a.jsxs(mt,{value:String(v),onValueChange:l=>x(Number(l)),children:[a.jsx(ht,{className:"h-8 w-[140px]",children:a.jsx(yt,{})}),a.jsxs(vt,{children:[a.jsx(de,{value:"7",children:"7 jours"}),a.jsx(de,{value:"30",children:"30 jours"}),a.jsx(de,{value:"365",children:"365 jours"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsxs(M,{className:"text-xs uppercase text-muted-foreground",children:["Volume (",v,"j)"]})}),a.jsxs(K,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[L.distance.toLocaleString(),"m"]})]}),a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsxs(M,{className:"text-xs uppercase text-muted-foreground",children:["Séances (",v,"j)"]})}),a.jsx(K,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:oe})]}),a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsx(M,{className:"text-xs uppercase text-muted-foreground",children:"Distance Moy"})}),a.jsxs(K,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[Math.round(Jt).toLocaleString(),"m"]})]})]}),a.jsx(pr,{avgRpe:Gt,avgPerformance:Zt,avgEngagement:Qt,avgFatigue:Ut}),a.jsxs(R,{children:[a.jsx(I,{children:a.jsx(M,{children:"Volume Quotidien"})}),a.jsx(K,{className:"h-[250px] w-full",children:S?a.jsx(Oe,{}):je.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):a.jsx(Pe,{width:"100%",height:"100%",children:a.jsxs(Je,{data:je,children:[a.jsx(Se,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),a.jsx(le,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),a.jsx(we,{cursor:{fill:"transparent"}}),a.jsx(he,{dataKey:"distance",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),a.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[{key:"rpe",title:"RPE"},{key:"performance",title:"Performance"},{key:"engagement",title:"Engagement"},{key:"fatigue",title:"Fatigue"}].map(l=>a.jsxs(R,{children:[a.jsx(I,{children:a.jsx(M,{children:l.title})}),a.jsx(K,{className:"h-[240px] w-full",children:S?a.jsx(Oe,{}):je.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):a.jsx(Pe,{width:"100%",height:"100%",children:a.jsxs(Je,{data:je,children:[a.jsx(Se,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),a.jsx(le,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),a.jsx(Ke,{domain:[0,5],tickLine:!1,axisLine:!1,fontSize:10}),a.jsx(we,{cursor:{fill:"transparent"},formatter:w=>[w??"-",l.title]}),a.jsx(he,{dataKey:l.key,radius:[4,4,0,0],children:je.map((w,te)=>a.jsx($t,{fill:Ie(w[l.key],{invert:Xe(l.key)})},`${l.key}-${w.date}-${te}`))})]})})})]},l.key))})]}),a.jsxs(xt,{value:"strength",className:"space-y-6 animate-in fade-in motion-reduce:animate-none",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[a.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Période"}),a.jsxs(mt,{value:String(b),onValueChange:l=>P(Number(l)),children:[a.jsx(ht,{className:"h-8 w-[140px]",children:a.jsx(yt,{})}),a.jsxs(vt,{children:[a.jsx(de,{value:"7",children:"7 jours"}),a.jsx(de,{value:"30",children:"30 jours"}),a.jsx(de,{value:"365",children:"365 jours"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsxs(M,{className:"text-xs uppercase text-muted-foreground",children:["Tonnage (",b,"j)"]})}),a.jsxs(K,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[Math.round(tn).toLocaleString()," kg"]})]}),a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsxs(M,{className:"text-xs uppercase text-muted-foreground",children:["Volume (",b,"j)"]})}),a.jsxs(K,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[Math.round(nn).toLocaleString()," reps"]})]}),a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsxs(M,{className:"text-xs uppercase text-muted-foreground",children:["Séances (",b,"j)"]})}),a.jsx(K,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:rn})]}),a.jsxs(R,{children:[a.jsx(I,{className:"p-4 pb-2",children:a.jsx(M,{className:"text-xs uppercase text-muted-foreground",children:"Ressenti Moy"})}),a.jsx(K,{className:"p-4 pt-0",children:a.jsx(_t,{className:Xt,style:{backgroundColor:Ie(Te??null,{invert:Xe("rpe")})??"hsl(var(--muted-foreground))",color:Yt(Ie(Te??null,{invert:Xe("rpe")})??"hsl(var(--muted-foreground))")},children:Te!==null?Te.toFixed(1):"-"})})]})]}),a.jsxs(R,{children:[a.jsx(I,{children:a.jsxs(M,{children:["Tonnage & Volume (",b,"j)"]})}),a.jsx(K,{className:"h-[250px] w-full",children:F?a.jsx(Oe,{}):ft.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):a.jsx(Pe,{width:"100%",height:"100%",children:a.jsxs(ur,{data:ft,children:[a.jsx(Se,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),a.jsx(le,{dataKey:"label",fontSize:10,tickLine:!1,axisLine:!1}),a.jsx(we,{}),a.jsx(he,{dataKey:"tonnage",name:"Tonnage",fill:"hsl(var(--primary))",radius:[4,4,0,0]}),a.jsx(he,{dataKey:"volume",name:"Volume",fill:"hsl(var(--accent))",radius:[4,4,0,0]}),a.jsx(ie,{type:"monotone",dataKey:"tonnage",stroke:"hsl(var(--primary))",strokeWidth:2,dot:!1}),a.jsx(ie,{type:"monotone",dataKey:"volume",stroke:"hsl(var(--accent))",strokeWidth:2,dot:!1})]})})})]}),a.jsxs(R,{children:[a.jsx(I,{children:a.jsx(M,{children:"Ressenti Séances"})}),a.jsx(K,{className:"h-[250px] w-full",children:F?a.jsx(Oe,{}):dt.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):a.jsx(Pe,{width:"100%",height:"100%",children:a.jsxs(cr,{data:dt,children:[a.jsx(Se,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),a.jsx(le,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),a.jsx(Ke,{domain:[0,10],hide:!0}),a.jsx(we,{}),a.jsx(ie,{type:"monotone",dataKey:"feeling",stroke:"hsl(var(--foreground))",strokeWidth:2,dot:{r:4}})]})})})]}),a.jsxs(R,{children:[a.jsx(I,{children:a.jsx(M,{children:"Volume par exercice"})}),a.jsx(K,{className:"h-[260px] w-full",children:F?a.jsx(Oe,{}):pt.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée d'exercice disponible."}):a.jsx(Pe,{width:"100%",height:"100%",children:a.jsxs(Je,{data:pt,children:[a.jsx(Se,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),a.jsx(le,{dataKey:"name",fontSize:10,tickLine:!1,axisLine:!1,interval:0}),a.jsx(we,{cursor:{fill:"transparent"},formatter:l=>[`${Number(l).toLocaleString()} kg`,"Volume"]}),a.jsx(he,{dataKey:"totalVolume",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),a.jsxs(R,{children:[a.jsx(I,{children:a.jsx(M,{children:"Stats par exercice"})}),a.jsx(K,{children:a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs(cn,{children:[a.jsx(un,{children:a.jsxs(Ue,{children:[a.jsx(fe,{children:"Exercice"}),a.jsx(fe,{className:"text-right",children:"Séries"}),a.jsx(fe,{className:"text-right",children:"Répétitions"}),a.jsx(fe,{className:"text-right",children:"Volume"}),a.jsx(fe,{className:"text-right",children:"Charge max"}),a.jsx(fe,{className:"text-right",children:"Dernière séance"})]})}),a.jsx(dn,{children:Ze.length===0?a.jsx(Ue,{children:a.jsx(se,{colSpan:6,className:"text-center text-sm text-muted-foreground",children:"Aucun exercice enregistré."})}):Ze.map(l=>a.jsxs(Ue,{children:[a.jsx(se,{className:"font-medium",children:l.name}),a.jsx(se,{className:"text-right font-mono",children:l.totalSets}),a.jsx(se,{className:"text-right font-mono",children:l.totalReps}),a.jsxs(se,{className:"text-right font-mono",children:[l.totalVolume.toLocaleString()," kg"]}),a.jsx(se,{className:"text-right font-mono",children:l.maxWeight!==null?`${l.maxWeight} kg`:"-"}),a.jsx(se,{className:"text-right text-sm text-muted-foreground",children:an(l.lastPerformedAt)})]},l.exerciseId))})]})})})]}),a.jsxs(R,{children:[a.jsx(I,{children:a.jsx(M,{children:"Historique récent"})}),a.jsxs(K,{className:"space-y-3",children:[_.length===0&&a.jsx("div",{className:"text-center text-sm text-muted-foreground py-6",children:"Aucun historique disponible."}),_.map(l=>a.jsxs("div",{className:"flex items-center justify-between border-b border-border/60 pb-2 last:border-b-0 last:pb-0",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold",children:Ae(new Date(l.started_at||l.date||l.created_at||new Date),"dd/MM/yyyy")}),a.jsx("div",{className:"text-xs uppercase text-muted-foreground",children:l.status||"Séance"})]}),a.jsxs("div",{className:"text-sm font-mono font-semibold",children:[en(Ye(l)),"/10"]})]},l.id)),j.hasNextPage&&a.jsx(sn,{variant:"outline",size:"sm",className:"w-full",onClick:()=>j.fetchNextPage(),disabled:j.isFetchingNextPage,children:j.isFetchingNextPage?"Chargement...":"Charger plus"})]})]})]})]})]})}export{pr as SwimKpiCompactGrid,Ar as default};
