import{r as a,b as Nr,h as wr,m as It,n as _r,j as e,d as Ft,o as Sr,l as Q,u as He,I as Cr,t as Er,E as kr,s as de,H as Rr,J as Dr,O as Ir,K as Fr,c as pe}from"./vendor-ui-Cp7LoSvI.js";import{b as Mr,u as je,c as W}from"./vendor-query-DWM3xq1x.js";import{c as Je,a as V,D as Ne,C as Ar,L as A,I as K,f as Pr,d as T,B as ae,S as Me,s as ot}from"./index-bF_flMZb.js";import{u as $r,S as Ae,a as Pe,b as $e,c as qe,d as ee}from"./select-W_K7_xI9.js";import{C as qr}from"./circle-DpjpETpr.js";import{T as we}from"./textarea-WuRolWba.js";import{D as _e,a as Se,b as Ge,c as Ue}from"./dialog-aAp5LVv7.js";import{C as ct}from"./checkbox-EoTQTbw5.js";import{A as dt,a as ut,b as mt,c as pt,d as xt,e as ft,f as ht,g as gt}from"./alert-dialog-Bbowkw9V.js";import{T as Or,a as Kr,b as Lr,c as Tr}from"./tabs-BhsxEC_P.js";import{A as Gr,a as Ur,F as zr,S as Br,b as Vr,c as vt,d as jt}from"./SessionListView-D1OfTnTX.js";import{D as Qr,a as Wr,b as Hr,c as Jr}from"./drawer-C9zaSbSX.js";import{S as Mt}from"./search-CmBSfY5Z.js";import{C as At}from"./chevron-up-qECYr6gR.js";import{C as Xr}from"./check-DVkUw4X6.js";import{T as Ce,P as Yr}from"./trash-2-CqCpfa7P.js";import{P as Ee}from"./plus-Koi8OKuh.js";import{P as Pt,a as $t,b as qt}from"./Coach-Cj34YfqF.js";import{C as Zr}from"./chevron-right-B8q-dR8X.js";import{L as yt}from"./loader-circle-B1fFPGlw.js";import{C as es}from"./circle-alert-Bn-IPMxU.js";import{P as bt}from"./pen-BBsPG8yE.js";import"./vendor-react-BzrpNAyj.js";import"./vendor-charts-BtSE1gaf.js";import"./vendor-supabase-Cs1gO9iU.js";import"./chevron-left-D5N-oeZE.js";import"./save-BV10Y3Yh.js";import"./badge-U-0hSLAM.js";import"./arrow-left-CSnVncyz.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],rs=Je("ellipsis",ts);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ns=Je("funnel",ss);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Nt=Je("upload",as);function ze(t,n,{checkForDefaultPrevented:s=!0}={}){return function(l){if(t?.(l),s===!1||!l.defaultPrevented)return n?.(l)}}var ls=Nr[" useInsertionEffect ".trim().toString()]||wr;function is({prop:t,defaultProp:n,onChange:s=()=>{},caller:d}){const[l,o,p]=os({defaultProp:n,onChange:s}),m=t!==void 0,v=m?t:l;{const x=a.useRef(t!==void 0);a.useEffect(()=>{const f=x.current;f!==m&&console.warn(`${d} is changing from ${f?"controlled":"uncontrolled"} to ${m?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),x.current=m},[m,d])}const i=a.useCallback(x=>{if(m){const f=cs(x)?x(t):x;f!==t&&p.current?.(f)}else o(x)},[m,t,o,p]);return[v,i]}function os({defaultProp:t,onChange:n}){const[s,d]=a.useState(t),l=a.useRef(s),o=a.useRef(n);return ls(()=>{o.current=n},[n]),a.useEffect(()=>{l.current!==s&&(o.current?.(s),l.current=s)},[s,l]),[s,d,o]}function cs(t){return typeof t=="function"}var Xe="Radio",[ds,Ot]=Ft(Xe),[us,ms]=ds(Xe),Kt=a.forwardRef((t,n)=>{const{__scopeRadio:s,name:d,checked:l=!1,required:o,disabled:p,value:m="on",onCheck:v,form:i,...x}=t,[f,S]=a.useState(null),b=He(n,P=>S(P)),N=a.useRef(!1),I=f?i||!!f.closest("form"):!0;return e.jsxs(us,{scope:s,checked:l,disabled:p,children:[e.jsx(Q.button,{type:"button",role:"radio","aria-checked":l,"data-state":Ut(l),"data-disabled":p?"":void 0,disabled:p,value:m,...x,ref:b,onClick:ze(t.onClick,P=>{l||v?.(),I&&(N.current=P.isPropagationStopped(),N.current||P.stopPropagation())})}),I&&e.jsx(Gt,{control:f,bubbles:!N.current,name:d,value:m,checked:l,required:o,disabled:p,form:i,style:{transform:"translateX(-100%)"}})]})});Kt.displayName=Xe;var Lt="RadioIndicator",Tt=a.forwardRef((t,n)=>{const{__scopeRadio:s,forceMount:d,...l}=t,o=ms(Lt,s);return e.jsx(Er,{present:d||o.checked,children:e.jsx(Q.span,{"data-state":Ut(o.checked),"data-disabled":o.disabled?"":void 0,...l,ref:n})})});Tt.displayName=Lt;var ps="RadioBubbleInput",Gt=a.forwardRef(({__scopeRadio:t,control:n,checked:s,bubbles:d=!0,...l},o)=>{const p=a.useRef(null),m=He(p,o),v=$r(s),i=kr(n);return a.useEffect(()=>{const x=p.current;if(!x)return;const f=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(f,"checked").set;if(v!==s&&b){const N=new Event("click",{bubbles:d});b.call(x,s),x.dispatchEvent(N)}},[v,s,d]),e.jsx(Q.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...l,tabIndex:-1,ref:m,style:{...l.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Gt.displayName=ps;function Ut(t){return t?"checked":"unchecked"}var xs=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ke="RadioGroup",[fs]=Ft(ke,[It,Ot]),zt=It(),Bt=Ot(),[hs,gs]=fs(ke),Vt=a.forwardRef((t,n)=>{const{__scopeRadioGroup:s,name:d,defaultValue:l,value:o,required:p=!1,disabled:m=!1,orientation:v,dir:i,loop:x=!0,onValueChange:f,...S}=t,b=zt(s),N=_r(i),[I,P]=is({prop:o,defaultProp:l??null,onChange:f,caller:ke});return e.jsx(hs,{scope:s,name:d,required:p,disabled:m,value:I,onValueChange:P,children:e.jsx(Sr,{asChild:!0,...b,orientation:v,dir:N,loop:x,children:e.jsx(Q.div,{role:"radiogroup","aria-required":p,"aria-orientation":v,"data-disabled":m?"":void 0,dir:N,...S,ref:n})})})});Vt.displayName=ke;var Qt="RadioGroupItem",Wt=a.forwardRef((t,n)=>{const{__scopeRadioGroup:s,disabled:d,...l}=t,o=gs(Qt,s),p=o.disabled||d,m=zt(s),v=Bt(s),i=a.useRef(null),x=He(n,i),f=o.value===l.value,S=a.useRef(!1);return a.useEffect(()=>{const b=I=>{xs.includes(I.key)&&(S.current=!0)},N=()=>S.current=!1;return document.addEventListener("keydown",b),document.addEventListener("keyup",N),()=>{document.removeEventListener("keydown",b),document.removeEventListener("keyup",N)}},[]),e.jsx(Cr,{asChild:!0,...m,focusable:!p,active:f,children:e.jsx(Kt,{disabled:p,required:o.required,checked:f,...v,...l,name:o.name,ref:x,onCheck:()=>o.onValueChange(l.value),onKeyDown:ze(b=>{b.key==="Enter"&&b.preventDefault()}),onFocus:ze(l.onFocus,()=>{S.current&&i.current?.click()})})})});Wt.displayName=Qt;var vs="RadioGroupIndicator",Ht=a.forwardRef((t,n)=>{const{__scopeRadioGroup:s,...d}=t,l=Bt(s);return e.jsx(Tt,{...l,...d,ref:n})});Ht.displayName=vs;var Jt=Vt,Xt=Wt,js=Ht;const Yt=a.forwardRef(({className:t,...n},s)=>e.jsx(Jt,{className:V("grid gap-2",t),...n,ref:s}));Yt.displayName=Jt.displayName;const Be=a.forwardRef(({className:t,...n},s)=>e.jsx(Xt,{ref:s,className:V("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(js,{className:"flex items-center justify-center",children:e.jsx(qr,{className:"h-3.5 w-3.5 fill-primary"})})}));Be.displayName=Xt.displayName;var wt=1,ys=.9,bs=.8,Ns=.17,Oe=.1,Ke=.999,ws=.9999,_s=.99,Ss=/[\\\/_+.#"@\[\(\{&]/,Cs=/[\\\/_+.#"@\[\(\{&]/g,Es=/[\s-]/,Zt=/[\s-]/g;function Ve(t,n,s,d,l,o,p){if(o===n.length)return l===t.length?wt:_s;var m=`${l},${o}`;if(p[m]!==void 0)return p[m];for(var v=d.charAt(o),i=s.indexOf(v,l),x=0,f,S,b,N;i>=0;)f=Ve(t,n,s,d,i+1,o+1,p),f>x&&(i===l?f*=wt:Ss.test(t.charAt(i-1))?(f*=bs,b=t.slice(l,i-1).match(Cs),b&&l>0&&(f*=Math.pow(Ke,b.length))):Es.test(t.charAt(i-1))?(f*=ys,N=t.slice(l,i-1).match(Zt),N&&l>0&&(f*=Math.pow(Ke,N.length))):(f*=Ns,l>0&&(f*=Math.pow(Ke,i-l))),t.charAt(i)!==n.charAt(o)&&(f*=ws)),(f<Oe&&s.charAt(i-1)===d.charAt(o+1)||d.charAt(o+1)===d.charAt(o)&&s.charAt(i-1)!==d.charAt(o))&&(S=Ve(t,n,s,d,i+1,o+2,p),S*Oe>f&&(f=S*Oe)),f>x&&(x=f),i=s.indexOf(v,i+1);return p[m]=x,x}function _t(t){return t.toLowerCase().replace(Zt," ")}function ks(t,n,s){return t=s&&s.length>0?`${t+" "+s.join(" ")}`:t,Ve(t,n,_t(t),_t(n),0,0,{})}var me='[cmdk-group=""]',Le='[cmdk-group-items=""]',Rs='[cmdk-group-heading=""]',er='[cmdk-item=""]',St=`${er}:not([aria-disabled="true"])`,Qe="cmdk-item-select",oe="data-value",Ds=(t,n,s)=>ks(t,n,s),tr=a.createContext(void 0),xe=()=>a.useContext(tr),rr=a.createContext(void 0),Ye=()=>a.useContext(rr),sr=a.createContext(void 0),nr=a.forwardRef((t,n)=>{let s=ce(()=>{var c,y;return{search:"",value:(y=(c=t.value)!=null?c:t.defaultValue)!=null?y:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=ce(()=>new Set),l=ce(()=>new Map),o=ce(()=>new Map),p=ce(()=>new Set),m=ar(t),{label:v,children:i,value:x,onValueChange:f,filter:S,shouldFilter:b,loop:N,disablePointerSelection:I=!1,vimBindings:P=!0,...C}=t,w=de(),re=de(),H=de(),U=a.useRef(null),D=Ts();le(()=>{if(x!==void 0){let c=x.trim();s.current.value=c,q.emit()}},[x]),le(()=>{D(6,B)},[]);let q=a.useMemo(()=>({subscribe:c=>(p.current.add(c),()=>p.current.delete(c)),snapshot:()=>s.current,setState:(c,y,_)=>{var j,k,M,L;if(!Object.is(s.current[c],y)){if(s.current[c]=y,c==="search")z(),E(),D(1,F);else if(c==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let O=document.getElementById(H);O?O.focus():(j=document.getElementById(w))==null||j.focus()}if(D(7,()=>{var O;s.current.selectedItemId=(O=Y())==null?void 0:O.id,q.emit()}),_||D(5,B),((k=m.current)==null?void 0:k.value)!==void 0){let O=y??"";(L=(M=m.current).onValueChange)==null||L.call(M,O);return}}q.emit()}},emit:()=>{p.current.forEach(c=>c())}}),[]),X=a.useMemo(()=>({value:(c,y,_)=>{var j;y!==((j=o.current.get(c))==null?void 0:j.value)&&(o.current.set(c,{value:y,keywords:_}),s.current.filtered.items.set(c,h(y,_)),D(2,()=>{E(),q.emit()}))},item:(c,y)=>(d.current.add(c),y&&(l.current.has(y)?l.current.get(y).add(c):l.current.set(y,new Set([c]))),D(3,()=>{z(),E(),s.current.value||F(),q.emit()}),()=>{o.current.delete(c),d.current.delete(c),s.current.filtered.items.delete(c);let _=Y();D(4,()=>{z(),_?.getAttribute("id")===c&&F(),q.emit()})}),group:c=>(l.current.has(c)||l.current.set(c,new Set),()=>{o.current.delete(c),l.current.delete(c)}),filter:()=>m.current.shouldFilter,label:v||t["aria-label"],getDisablePointerSelection:()=>m.current.disablePointerSelection,listId:w,inputId:H,labelId:re,listInnerRef:U}),[]);function h(c,y){var _,j;let k=(j=(_=m.current)==null?void 0:_.filter)!=null?j:Ds;return c?k(c,s.current.search,y):0}function E(){if(!s.current.search||m.current.shouldFilter===!1)return;let c=s.current.filtered.items,y=[];s.current.filtered.groups.forEach(j=>{let k=l.current.get(j),M=0;k.forEach(L=>{let O=c.get(L);M=Math.max(O,M)}),y.push([j,M])});let _=U.current;J().sort((j,k)=>{var M,L;let O=j.getAttribute("id"),ne=k.getAttribute("id");return((M=c.get(ne))!=null?M:0)-((L=c.get(O))!=null?L:0)}).forEach(j=>{let k=j.closest(Le);k?k.appendChild(j.parentElement===k?j:j.closest(`${Le} > *`)):_.appendChild(j.parentElement===_?j:j.closest(`${Le} > *`))}),y.sort((j,k)=>k[1]-j[1]).forEach(j=>{var k;let M=(k=U.current)==null?void 0:k.querySelector(`${me}[${oe}="${encodeURIComponent(j[0])}"]`);M?.parentElement.appendChild(M)})}function F(){let c=J().find(_=>_.getAttribute("aria-disabled")!=="true"),y=c?.getAttribute(oe);q.setState("value",y||void 0)}function z(){var c,y,_,j;if(!s.current.search||m.current.shouldFilter===!1){s.current.filtered.count=d.current.size;return}s.current.filtered.groups=new Set;let k=0;for(let M of d.current){let L=(y=(c=o.current.get(M))==null?void 0:c.value)!=null?y:"",O=(j=(_=o.current.get(M))==null?void 0:_.keywords)!=null?j:[],ne=h(L,O);s.current.filtered.items.set(M,ne),ne>0&&k++}for(let[M,L]of l.current)for(let O of L)if(s.current.filtered.items.get(O)>0){s.current.filtered.groups.add(M);break}s.current.filtered.count=k}function B(){var c,y,_;let j=Y();j&&(((c=j.parentElement)==null?void 0:c.firstChild)===j&&((_=(y=j.closest(me))==null?void 0:y.querySelector(Rs))==null||_.scrollIntoView({block:"nearest"})),j.scrollIntoView({block:"nearest"}))}function Y(){var c;return(c=U.current)==null?void 0:c.querySelector(`${er}[aria-selected="true"]`)}function J(){var c;return Array.from(((c=U.current)==null?void 0:c.querySelectorAll(St))||[])}function ue(c){let y=J()[c];y&&q.setState("value",y.getAttribute(oe))}function Z(c){var y;let _=Y(),j=J(),k=j.findIndex(L=>L===_),M=j[k+c];(y=m.current)!=null&&y.loop&&(M=k+c<0?j[j.length-1]:k+c===j.length?j[0]:j[k+c]),M&&q.setState("value",M.getAttribute(oe))}function fe(c){let y=Y(),_=y?.closest(me),j;for(;_&&!j;)_=c>0?Ks(_,me):Ls(_,me),j=_?.querySelector(St);j?q.setState("value",j.getAttribute(oe)):Z(c)}let he=()=>ue(J().length-1),De=c=>{c.preventDefault(),c.metaKey?he():c.altKey?fe(1):Z(1)},se=c=>{c.preventDefault(),c.metaKey?ue(0):c.altKey?fe(-1):Z(-1)};return a.createElement(Q.div,{ref:n,tabIndex:-1,...C,"cmdk-root":"",onKeyDown:c=>{var y;(y=C.onKeyDown)==null||y.call(C,c);let _=c.nativeEvent.isComposing||c.keyCode===229;if(!(c.defaultPrevented||_))switch(c.key){case"n":case"j":{P&&c.ctrlKey&&De(c);break}case"ArrowDown":{De(c);break}case"p":case"k":{P&&c.ctrlKey&&se(c);break}case"ArrowUp":{se(c);break}case"Home":{c.preventDefault(),ue(0);break}case"End":{c.preventDefault(),he();break}case"Enter":{c.preventDefault();let j=Y();if(j){let k=new Event(Qe);j.dispatchEvent(k)}}}}},a.createElement("label",{"cmdk-label":"",htmlFor:X.inputId,id:X.labelId,style:Us},v),Re(t,c=>a.createElement(rr.Provider,{value:q},a.createElement(tr.Provider,{value:X},c))))}),Is=a.forwardRef((t,n)=>{var s,d;let l=de(),o=a.useRef(null),p=a.useContext(sr),m=xe(),v=ar(t),i=(d=(s=v.current)==null?void 0:s.forceMount)!=null?d:p?.forceMount;le(()=>{if(!i)return m.item(l,p?.id)},[i]);let x=lr(l,o,[t.value,t.children,o],t.keywords),f=Ye(),S=te(D=>D.value&&D.value===x.current),b=te(D=>i||m.filter()===!1?!0:D.search?D.filtered.items.get(l)>0:!0);a.useEffect(()=>{let D=o.current;if(!(!D||t.disabled))return D.addEventListener(Qe,N),()=>D.removeEventListener(Qe,N)},[b,t.onSelect,t.disabled]);function N(){var D,q;I(),(q=(D=v.current).onSelect)==null||q.call(D,x.current)}function I(){f.setState("value",x.current,!0)}if(!b)return null;let{disabled:P,value:C,onSelect:w,forceMount:re,keywords:H,...U}=t;return a.createElement(Q.div,{ref:pe(o,n),...U,id:l,"cmdk-item":"",role:"option","aria-disabled":!!P,"aria-selected":!!S,"data-disabled":!!P,"data-selected":!!S,onPointerMove:P||m.getDisablePointerSelection()?void 0:I,onClick:P?void 0:N},t.children)}),Fs=a.forwardRef((t,n)=>{let{heading:s,children:d,forceMount:l,...o}=t,p=de(),m=a.useRef(null),v=a.useRef(null),i=de(),x=xe(),f=te(b=>l||x.filter()===!1?!0:b.search?b.filtered.groups.has(p):!0);le(()=>x.group(p),[]),lr(p,m,[t.value,t.heading,v]);let S=a.useMemo(()=>({id:p,forceMount:l}),[l]);return a.createElement(Q.div,{ref:pe(m,n),...o,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},s&&a.createElement("div",{ref:v,"cmdk-group-heading":"","aria-hidden":!0,id:i},s),Re(t,b=>a.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":s?i:void 0},a.createElement(sr.Provider,{value:S},b))))}),Ms=a.forwardRef((t,n)=>{let{alwaysRender:s,...d}=t,l=a.useRef(null),o=te(p=>!p.search);return!s&&!o?null:a.createElement(Q.div,{ref:pe(l,n),...d,"cmdk-separator":"",role:"separator"})}),As=a.forwardRef((t,n)=>{let{onValueChange:s,...d}=t,l=t.value!=null,o=Ye(),p=te(i=>i.search),m=te(i=>i.selectedItemId),v=xe();return a.useEffect(()=>{t.value!=null&&o.setState("search",t.value)},[t.value]),a.createElement(Q.input,{ref:n,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":v.listId,"aria-labelledby":v.labelId,"aria-activedescendant":m,id:v.inputId,type:"text",value:l?t.value:p,onChange:i=>{l||o.setState("search",i.target.value),s?.(i.target.value)}})}),Ps=a.forwardRef((t,n)=>{let{children:s,label:d="Suggestions",...l}=t,o=a.useRef(null),p=a.useRef(null),m=te(i=>i.selectedItemId),v=xe();return a.useEffect(()=>{if(p.current&&o.current){let i=p.current,x=o.current,f,S=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let b=i.offsetHeight;x.style.setProperty("--cmdk-list-height",b.toFixed(1)+"px")})});return S.observe(i),()=>{cancelAnimationFrame(f),S.unobserve(i)}}},[]),a.createElement(Q.div,{ref:pe(o,n),...l,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":m,"aria-label":d,id:v.listId},Re(t,i=>a.createElement("div",{ref:pe(p,v.listInnerRef),"cmdk-list-sizer":""},i)))}),$s=a.forwardRef((t,n)=>{let{open:s,onOpenChange:d,overlayClassName:l,contentClassName:o,container:p,...m}=t;return a.createElement(Rr,{open:s,onOpenChange:d},a.createElement(Dr,{container:p},a.createElement(Ir,{"cmdk-overlay":"",className:l}),a.createElement(Fr,{"aria-label":t.label,"cmdk-dialog":"",className:o},a.createElement(nr,{ref:n,...m}))))}),qs=a.forwardRef((t,n)=>te(s=>s.filtered.count===0)?a.createElement(Q.div,{ref:n,...t,"cmdk-empty":"",role:"presentation"}):null),Os=a.forwardRef((t,n)=>{let{progress:s,children:d,label:l="Loading...",...o}=t;return a.createElement(Q.div,{ref:n,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":l},Re(t,p=>a.createElement("div",{"aria-hidden":!0},p)))}),G=Object.assign(nr,{List:Ps,Item:Is,Input:As,Group:Fs,Separator:Ms,Dialog:$s,Empty:qs,Loading:Os});function Ks(t,n){let s=t.nextElementSibling;for(;s;){if(s.matches(n))return s;s=s.nextElementSibling}}function Ls(t,n){let s=t.previousElementSibling;for(;s;){if(s.matches(n))return s;s=s.previousElementSibling}}function ar(t){let n=a.useRef(t);return le(()=>{n.current=t}),n}var le=typeof window>"u"?a.useEffect:a.useLayoutEffect;function ce(t){let n=a.useRef();return n.current===void 0&&(n.current=t()),n}function te(t){let n=Ye(),s=()=>t(n.snapshot());return a.useSyncExternalStore(n.subscribe,s,s)}function lr(t,n,s,d=[]){let l=a.useRef(),o=xe();return le(()=>{var p;let m=(()=>{var i;for(let x of s){if(typeof x=="string")return x.trim();if(typeof x=="object"&&"current"in x)return x.current?(i=x.current.textContent)==null?void 0:i.trim():l.current}})(),v=d.map(i=>i.trim());o.value(t,m,v),(p=n.current)==null||p.setAttribute(oe,m),l.current=m}),l}var Ts=()=>{let[t,n]=a.useState(),s=ce(()=>new Map);return le(()=>{s.current.forEach(d=>d()),s.current=new Map},[t]),(d,l)=>{s.current.set(d,l),n({})}};function Gs(t){let n=t.type;return typeof n=="function"?n(t.props):"render"in n?n.render(t.props):t}function Re({asChild:t,children:n},s){return t&&a.isValidElement(n)?a.cloneElement(Gs(n),{ref:n.ref},s(n.props.children)):s(n)}var Us={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const ir=a.forwardRef(({className:t,...n},s)=>e.jsx(G,{ref:s,className:V("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...n}));ir.displayName=G.displayName;const or=a.forwardRef(({className:t,...n},s)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Mt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(G.Input,{ref:s,className:V("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...n})]}));or.displayName=G.Input.displayName;const cr=a.forwardRef(({className:t,...n},s)=>e.jsx(G.List,{ref:s,className:V("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...n}));cr.displayName=G.List.displayName;const dr=a.forwardRef((t,n)=>e.jsx(G.Empty,{ref:n,className:"py-6 text-center text-sm",...t}));dr.displayName=G.Empty.displayName;const We=a.forwardRef(({className:t,...n},s)=>e.jsx(G.Group,{ref:s,className:V("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...n}));We.displayName=G.Group.displayName;const zs=a.forwardRef(({className:t,...n},s)=>e.jsx(G.Separator,{ref:s,className:V("-mx-1 h-px bg-border",t),...n}));zs.displayName=G.Separator.displayName;const ur=a.forwardRef(({className:t,...n},s)=>e.jsx(G.Item,{ref:s,className:V("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...n}));ur.displayName=G.Item.displayName;function Bs({exercises:t,selectedId:n,onSelect:s}){const[d,l]=a.useState(!1),o=t.find(i=>i.id===n),p=t.filter(i=>i.exercise_type!=="warmup"),m=t.filter(i=>i.exercise_type==="warmup"),v=i=>{s(i),l(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",onClick:()=>l(!0),className:"flex w-full items-center gap-2 rounded-xl border border-input bg-background px-3 py-2 text-sm hover:bg-accent/50",children:[o?.illustration_gif?e.jsx("img",{src:o.illustration_gif,alt:"",className:"h-7 w-7 shrink-0 rounded-md object-cover"}):e.jsx("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-md bg-muted",children:e.jsx(Ne,{className:"h-3.5 w-3.5 text-muted-foreground"})}),e.jsx("span",{className:"min-w-0 flex-1 truncate text-left font-medium",children:o?.nom_exercice??"Choisir un exercice"}),e.jsx(At,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx(Qr,{open:d,onOpenChange:l,children:e.jsxs(Wr,{className:"max-h-[85vh]",children:[e.jsx(Hr,{className:"pb-0",children:e.jsx(Jr,{children:"Choisir un exercice"})}),e.jsxs(ir,{className:"mt-2",shouldFilter:!0,children:[e.jsx(or,{placeholder:"Rechercher...",className:"h-12"}),e.jsxs(cr,{className:"max-h-[60vh] px-1 pb-safe",children:[e.jsx(dr,{children:"Aucun exercice trouvé"}),p.length>0&&e.jsx(We,{heading:"Travail",children:p.map(i=>e.jsx(Ct,{exercise:i,isSelected:i.id===n,onSelect:()=>v(i.id)},i.id))}),m.length>0&&e.jsx(We,{heading:"Échauffement",children:m.map(i=>e.jsx(Ct,{exercise:i,isSelected:i.id===n,onSelect:()=>v(i.id)},i.id))})]})]})]})})]})}function Ct({exercise:t,isSelected:n,onSelect:s}){return e.jsxs(ur,{value:t.nom_exercice,onSelect:s,className:"flex items-center gap-3 rounded-xl px-2 py-2.5",children:[t.illustration_gif?e.jsx("img",{src:t.illustration_gif,alt:"",className:"h-9 w-9 shrink-0 rounded-lg object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("span",{className:"min-w-0 flex-1 truncate text-sm font-medium",children:t.nom_exercice}),n&&e.jsx(Xr,{className:"h-4 w-4 shrink-0 text-primary"})]})}function Vs({exercise:t,exercises:n,exerciseFilter:s,index:d,totalItems:l,onChange:o,onDelete:p,onMoveUp:m,onMoveDown:v}){const[i,x]=a.useState(!1),[f,S]=a.useState(!1),b=n.filter(w=>s==="all"?!0:w.exercise_type===s),N=n.find(w=>w.id===t.exercise_id),I=N?.nom_exercice??"Exercice",P=N?.exercise_type==="warmup",C=N?.illustration_gif;return e.jsxs(e.Fragment,{children:[e.jsxs(Ar,{className:V("rounded-2xl border-border transition-all",i&&"ring-1 ring-primary/20"),children:[e.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 p-3 text-left",onClick:()=>x(!i),children:[e.jsx("span",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-muted text-xs font-bold text-muted-foreground",children:d+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-semibold",children:I}),P&&e.jsx("span",{className:"shrink-0 rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-semibold text-amber-800",children:"Échauf."})]}),e.jsxs("div",{className:"mt-0.5 text-xs text-muted-foreground",children:[t.sets,"×",t.reps,t.percent_1rm?` @ ${t.percent_1rm}% 1RM`:"",t.rest_seconds?` · ${t.rest_seconds}s repos`:""]})]}),C&&e.jsx("button",{type:"button",className:"shrink-0 rounded-lg overflow-hidden border border-border bg-muted",onClick:w=>{w.stopPropagation(),S(!0)},children:e.jsx("img",{src:C,alt:I,className:"h-9 w-9 object-cover"})}),e.jsx(At,{className:V("h-4 w-4 shrink-0 text-muted-foreground transition-transform",i&&"rotate-180")})]}),i&&e.jsxs("div",{className:"border-t border-border px-3 pb-3 pt-3 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{className:"text-xs",children:"Séries"}),e.jsx(K,{type:"number",inputMode:"numeric",value:t.sets===0?"":t.sets,onChange:w=>o("sets",w.target.value===""?0:Number(w.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{className:"text-xs",children:"Reps"}),e.jsx(K,{type:"number",inputMode:"numeric",value:t.reps===0?"":t.reps,onChange:w=>o("reps",w.target.value===""?0:Number(w.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{className:"text-xs",children:"% 1RM"}),e.jsx(K,{type:"number",inputMode:"numeric",value:t.percent_1rm===0?"":t.percent_1rm,onChange:w=>o("percent_1rm",w.target.value===""?0:Number(w.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{className:"text-xs",children:"Repos (s)"}),e.jsx(K,{type:"number",inputMode:"numeric",value:t.rest_seconds===0?"":t.rest_seconds,onChange:w=>o("rest_seconds",w.target.value===""?0:Number(w.target.value)),className:"rounded-xl h-10"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{className:"text-xs",children:"Exercice"}),e.jsx(Bs,{exercises:b,selectedId:t.exercise_id,onSelect:w=>o("exercise_id",w)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{className:"text-xs",children:"Notes"}),e.jsx(we,{value:t.notes??"",onChange:w=>o("notes",w.target.value||null),placeholder:"Notes optionnelles...",className:"rounded-xl min-h-[60px]"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:w=>{w.stopPropagation(),m()},disabled:d===0,className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted disabled:opacity-30","aria-label":"Monter",children:e.jsx(Gr,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:w=>{w.stopPropagation(),v()},disabled:d===l-1,className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted disabled:opacity-30","aria-label":"Descendre",children:e.jsx(Ur,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"button",onClick:w=>{w.stopPropagation(),p()},className:"inline-flex h-9 items-center gap-2 rounded-full px-3 text-xs font-medium text-destructive hover:bg-destructive/10",children:[e.jsx(Ce,{className:"h-3.5 w-3.5"}),"Supprimer"]})]})]})]}),C&&e.jsx(_e,{open:f,onOpenChange:S,children:e.jsx(Se,{className:"sm:max-w-md p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{src:C,alt:I,className:"w-full max-h-[70vh] object-contain rounded-lg"}),e.jsx("p",{className:"text-sm font-medium text-center",children:I})]})})})]})}const Qs=t=>t==="endurance"||t==="hypertrophie"||t==="force"?t:"endurance";function Ws({session:t,exercises:n,editingSessionId:s,folders:d,onSessionChange:l,onCycleChange:o,onSave:p,onCancel:m,onAddItem:v,onUpdateItem:i,onRemoveItem:x,onReorderItems:f,onExerciseDialogOpen:S,isSaving:b}){const[N,I]=a.useState("all"),[P,C]=a.useState(!1),[w,re]=a.useState(!1),H=new Map(n.map(h=>[h.id,h])),U=t.items.reduce((h,E)=>h+(E.sets||0),0),D=h=>{h>0&&f(h,h-1)},q=h=>{h<t.items.length-1&&f(h,h+1)},X=()=>{C(!0)};return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-bottom-4",children:[e.jsx(zr,{isEditing:!!s,isSaving:b,onSave:p,onCancel:m,onPreview:X}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(Br,{name:t.title,onNameChange:h=>l({...t,title:h}),showDuration:!1,showTotalDistance:!1,collapsible:!0,collapsed:w,onToggleCollapse:()=>re(!w),collapsedSummary:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:t.title||"Sans titre"}),e.jsx("span",{children:"·"}),e.jsx("span",{className:"capitalize",children:t.cycle}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[U," séries"]})]}),additionalFields:e.jsxs(e.Fragment,{children:[d&&d.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Dossier"}),e.jsx("div",{className:"mt-1",children:e.jsxs(Ae,{value:t.folder_id?.toString()??"none",onValueChange:h=>l({...t,folder_id:h==="none"?null:parseInt(h)}),children:[e.jsx(Pe,{className:"rounded-2xl",children:e.jsx($e,{})}),e.jsxs(qe,{children:[e.jsx(ee,{value:"none",children:"Aucun"}),d.map(h=>e.jsx(ee,{value:h.id.toString(),children:h.name},h.id))]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Cycle"}),e.jsx("div",{className:"mt-1",children:e.jsxs(Ae,{value:t.cycle,onValueChange:h=>o(Qs(h)),children:[e.jsx(Pe,{className:"rounded-2xl",children:e.jsx($e,{})}),e.jsxs(qe,{children:[e.jsx(ee,{value:"endurance",children:"Endurance"}),e.jsx(ee,{value:"hypertrophie",children:"Hypertrophie"}),e.jsx(ee,{value:"force",children:"Force"})]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Séries totales"}),e.jsx("div",{className:"mt-1 rounded-2xl border border-border bg-muted px-3 py-2 text-sm font-semibold",children:U})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Description"}),e.jsx("div",{className:"mt-1",children:e.jsx(we,{value:t.description,onChange:h=>l({...t,description:h.target.value}),placeholder:"Description optionnelle...",className:"rounded-2xl min-h-[60px]"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Exercices (",t.items.length,")"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Ae,{value:N,onValueChange:h=>I(h),children:[e.jsxs(Pe,{className:"h-8 w-auto gap-1 rounded-full border-dashed text-xs",children:[e.jsx(ns,{className:"h-3 w-3"}),e.jsx($e,{})]}),e.jsxs(qe,{children:[e.jsx(ee,{value:"all",children:"Tous"}),e.jsx(ee,{value:"strength",children:"Travail"}),e.jsx(ee,{value:"warmup",children:"Échauf."})]})]})})]}),e.jsx("div",{className:"space-y-2",children:t.items.map((h,E)=>e.jsx(Vs,{exercise:h,exercises:n,exerciseFilter:N,index:E,totalItems:t.items.length,onChange:(F,z)=>i(E,F,z),onDelete:()=>x(E),onMoveUp:()=>D(E),onMoveDown:()=>q(E)},`${h.exercise_id}-${E}`))}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",onClick:v,className:"inline-flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(Ee,{className:"h-4 w-4"})," Ajouter un exercice"]}),e.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-2 rounded-full border border-border px-4 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(Ee,{className:"h-4 w-4"})," Nouvel exercice"]})]})]}),e.jsx(_e,{open:P,onOpenChange:C,children:e.jsxs(Se,{className:"sm:max-w-3xl",children:[e.jsx(Ge,{children:e.jsx(Ue,{children:"Aperçu de la séance"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-lg font-semibold",children:t.title||"Sans titre"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description||"—"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Cycle : ",t.cycle]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Exercices"}),e.jsx("div",{className:"space-y-2",children:t.items.slice().sort((h,E)=>(h.order_index??0)-(E.order_index??0)).map((h,E)=>{const F=H.get(h.exercise_id);return e.jsxs("div",{className:"rounded-xl border px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"font-medium",children:[E+1,". ",F?.nom_exercice??"Exercice"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:F?.exercise_type==="warmup"?"Échauffement":"Travail"})]}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[h.sets," séries • ",h.reps," reps • ",h.percent_1rm,"% 1RM •"," ",h.rest_seconds,"s"]})]},`${h.exercise_id}-${E}`)})})]})]})]})})]})}function Et({name:t,count:n,children:s,onRename:d,onDelete:l,defaultOpen:o=!1}){const[p,m]=a.useState(o),[v,i]=a.useState(!1),[x,f]=a.useState(t),[S,b]=a.useState(!1),N=a.useRef(null);a.useEffect(()=>{v&&(N.current?.focus(),N.current?.select())},[v]);const I=()=>{const C=x.trim();C&&C!==t?d(C):f(t),i(!1)},P=()=>{f(t),i(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:V("flex items-center gap-1 rounded-xl px-2 py-1.5 cursor-pointer select-none hover:bg-muted/50"),onClick:()=>{v||m(C=>!C)},children:[e.jsx(Zr,{className:V("h-4 w-4 shrink-0 text-muted-foreground transition-transform",p&&"rotate-90")}),v?e.jsx(K,{ref:N,className:"h-7 text-sm rounded-lg flex-1",value:x,onChange:C=>f(C.target.value),onClick:C=>C.stopPropagation(),onKeyDown:C=>{C.stopPropagation(),C.key==="Enter"&&I(),C.key==="Escape"&&P()},onBlur:I}):e.jsx("span",{className:"text-sm font-semibold truncate",children:t}),!v&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n,")"]}),e.jsx("div",{className:"flex-1"}),e.jsxs(Pt,{open:S,onOpenChange:b,children:[e.jsx($t,{asChild:!0,children:e.jsx("button",{className:"h-7 w-7 shrink-0 inline-flex items-center justify-center rounded-full hover:bg-muted",onClick:C=>{C.stopPropagation()},children:e.jsx(rs,{className:"h-4 w-4 text-muted-foreground"})})}),e.jsxs(qt,{align:"end",className:"w-40 p-1",onClick:C=>C.stopPropagation(),children:[e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",onClick:()=>{b(!1),f(t),i(!0)},children:[e.jsx(Yr,{className:"h-4 w-4"}),"Rename"]}),e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm text-destructive hover:bg-muted",onClick:()=>{b(!1),l()},children:[e.jsx(Ce,{className:"h-4 w-4"}),"Delete"]})]})]})]}),p&&e.jsx("div",{className:"ml-4",children:s})]})}function ye({folders:t,currentFolderId:n,onMove:s,children:d}){const[l,o]=a.useState(!1);function p(m){s(m),o(!1)}return e.jsxs(Pt,{open:l,onOpenChange:o,children:[e.jsx($t,{asChild:!0,children:d??e.jsx("button",{className:"flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Déplacer",title:"Déplacer vers un dossier",children:e.jsx(Vr,{className:"h-4 w-4"})})}),e.jsxs(qt,{className:"w-44 p-1",align:"end",children:[e.jsx("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",style:{fontWeight:n?void 0:"bold"},onClick:()=>p(null),children:"Aucun dossier"}),t.map(m=>e.jsx("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",style:{fontWeight:n===m.id?"bold":void 0},onClick:()=>p(m.id),children:m.name},m.id))]})]})}const kt=[{key:"endurance",label:"Endurance",fieldSuffix:"endurance"},{key:"hypertrophie",label:"Hypertrophie",fieldSuffix:"hypertrophie"},{key:"force",label:"Force",fieldSuffix:"force"}],Hs=t=>t==="endurance"||t==="hypertrophie"||t==="force"?t:"endurance",Rt=({exercise:t,onChange:n,disabled:s=!1})=>e.jsxs(Or,{defaultValue:"endurance",className:"w-full",children:[e.jsx(Kr,{className:"grid w-full grid-cols-3",children:kt.map(d=>e.jsx(Lr,{value:d.key,children:d.label},d.key))}),kt.map(d=>{const l=`pct_1rm_${d.fieldSuffix}`,o=`Nb_series_${d.fieldSuffix}`,p=`Nb_reps_${d.fieldSuffix}`,m=`recup_${d.fieldSuffix}`,v=`recup_exercices_${d.fieldSuffix}`;return e.jsxs(Tr,{value:d.key,className:`space-y-3 rounded-lg border p-3 ${s?"opacity-60":""}`,children:[e.jsx("p",{className:"text-sm font-semibold",children:d.label}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"% 1RM"}),e.jsx(K,{type:"number",value:t[l]??"",disabled:s,onChange:i=>n({[l]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Nb séries"}),e.jsx(K,{type:"number",value:t[o]??"",disabled:s,onChange:i=>n({[o]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Nb reps"}),e.jsx(K,{type:"number",value:t[p]??"",disabled:s,onChange:i=>n({[p]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Récup. séries (s)"}),e.jsx(K,{type:"number",value:t[m]??"",disabled:s,onChange:i=>n({[m]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Récup. exercices (s)"}),e.jsx(K,{type:"number",value:t[v]??"",disabled:s,onChange:i=>n({[v]:i.target.value===""?null:Number(i.target.value)})})]})]})]},d.key)})]}),Js={pct_1rm_endurance:60,pct_1rm_hypertrophie:75,pct_1rm_force:85,Nb_series_endurance:4,Nb_series_hypertrophie:3,Nb_series_force:3,Nb_reps_endurance:16,Nb_reps_hypertrophie:8,Nb_reps_force:3,recup_endurance:120,recup_hypertrophie:200,recup_force:300,recup_exercices_endurance:300,recup_exercices_hypertrophie:400,recup_exercices_force:500},be=t=>{const n=Number(t);return Number.isFinite(n)?n:0},Te=(t,n,s,d)=>{const l=n==="force"?"force":n==="hypertrophie"?"hypertrophie":"endurance",o=`Nb_series_${l}`,p=`Nb_reps_${l}`,m=`pct_1rm_${l}`,v=`recup_${l}`;return{exercise_id:t.id,order_index:s,sets:be(t[o]),reps:be(t[p]),rest_seconds:be(t[v]),percent_1rm:be(t[m]),cycle_type:n,notes:d?.notes??""}},Xs=()=>({nom_exercice:"",description:null,illustration_gif:null,exercise_type:"strength",warmup_reps:null,warmup_duration:null,...Js}),Dt=({exercise:t,warmupMode:n,onChange:s,onWarmupModeChange:d,idPrefix:l})=>e.jsxs("div",{className:"space-y-3 rounded-lg border p-3",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Paramètres d'échauffement"}),e.jsxs(Yt,{value:n,onValueChange:o=>{d(o==="duration"?"duration":"reps"),s(o==="duration"?{warmup_reps:null,warmup_duration:t.warmup_duration??0}:{warmup_duration:null,warmup_reps:t.warmup_reps??0})},className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{value:"reps",id:`${l}-warmup-reps`}),e.jsx(A,{htmlFor:`${l}-warmup-reps`,children:"Nombre de répétitions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{value:"duration",id:`${l}-warmup-duration`}),e.jsx(A,{htmlFor:`${l}-warmup-duration`,children:"Durée (secondes)"})]})]}),n==="duration"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Durée (s)"}),e.jsx(K,{type:"number",value:t.warmup_duration??"",onChange:o=>s({warmup_duration:o.target.value===""?null:Number(o.target.value)})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Nombre de répétitions"}),e.jsx(K,{type:"number",value:t.warmup_reps??"",onChange:o=>s({warmup_reps:o.target.value===""?null:Number(o.target.value)})})]})]});function kn(){const{toast:t}=Pr(),n=Mr(),[s,d]=a.useState(!1),[l,o]=a.useState(null),[p,m]=a.useState(!1),[v,i]=a.useState(!1),[x,f]=a.useState(null),[S,b]=a.useState(null),[N,I]=a.useState(null),[P,C]=a.useState("reps"),[w,re]=a.useState("reps"),[H,U]=a.useState(!1),[D,q]=a.useState(""),X=async(r,u)=>{if(r.size>10485760){t({title:"Fichier trop volumineux",description:"La taille maximale est de 10 Mo.",variant:"destructive"});return}U(!0);try{const R=r.name.split(".").pop()??"gif",$=`exercises/${Date.now()}-${Math.random().toString(36).slice(2)}.${R}`,{error:ie}=await ot.storage.from("exercise-gifs").upload($,r,{upsert:!1});if(ie)throw ie;const{data:br}=ot.storage.from("exercise-gifs").getPublicUrl($);u(br.publicUrl),t({title:"Image uploadée"})}catch(R){const $=R instanceof Error?R.message:"Réessayez.";t({title:"Erreur d'upload",description:$,variant:"destructive"})}finally{U(!1)}},[h,E]=a.useState({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),[F,z]=a.useState({...Xs()});a.useEffect(()=>{x&&re(x.warmup_duration!=null?"duration":"reps")},[x]);const{data:B,isLoading:Y,error:J,refetch:ue}=je({queryKey:["exercises"],queryFn:()=>T.getExercises()}),{data:Z,isLoading:fe,error:he,refetch:De}=je({queryKey:["strength_catalog"],queryFn:()=>T.getStrengthSessions()}),{data:se}=je({queryKey:["strength_folders","session"],queryFn:()=>T.getStrengthFolders("session")}),{data:c}=je({queryKey:["strength_folders","exercise"],queryFn:()=>T.getStrengthFolders("exercise")}),y=r=>{const u=r.items?.reduce((g,R)=>g+(R.sets||0),0)??0;return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"capitalize",children:r.cycle}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[r.items?.length??0," exos"]}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[u," séries"]})]})},_=a.useMemo(()=>{if(!Z)return[];if(!D.trim())return Z;const r=D.toLowerCase();return Z.filter(u=>u.title?.toLowerCase().includes(r))},[Z,D]),j=_.filter(r=>!r.folder_id),k=a.useMemo(()=>{const r=new Map;for(const u of _)if(u.folder_id){const g=r.get(u.folder_id)??[];g.push(u),r.set(u.folder_id,g)}return r},[_]),M=a.useMemo(()=>(B??[]).filter(r=>!r.folder_id),[B]),L=a.useMemo(()=>{const r=new Map;for(const u of B??[])if(u.folder_id){const g=r.get(u.folder_id)??[];g.push(u),r.set(u.folder_id,g)}return r},[B]),O=W({mutationFn:r=>T.createExercise(r),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),m(!1),t({title:"Exercice ajouté"})}}),ne=W({mutationFn:r=>T.createStrengthSession(r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),d(!1),E({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),t({title:"Séance créée avec succès"})}}),mr=W({mutationFn:r=>T.updateExercise(r),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),i(!1),f(null),t({title:"Exercice mis à jour"})}}),pr=W({mutationFn:r=>T.deleteExercise(r),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),I(null),t({title:"Exercice supprimé"})}}),Ie=W({mutationFn:r=>T.deleteStrengthSession(r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),b(null),t({title:"Séance supprimée"})}}),Ze=W({mutationFn:r=>T.updateStrengthSession(r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),d(!1),o(null),E({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),t({title:"Séance mise à jour"})}}),xr=W({mutationFn:r=>T.persistStrengthSessionOrder(r)}),et=W({mutationFn:({name:r,type:u})=>T.createStrengthFolder(r,u),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),t({title:"Dossier créé"})}}),tt=W({mutationFn:({id:r,name:u})=>T.renameStrengthFolder(r,u),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),t({title:"Dossier renommé"})}}),rt=W({mutationFn:r=>T.deleteStrengthFolder(r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),n.invalidateQueries({queryKey:["exercises"]}),t({title:"Dossier supprimé"})}}),ge=W({mutationFn:({itemId:r,folderId:u,table:g})=>T.moveToFolder(r,u,g),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),n.invalidateQueries({queryKey:["exercises"]}),t({title:"Déplacé"})}}),fr=()=>{d(!1),o(null),E({title:"",description:"",cycle:"endurance",items:[],folder_id:null})},ve=r=>{o(r.id),E({title:r.title??"",description:r.description??"",cycle:Hs(r.cycle),items:r.items?.map(u=>({exercise_id:u.exercise_id,order_index:u.order_index??0,sets:u.sets,reps:u.reps,rest_seconds:u.rest_seconds,percent_1rm:u.percent_1rm,cycle_type:u.cycle_type,notes:u.notes??""}))??[],folder_id:r.folder_id??null}),d(!0)},st=r=>{f(r),i(!0)},hr=()=>{const r={...h,items:Fe(h.items)};l?Ze.mutate({...r,id:l}):ne.mutate(r)},Fe=r=>r.map((u,g)=>({...u,order_index:g})),gr=()=>{const r=B?.[0];E(u=>({...u,items:[...u.items,r?Te(r,u.cycle,u.items.length):{exercise_id:1,order_index:u.items.length,sets:0,reps:0,rest_seconds:0,percent_1rm:0}]}))},vr=(r,u,g)=>{const R=[...h.items];if(u==="exercise_id"){const $=B?.find(ie=>ie.id===g);$?R[r]=Te($,h.cycle,R[r].order_index??r,R[r]):R[r]={...R[r],exercise_id:Number(g)}}else R[r]={...R[r],[u]:g};E({...h,items:R})},jr=r=>{const u=Fe(h.items.filter((g,R)=>R!==r));E({...h,items:u})},yr=(r,u)=>{if(r===u)return;const g=[...h.items],[R]=g.splice(r,1);g.splice(u,0,R);const $=Fe(g);E({...h,items:$}),l&&xr.mutate({id:l,title:h.title,description:h.description,cycle:h.cycle,items:$})},nt=e.jsx(_e,{open:v,onOpenChange:i,children:e.jsxs(Se,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto pb-safe",children:[e.jsx(Ge,{children:e.jsx(Ue,{children:"Modifier l'exercice"})}),x&&e.jsxs("div",{className:"space-y-4",children:[x.exercise_type==="warmup"?e.jsx(Dt,{exercise:x,warmupMode:w,onChange:r=>f(u=>u&&{...u,...r}),onWarmupModeChange:re,idPrefix:"edit"}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Nom"}),e.jsx(K,{value:x.nom_exercice,onChange:r=>f({...x,nom_exercice:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Description"}),e.jsx(we,{value:x.description??"",onChange:r=>f({...x,description:r.target.value===""?null:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Illustration (GIF)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{value:x.illustration_gif??"",onChange:r=>f({...x,illustration_gif:r.target.value===""?null:r.target.value}),placeholder:"https://...",className:"flex-1"}),e.jsx(ae,{type:"button",variant:"outline",size:"icon",disabled:H,onClick:()=>{const r=document.createElement("input");r.type="file",r.accept="image/*,.gif",r.onchange=u=>{const g=u.target.files?.[0];g&&X(g,R=>f($=>$&&{...$,illustration_gif:R}))},r.click()},"aria-label":"Uploader une image",children:H?e.jsx(yt,{className:"h-4 w-4 animate-spin"}):e.jsx(Nt,{className:"h-4 w-4"})})]}),x.illustration_gif&&e.jsx("img",{src:x.illustration_gif,alt:"Aperçu",className:"mt-2 h-20 w-20 rounded-lg object-cover border"})]}),x.exercise_type!=="warmup"?e.jsx(Rt,{exercise:x,onChange:r=>f(u=>u&&{...u,...r})}):null,e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{id:"warmup-flag-edit",checked:x.exercise_type==="warmup",onCheckedChange:r=>f({...x,exercise_type:r===!0?"warmup":"strength"})}),e.jsx(A,{htmlFor:"warmup-flag-edit",children:"Exercice d'échauffement (warmup)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(ae,{variant:"outline",onClick:()=>{i(!1),f(null)},className:"h-10",children:"Annuler"}),e.jsx(ae,{variant:"default",onClick:()=>{x?.id&&mr.mutate(x)},disabled:!x.nom_exercice.trim(),className:"h-10",children:"Enregistrer"})]})]})]})}),at=e.jsx(_e,{open:p,onOpenChange:m,children:e.jsxs(Se,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto pb-safe",children:[e.jsx(Ge,{children:e.jsx(Ue,{children:"Créer un exercice"})}),e.jsxs("div",{className:"space-y-4",children:[F.exercise_type==="warmup"?e.jsx(Dt,{exercise:F,warmupMode:P,onChange:r=>z(u=>({...u,...r})),onWarmupModeChange:C,idPrefix:"create"}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Nom"}),e.jsx(K,{value:F.nom_exercice,onChange:r=>z({...F,nom_exercice:r.target.value}),placeholder:"ex: Rotations Élastique"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Description"}),e.jsx(we,{value:F.description??"",onChange:r=>z({...F,description:r.target.value===""?null:r.target.value}),placeholder:"Détails, consignes..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Illustration (GIF)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{value:F.illustration_gif??"",onChange:r=>z({...F,illustration_gif:r.target.value===""?null:r.target.value}),placeholder:"https://...",className:"flex-1"}),e.jsx(ae,{type:"button",variant:"outline",size:"icon",disabled:H,onClick:()=>{const r=document.createElement("input");r.type="file",r.accept="image/*,.gif",r.onchange=u=>{const g=u.target.files?.[0];g&&X(g,R=>z($=>({...$,illustration_gif:R})))},r.click()},"aria-label":"Uploader une image",children:H?e.jsx(yt,{className:"h-4 w-4 animate-spin"}):e.jsx(Nt,{className:"h-4 w-4"})})]}),F.illustration_gif&&e.jsx("img",{src:F.illustration_gif,alt:"Aperçu",className:"mt-2 h-20 w-20 rounded-lg object-cover border"})]}),F.exercise_type!=="warmup"?e.jsx(Rt,{exercise:F,onChange:r=>z(u=>({...u,...r}))}):null,e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{id:"warmup-flag",checked:F.exercise_type==="warmup",onCheckedChange:r=>z({...F,exercise_type:r===!0?"warmup":"strength"})}),e.jsx(A,{htmlFor:"warmup-flag",children:"Exercice d'échauffement (warmup)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(ae,{variant:"outline",onClick:()=>m(!1),className:"h-10",children:"Annuler"}),e.jsx(ae,{variant:"default",onClick:()=>O.mutate(F),disabled:!F.nom_exercice.trim(),className:"h-10",children:"Enregistrer"})]})]})]})}),lt=e.jsx(dt,{open:!!S,onOpenChange:r=>{r||b(null)},children:e.jsxs(ut,{children:[e.jsxs(mt,{children:[e.jsx(pt,{children:"Supprimer la séance ?"}),e.jsxs(xt,{children:['Cette action est définitive. La séance "',S?.title,'" sera supprimée.']})]}),e.jsxs(ft,{children:[e.jsx(ht,{children:"Annuler"}),e.jsx(gt,{onClick:()=>{S?.id&&Ie.mutate(S.id)},children:"Supprimer"})]})]})}),it=e.jsx(dt,{open:!!N,onOpenChange:r=>{r||I(null)},children:e.jsxs(ut,{children:[e.jsxs(mt,{children:[e.jsx(pt,{children:"Supprimer l'exercice ?"}),e.jsxs(xt,{children:[`Cette action est définitive. L'exercice "`,N?.nom_exercice,'" sera supprimé.']})]}),e.jsxs(ft,{children:[e.jsx(ht,{children:"Annuler"}),e.jsx(gt,{onClick:()=>{N?.id&&pr.mutate(N.id)},children:"Supprimer"})]})]})});return s?e.jsxs(e.Fragment,{children:[at,nt,lt,it,e.jsx(Ws,{session:h,exercises:B??[],editingSessionId:l,folders:se,onSessionChange:E,onCycleChange:r=>{const u=h.items.map((g,R)=>{const $=B?.find(ie=>ie.id===g.exercise_id);return $?Te($,r,R,g):{...g,cycle_type:r}});E({...h,cycle:r,items:u})},onSave:hr,onCancel:fr,onAddItem:gr,onUpdateItem:vr,onRemoveItem:jr,onReorderItems:yr,onExerciseDialogOpen:()=>m(!0),isSaving:ne.isPending||Ze.isPending})]}):Y?e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(Me,{className:"h-7 w-64"}),e.jsx(Me,{className:"h-10 w-full rounded-2xl"}),e.jsx("div",{className:"space-y-3",children:Array.from({length:4}).map((r,u)=>e.jsx(Me,{className:"h-20 w-full rounded-2xl"},u))})]}):J?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(es,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-semibold",children:"Impossible de charger les données"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:J instanceof Error?J.message:"Une erreur s'est produite"}),e.jsx(ae,{variant:"default",onClick:()=>ue(),className:"mt-4 h-12 md:h-10",children:"Réessayer"})]}):e.jsxs("div",{children:[at,nt,lt,it,e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold",children:"Musculation"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Catalogue"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{const r=prompt("Nom du dossier");r?.trim()&&et.mutate({name:r.trim(),type:"session"})},className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(vt,{className:"h-4 w-4"})," Dossier"]}),e.jsxs("button",{type:"button",onClick:()=>{o(null),E({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),d(!0)},className:"inline-flex items-center gap-2 rounded-full bg-primary px-3 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(Ee,{className:"h-4 w-4"})," Nouvelle"]})]})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-border bg-card px-3 py-2",children:[e.jsx(Mt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{className:"w-full bg-transparent text-sm outline-none placeholder:text-muted-foreground",placeholder:"Rechercher une séance",value:D,onChange:r=>q(r.target.value)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(jt,{sessions:j,isLoading:fe,error:he,renderTitle:r=>r.title??"Sans titre",renderMetrics:y,renderExtraActions:r=>e.jsx(ye,{folders:se??[],currentFolderId:r.folder_id,onMove:u=>ge.mutate({itemId:r.id,folderId:u,table:"strength_sessions"})}),onPreview:r=>ve(r),onEdit:r=>ve(r),onDelete:r=>b(r),canDelete:()=>!0,isDeleting:Ie.isPending}),se?.map(r=>{const u=k.get(r.id)??[];return e.jsx(Et,{name:r.name,count:u.length,onRename:g=>tt.mutate({id:r.id,name:g}),onDelete:()=>rt.mutate(r.id),children:u.length>0?e.jsx(jt,{sessions:u,renderTitle:g=>g.title??"Sans titre",renderMetrics:y,renderExtraActions:g=>e.jsx(ye,{folders:se??[],currentFolderId:g.folder_id,onMove:R=>ge.mutate({itemId:g.id,folderId:R,table:"strength_sessions"})}),onPreview:g=>ve(g),onEdit:g=>ve(g),onDelete:g=>b(g),canDelete:()=>!0,isDeleting:Ie.isPending}):e.jsx("div",{className:"rounded-xl border border-dashed border-border px-3 py-4 text-center text-xs text-muted-foreground",children:"Dossier vide"})},r.id)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Exercices (",B?.length??0,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{const r=prompt("Nom du dossier");r?.trim()&&et.mutate({name:r.trim(),type:"exercise"})},className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(vt,{className:"h-4 w-4"})," Dossier"]}),e.jsxs("button",{type:"button",onClick:()=>m(!0),className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(Ee,{className:"h-4 w-4"})," Ajouter"]})]})]}),e.jsx("div",{className:"space-y-1",children:M.map(r=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl px-3 py-2 hover:bg-muted/50",children:[r.illustration_gif?e.jsx("img",{src:r.illustration_gif,alt:r.nom_exercice,className:"h-10 w-10 shrink-0 rounded-lg object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:r.nom_exercice}),e.jsx("div",{className:"text-xs text-muted-foreground",children:r.exercise_type==="warmup"?"Échauffement":"Séries de travail"})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx(ye,{folders:c??[],currentFolderId:r.folder_id,onMove:u=>ge.mutate({itemId:r.id,folderId:u,table:"dim_exercices"})}),e.jsx("button",{type:"button",onClick:()=>st(r),className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Modifier",children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>I(r),className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-destructive hover:bg-destructive/10","aria-label":"Supprimer",children:e.jsx(Ce,{className:"h-4 w-4"})})]})]},r.id))}),c?.map(r=>{const u=L.get(r.id)??[];return e.jsx(Et,{name:r.name,count:u.length,onRename:g=>tt.mutate({id:r.id,name:g}),onDelete:()=>rt.mutate(r.id),children:u.length>0?e.jsx("div",{className:"space-y-1",children:u.map(g=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl px-3 py-2 hover:bg-muted/50",children:[g.illustration_gif?e.jsx("img",{src:g.illustration_gif,alt:g.nom_exercice,className:"h-10 w-10 shrink-0 rounded-lg object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:g.nom_exercice}),e.jsx("div",{className:"text-xs text-muted-foreground",children:g.exercise_type==="warmup"?"Échauffement":"Séries de travail"})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx(ye,{folders:c??[],currentFolderId:g.folder_id,onMove:R=>ge.mutate({itemId:g.id,folderId:R,table:"dim_exercices"})}),e.jsx("button",{type:"button",onClick:()=>st(g),className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Modifier",children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>I(g),className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-destructive hover:bg-destructive/10","aria-label":"Supprimer",children:e.jsx(Ce,{className:"h-4 w-4"})})]})]},g.id))}):e.jsx("div",{className:"rounded-xl border border-dashed border-border px-3 py-4 text-center text-xs text-muted-foreground",children:"Dossier vide"})},r.id)})]})]})]})}export{Te as createStrengthItemFromExercise,kn as default};
